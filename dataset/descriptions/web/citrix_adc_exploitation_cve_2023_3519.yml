description: The following analytic identifies potential exploitation attempts against
  Citrix ADC related to CVE-2023-3519. It detects POST requests to specific web endpoints
  associated with this vulnerability by leveraging the Web datamodel. This activity
  is significant as CVE-2023-3519 involves a SAML processing overflow issue that can
  lead to memory corruption, posing a high risk. If confirmed malicious, attackers
  could exploit this to execute arbitrary code, escalate privileges, or disrupt services,
  making it crucial for SOC analysts to monitor and investigate these alerts promptly.
required_fields:
- _time
- Web.http_method
- Web.url
- Web.url_length
- Web.src
- Web.dest
rule: '| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web
  where Web.url IN ("*/saml/login","/cgi/samlauth","*/saml/activelogin","/cgi/samlart?samlart=*","*/cgi/logout","/gwtest/formssso?event=start&target=*","/netscaler/ns_gui/vpn/*")  Web.http_method=POST
  by Web.http_user_agent, Web.status Web.http_method, Web.url, Web.url_length, Web.src,
  Web.dest, sourcetype | `drop_dm_object_name("Web")` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `citrix_adc_exploitation_cve_2023_3519_filter`'
