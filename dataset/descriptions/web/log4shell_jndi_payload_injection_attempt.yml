description: The following analytic identifies attempts to inject Log4Shell JNDI payloads
  via web calls. It leverages the Web datamodel and uses regex to detect patterns
  like `${jndi:ldap://` in raw web event data, including HTTP headers. This activity
  is significant because it targets vulnerabilities in Java web applications using
  Log4j, such as Apache Struts and Solr. If confirmed malicious, this could allow
  attackers to execute arbitrary code, potentially leading to full system compromise.
  Immediate investigation is required to determine if the attempt was successful and
  to mitigate any potential exploitation.
required_fields:
- action
- category
- dest
- dest_port
- http_content_type
- http_method
- http_referrer
- http_user_agent
- site
- src
- url
- url_domain
- user
rule: '| from datamodel Web.Web | regex _raw="[jJnNdDiI]{4}(\:|\%3A|\/|\%2F)\w+(\:\/\/|\%3A\%2F\%2F)(\$\{.*?\}(\.)?)?"
  | fillnull | stats count by action, category, dest, dest_port, http_content_type,
  http_method, http_referrer, http_user_agent, site, src, url, url_domain, user |
  `log4shell_jndi_payload_injection_attempt_filter`'
