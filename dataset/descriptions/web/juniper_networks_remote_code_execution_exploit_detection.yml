description: The following analytic detects attempts to exploit a remote code execution
  vulnerability in Juniper Networks devices. It identifies requests to /webauth_operation.php?PHPRC=*,
  which are indicative of uploading and executing malicious PHP files. This detection
  leverages the Web data model, focusing on specific URL patterns and HTTP status
  codes. This activity is significant because it signals an attempt to gain unauthorized
  access and execute arbitrary code on the device. If confirmed malicious, the attacker
  could gain control over the device, leading to data theft, network compromise, or
  other severe consequences.
required_fields:
- Web.http_user_agent
- Web.status
- Web.http_method
- Web.url
- Web.url_length
- Web.src
- Web.dest
- sourcetype
rule: '| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web
  where Web.url IN ("*/webauth_operation.php?PHPRC=*") Web.status=200 by Web.http_user_agent,
  Web.status Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype
  | `drop_dm_object_name("Web")` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `juniper_networks_remote_code_execution_exploit_detection_filter`'
