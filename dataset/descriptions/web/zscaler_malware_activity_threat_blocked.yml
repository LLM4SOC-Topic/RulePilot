description: The following analytic identifies potential malware activities within
  a network that are blocked by Zscaler. It leverages web proxy logs to filter for
  blocked actions associated with malware, aggregating occurrences by user, URL, and
  threat category. This detection is significant for SOC as it highlights attempts
  to access malicious content, indicating potential compromise or targeted attacks.
  If confirmed malicious, this activity could signify an ongoing attempt to infiltrate
  the network, necessitating immediate investigation to prevent further threats and
  ensure network integrity.
required_fields:
- action
- threatname
- deviceowner
- user
- urlcategory
- url
- dest
- dest_ip
- action
rule: source=zscaler sourcetype=zscalernss-web action=blocked threatname=*malware*
  threatcategory!=None | stats count min(_time) as firstTime max(_time) as lastTime
  by action deviceowner user urlcategory url src dest | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `zscaler_malware_activity_threat_blocked_filter`
