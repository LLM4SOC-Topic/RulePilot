description: The following analytic detects attempts to exploit the Spring4Shell vulnerability
  (CVE-2022-22963) by identifying specific URL patterns associated with web shell
  payloads. It leverages web traffic data, focusing on HTTP GET requests with URLs
  containing indicators like "tomcatwar.jsp," "poc.jsp," and "shell.jsp." This activity
  is significant as it suggests an attacker is trying to deploy a web shell, which
  can lead to remote code execution. If confirmed malicious, this could allow the
  attacker to gain persistent access, execute arbitrary commands, and potentially
  escalate privileges within the compromised environment.
required_fields:
- _time
- Web.http_method
- Web.url
- Web.url_length
- Web.src
- Web.dest
- Web.http_user_agent
rule: '| tstats count from datamodel=Web where Web.http_method IN ("GET") Web.url
  IN ("*tomcatwar.jsp*","*poc.jsp*","*shell.jsp*") by Web.http_user_agent Web.http_method,
  Web.url,Web.url_length Web.src, Web.dest sourcetype | `drop_dm_object_name("Web")`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `spring4shell_payload_url_request_filter`'
