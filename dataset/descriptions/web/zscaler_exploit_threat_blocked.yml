description: The following analytic identifies potential exploit attempts involving
  command and script interpreters blocked by Zscaler. It leverages web proxy logs
  to detect incidents where actions are blocked due to exploit references. The detection
  compiles statistics by user, threat name, URL, hostname, file class, and filename.
  This activity is significant as it helps identify and mitigate exploit attempts,
  which are critical for maintaining security. If confirmed malicious, such activity
  could lead to unauthorized code execution, privilege escalation, or persistent access
  within the environment, posing a severe threat to organizational security.
required_fields:
- action
- threatname
- deviceowner
- user
- urlcategory
- url
- dest
- dest_ip
- action
rule: source=zscaler sourcetype=zscalernss-web action=blocked threatname=*exploit*
  | stats count min(_time) as firstTime max(_time) as lastTime  by user threatname
  src hostname fileclass filename url dest | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `zscaler_exploit_threat_blocked_filter`
