description: The following analytic detects potentially malicious file upload attempts
  to Citrix ShareFile via specific suspicious URLs and the HTTP POST method. It leverages
  the Web datamodel to identify URL patterns such as "/documentum/upload.aspx?parentid=",
  "/documentum/upload.aspx?filename=", and "/documentum/upload.aspx?uploadId=*", combined
  with the HTTP POST method. This activity is significant for a SOC as it may indicate
  an attempt to upload harmful scripts or content, potentially compromising the Documentum
  application. If confirmed malicious, this could lead to unauthorized access, data
  breaches, and operational disruptions.
required_fields:
- _time
- Web.http_method
- Web.url
- Web.url_length
- Web.src
- Web.dest
rule: '| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web
  where Web.url="/documentum/upload.aspx?*" AND Web.url IN ("*parentid=*","*filename=*","*uploadId=*")
  AND Web.url IN ("*unzip=*", "*raw=*") Web.http_method=POST by Web.http_user_agent,
  Web.status Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype
  | `drop_dm_object_name("Web")` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `citrix_sharefile_exploitation_cve_2023_24489_filter`'
