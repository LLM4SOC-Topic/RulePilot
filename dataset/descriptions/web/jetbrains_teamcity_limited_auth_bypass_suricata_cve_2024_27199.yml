description: The following analytic identifies attempts to exploit CVE-2024-27199,
  a critical vulnerability in JetBrains TeamCity web server, allowing unauthenticated
  access to specific endpoints. It detects unusual access patterns to vulnerable paths
  such as /res/, /update/, and /.well-known/acme-challenge/ by monitoring HTTP traffic
  logs via Suricata. This activity is significant as it could indicate an attacker
  bypassing authentication to access or modify system settings. If confirmed malicious,
  this could lead to unauthorized changes, disclosure of sensitive information, or
  uploading of malicious certificates, severely compromising the server's security.
required_fields:
- src
- dest
- http_user_agent
- http.url
- http.status
- http_method
rule: sourcetype=suricata http.url IN ("*../admin/diagnostic.jsp*", "*../app/https/settings/*",
  "*../app/pipeline*", "*../app/oauth/space/createBuild.html*", "*../res/*", "*../update/*",
  "*../.well-known/acme-challenge/*", "*../app/availableRunners*", "*../app/https/settings/setPort*",
  "*../app/https/settings/certificateInfo*", "*../app/https/settings/defaultHttpsPort*",
  "*../app/https/settings/fetchFromAcme*", "*../app/https/settings/removeCertificate*",
  "*../app/https/settings/uploadCertificate*", "*../app/https/settings/termsOfService*",
  "*../app/https/settings/triggerAcmeChallenge*", "*../app/https/settings/cancelAcmeChallenge*",
  "*../app/https/settings/getAcmeOrder*", "*../app/https/settings/setRedirectStrategy*")
  http.status=200 http_method=GET | stats count min(_time) as firstTime max(_time)
  as lastTime by src, dest, http_user_agent, http.url, http.status, http_method |
  convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `jetbrains_teamcity_limited_auth_bypass_suricata_cve_2024_27199_filter`
