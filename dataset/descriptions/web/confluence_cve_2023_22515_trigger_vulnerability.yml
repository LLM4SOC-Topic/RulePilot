description: The following analytic identifies potential exploitation attempts of
  the Confluence CVE-2023-22515 vulnerability. It detects successful accesses (HTTP
  status 200) to specific vulnerable endpoints by analyzing web logs within the Splunk
  'Web' Data Model. This activity is significant for a SOC as it indicates possible
  privilege escalation attempts in Confluence. If confirmed malicious, attackers could
  gain unauthorized access or create accounts with escalated privileges, leading to
  potential data breaches or further exploitation within the environment.
required_fields:
- _time
- Web.http_method
- Web.url
- Web.url_length
- Web.src
- Web.dest
- Web.http_user_agent
- Web.status
rule: '| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web
  where Web.url IN ("*/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=false*","*/server-info.action?bootstrapStatusProvider.applicationConfig.setupComplete=0&*")
  Web.http_method=GET Web.status=200 by Web.http_user_agent, Web.status Web.http_method,
  Web.url, Web.url_length, Web.src, Web.dest, sourcetype | `drop_dm_object_name("Web")`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `confluence_cve_2023_22515_trigger_vulnerability_filter`'
