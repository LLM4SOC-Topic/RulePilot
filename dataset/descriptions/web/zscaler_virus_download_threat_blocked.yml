description: The following analytic identifies attempts to download viruses that were
  blocked by Zscaler within a network. It leverages web proxy logs to detect blocked
  actions indicative of virus download attempts. Key data points such as device owner,
  user, URL category, destination URL, and IP are analyzed. This activity is significant
  as it helps in early detection and remediation of potential virus threats, enhancing
  network security. If confirmed malicious, this activity could indicate an attempt
  to compromise the network, potentially leading to data breaches or further malware
  infections.
required_fields:
- action
- threatname
- deviceowner
- user
- urlcategory
- url
- dest
- dest_ip
- action
rule: source=zscaler sourcetype=zscalernss-web action=blocked threatname!="None" threatclass=Virus
  | stats count min(_time) as firstTime max(_time) as lastTime by action deviceowner
  user urlcategory url src dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `zscaler_virus_download_threat_blocked_filter`
