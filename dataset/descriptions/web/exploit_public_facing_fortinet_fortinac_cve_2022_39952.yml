description: The following analytic detects attempts to exploit the Fortinet FortiNAC
  CVE-2022-39952 vulnerability. It identifies HTTP POST requests to the URI configWizard/keyUpload.jsp
  with a payload.zip file. The detection leverages the Web datamodel, analyzing fields
  such as URL, HTTP method, and user agent. This activity is significant as it indicates
  an attempt to exploit a known vulnerability, potentially leading to remote code
  execution. If confirmed malicious, attackers could gain control over the affected
  system, schedule malicious tasks, and establish persistent access via a remote command
  and control (C2) server.
required_fields:
- Web.http_user_agent
- Web.http_method
- Web.url
- Web.url_length
- Web.src
- Web.dest
- sourcetype
rule: '| tstats count min(_time) as firstTime max(_time) as lastTime from datamodel=Web
  where Web.url IN ("*configWizard/keyUpload.jsp*") by Web.http_user_agent, Web.status
  Web.http_method, Web.url, Web.url_length, Web.src, Web.dest, sourcetype | `drop_dm_object_name("Web")`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `exploit_public_facing_fortinet_fortinac_cve_2022_39952_filter`'
