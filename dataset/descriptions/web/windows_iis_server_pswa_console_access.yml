description: This analytic detects access attempts to the PowerShell Web Access (PSWA)
  console on Windows IIS servers. It monitors web traffic for requests to PSWA-related
  URIs, which could indicate legitimate administrative activity or potential unauthorized
  access attempts. By tracking source IP, HTTP status, URI path, and HTTP method,
  it helps identify suspicious patterns or brute-force attacks targeting PSWA. This
  detection is crucial for maintaining the security of remote PowerShell management
  interfaces and preventing potential exploitation of this powerful administrative
  tool.
required_fields:
- _time
- Web.src
- Web.status
- Web.uri_path
- Web.dest
- Web.http_method
- Web.uri_query
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Web where Web.dest IN ("/pswa/*") by Web.src Web.status Web.uri_path
  Web.dest Web.http_method Web.uri_query | `drop_dm_object_name("Web")`| convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_iis_server_pswa_console_access_filter`'
