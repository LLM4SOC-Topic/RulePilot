description: The following analytic identifies attempts to download cryptomining software
  that are blocked by Zscaler. It leverages web proxy logs to detect blocked actions
  associated with cryptominer threats, analyzing key data points such as device owner,
  user, URL category, destination URL, and IP. This activity is significant for a
  SOC as it helps in early identification and mitigation of cryptomining activities,
  which can compromise network integrity and resource availability. If confirmed malicious,
  this activity could lead to unauthorized use of network resources for cryptomining,
  potentially degrading system performance and increasing operational costs.
required_fields:
- action
- threatname
- deviceowner
- user
- urlcategory
- url
- dest
- dest_ip
- action
rule: source=zscaler sourcetype=zscalernss-web action=blocked threatname=*miner* |
  stats count min(_time) as firstTime max(_time) as lastTime by action deviceowner
  user urlcategory url src dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `zscaler_cryptominer_downloaded_threat_blocked_filter`
