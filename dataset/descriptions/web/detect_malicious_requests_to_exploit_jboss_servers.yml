description: The following analytic identifies malicious HTTP requests targeting the
  jmx-console in JBoss servers. It detects unusually long URLs, indicative of embedded
  payloads, by analyzing web server logs for GET or HEAD requests with specific URL
  patterns and lengths. This activity is significant as it may indicate an attempt
  to exploit JBoss vulnerabilities, potentially leading to unauthorized remote code
  execution. If confirmed malicious, attackers could gain control over the server,
  escalate privileges, and compromise sensitive data, posing a severe threat to the
  organization's security.
required_fields:
- _time
- Web.http_method
- Web.url
- Web.url_length
- Web.src
- Web.dest
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Web where (Web.http_method="GET" OR Web.http_method="HEAD") by Web.http_method,
  Web.url,Web.url_length Web.src, Web.dest | search Web.url="*jmx-console/HtmlAdaptor?action=invokeOpByName&name=jboss.admin*import*"
  AND Web.url_length > 200 | `drop_dm_object_name("Web")` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | table src,
  dest_ip, http_method, url, firstTime, lastTime | `detect_malicious_requests_to_exploit_jboss_servers_filter`'
