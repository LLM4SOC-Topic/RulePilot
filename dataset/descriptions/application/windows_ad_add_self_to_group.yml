description: This analytic detects instances where a user adds themselves to an Active
  Directory (AD) group. This activity is a common indicator of privilege escalation,
  where a user attempts to gain unauthorized access to higher privileges or sensitive
  resources. By monitoring AD logs, this detection identifies such suspicious behavior,
  which could be part of a larger attack strategy aimed at compromising critical systems
  and data.
required_fields:
- EventCode
- user
- src_user
- signature
- Group_Name
rule: eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode IN (4728) | where user=src_user | stats min(_time) as _time dc(user) as
  usercount, values(user) as user values(user_category) as user_category values(src_user_category)
  as src_user_category values(dvc) as dvc by signature, Group_Name, src_user | `windows_ad_add_self_to_group_filter`
