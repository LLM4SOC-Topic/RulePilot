description: The following analytic identifies multiple failed multi-factor authentication
  (MFA) requests for a single user within a PingID environment. It triggers when 10
  or more MFA prompts fail within 10 minutes, using JSON logs from PingID. This activity
  is significant as it may indicate an adversary attempting to bypass MFA by bombarding
  the user with repeated authentication requests. If confirmed malicious, this could
  lead to unauthorized access, as the user might eventually accept the fraudulent
  request, compromising the security of the account and potentially the entire network.
required_fields:
- _time
- resources{}.ipaddress
- actors{}.name
- result.message
- resources{}.devicemodel
- result.status
rule: source=PINGID "result.status" IN ("FAILURE,authFail","UNSUCCESSFUL_ATTEMPT")
  | eval time = _time, src = coalesce('resources{}.ipaddress','resources{}.devicemodel'),
  user = upper('actors{}.name'), object = 'resources{}.devicemodel', reason = 'result.message'|
  bucket span=10m _time | stats dc(_raw) AS mfa_prompts min(time) as firstTime, max(time)
  as lastTime values(src) as src by user, reason, _time | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | where mfa_prompts
  >= 10 | `pingid_multiple_failed_mfa_requests_for_user_filter`
