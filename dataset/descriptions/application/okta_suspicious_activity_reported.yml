description: The following analytic identifies when an associate reports a login attempt
  as suspicious via an email from Okta. It leverages Okta Identity Management logs,
  specifically the `user.account.report_suspicious_activity_by_enduser` event type.
  This activity is significant as it indicates potential unauthorized access attempts,
  warranting immediate investigation to prevent possible security breaches. If confirmed
  malicious, the attacker could gain unauthorized access to sensitive systems and
  data, leading to data theft, privilege escalation, or further compromise of the
  environment.
required_fields:
- _time
- displayMessage
- user
- eventType
- client.userAgent.rawUserAgent
- client.userAgent.browser
- client.geographicalContext.city
- client.geographicalContext.country
rule: eventtype=okta_log OR sourcetype = "OktaIM2:log" eventType=user.account.report_suspicious_activity_by_enduser
  | stats count min(_time) as firstTime max(_time) as lastTime values(displayMessage)
  by user eventType client.userAgent.rawUserAgent client.userAgent.browser client.geographicalContext.city  client.geographicalContext.country
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `okta_suspicious_activity_reported_filter`
