description: The following analytic detects the execution of suspicious processes
  on systems identified as web servers. It leverages the Splunk data model "Endpoint.Processes"
  to search for specific process names such as "whoami", "ping", "iptables", "wget",
  "service", and "curl". This activity is significant because these processes are
  often used by attackers for reconnaissance, persistence, or data exfiltration. If
  confirmed malicious, this could lead to data theft, deployment of additional malware,
  or even ransomware attacks. Immediate investigation is required to determine the
  legitimacy of the activity and mitigate potential threats.
required_fields:
- _time
- Processes.dest_category
- Processes.process
- Processes.process_name
- Processes.dest
- Processes.user
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.dest_category="web_server" AND
  (Processes.process="*whoami*" OR Processes.process="*ping*" OR Processes.process="*iptables*"
  OR Processes.process="*wget*" OR Processes.process="*service*" OR Processes.process="*curl*")
  by Processes.process Processes.process_name, Processes.dest Processes.user| `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `web_servers_executing_suspicious_processes_filter`'
