description: This analytic detects potential exploitation of the Ivanti Virtual Traffic
  Manager (vTM) authentication bypass vulnerability (CVE-2024-7593) to create new
  administrator accounts. The vulnerability allows unauthenticated remote attackers
  to bypass authentication on the admin panel and create new admin users. This detection
  looks for suspicious new account creation events in the Ivanti vTM audit logs that
  lack expected authentication details, which may indicate exploitation attempts.
required_fields:
- _time
- IP
- MODUSER
- OPERATION
- MODGROUP
- AUTH
rule: sourcetype=ivanti_vtm_audit OPERATION="adduser" MODGROUP="admin" IP="!!ABSENT!!"
  | stats count min(_time) as firstTime max(_time) as lastTime by IP, MODUSER, OPERATION,
  MODGROUP, AUTH | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `ivanti_vtm_new_account_creation_filter`
