description: The following hunting analytic identifies renamed instances of rundll32.exe
  executing. rundll32.exe is natively found in C:\Windows\system32 and C:\Windows\syswow64.
  During investigation, validate it is the legitimate rundll32.exe executing and what
  script content it is loading. This query relies on the original filename or internal
  name from the PE meta data. Expand the query as needed by looking for specific command
  line arguments outlined in other analytics.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.original_file_name=RUNDLL32.exe
  AND Processes.process_name!=rundll32.exe by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.original_file_name | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `suspicious_rundll32_rename_filter`'
