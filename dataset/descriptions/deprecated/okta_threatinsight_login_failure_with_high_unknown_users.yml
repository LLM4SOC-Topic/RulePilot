description: '**DEPRECATION NOTE** - This search has been deprecated and replaced
  with `Okta ThreatInsight Threat Detected`. The following analytic utilizes Oktas
  ThreatInsight to identify Login failures with high unknown users count and any included
  secondary outcome reasons. This event will trigger when a brute force attempt occurs
  with unknown usernames attempted.'
required_fields:
- _time
- eventType
- client.userAgent.rawUserAgent
- client.userAgent.browser
- outcome.reason
- displayMessage
rule: eventtype=okta_log OR sourcetype = "OktaIM2:log" eventType="security.threat.detected"
  AND outcome.reason="Login failures with high unknown users count*" | stats count
  min(_time) as firstTime max(_time) as lastTime values(displayMessage) by user eventType
  client.userAgent.rawUserAgent client.userAgent.browser outcome.reason | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `okta_threatinsight_login_failure_with_high_unknown_users_filter`
