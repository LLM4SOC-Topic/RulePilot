description: The search is used to detect hosts that generate Windows Event ID 4663
  for successful attempts to write to or read from a removable storage and Event ID
  4656 for failures, which occurs when a USB drive is plugged in. In this scenario
  we are querying the Change_Analysis data model to look for Windows Event ID 4656
  or 4663 where the priority of the affected host is marked as high in the ES Assets
  and Identity Framework.
required_fields:
- _time
- All_Changes.result
- All_Changes.result_id
- All_Changes.src_priority
- All_Changes.dest
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count earliest(_time) AS earliest latest(_time)
  AS latest from datamodel=Change_Analysis where (nodename = All_Changes) All_Changes.result="Removable
  Storage device" (All_Changes.result_id=4663 OR All_Changes.result_id=4656) (All_Changes.src_priority=high)
  by All_Changes.dest | `drop_dm_object_name("All_Changes")`| convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)  | `detect_usb_device_insertion_filter`'
