description: '**DEPRECATION NOTE** - This search has been deprecated and replaced
  with `Okta ThreatInsight Threat Detected`. The following analytic utilizes Oktas
  ThreatInsight to identify "PasswordSpray" and any included secondary outcome reasons.
  This event will trigger when a brute force attempt occurs with unknown usernames
  attempted.'
required_fields:
- _time
- eventType
- client.userAgent.rawUserAgent
- client.userAgent.browser
- outcome.reason
- displayMessage
rule: eventtype=okta_log OR sourcetype = "OktaIM2:log" eventType="security.threat.detected"
  AND outcome.reason="Password Spray" | stats count min(_time) as firstTime max(_time)
  as lastTime values(displayMessage) by eventType client.userAgent.rawUserAgent client.userAgent.browser
  outcome.reason | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `okta_threatinsight_suspected_passwordspray_attack_filter`
