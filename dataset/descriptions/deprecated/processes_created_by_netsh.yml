description: This search looks for processes launching netsh.exe to execute various
  commands via the netsh command-line utility. Netsh.exe is a command-line scripting
  utility that allows you to, either locally or remotely, display or modify the network
  configuration of a computer that is currently running. Netsh can be used as a persistence
  proxy technique to execute a helper .dll when netsh.exe is executed. In this search,
  we are looking for processes spawned by netsh.exe that are executing commands via
  the command line. Deprecated because we have another detection of the same type.
required_fields:
- _time
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count values(Processes.process) as process min(_time)
  as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=netsh.exe
  by Processes.user Processes.dest Processes.parent_process Processes.parent_process_name
  Processes.process_name | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `processes_created_by_netsh_filter`'
