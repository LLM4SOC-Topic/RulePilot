description: This search provides detection of accounts with high risk roles by projects.
  Compromised accounts with high risk roles can move laterally or even scalate privileges
  at different projects depending on organization schema.
required_fields:
- _time
- data.protoPayload.request.policy.bindings{}.role
- data.resource.type data.protoPayload.authenticationInfo.principalEmail
- data.protoPayload.authorizationInfo{}.permission
- data.protoPayload.authorizationInfo{}.resource
- data.protoPayload.response.bindings{}.role
- data.protoPayload.response.bindings{}.members{}
rule: sourcetype="google:gcp:pubsub:message" data.protoPayload.request.policy.bindings{}.role=roles/owner
  OR roles/editor OR roles/iam.serviceAccountUser OR roles/iam.serviceAccountAdmin
  OR roles/iam.serviceAccountTokenCreator OR roles/dataflow.developer OR roles/dataflow.admin
  OR roles/composer.admin OR roles/dataproc.admin OR roles/dataproc.editor | table
  data.resource.type data.protoPayload.authenticationInfo.principalEmail data.protoPayload.authorizationInfo{}.permission
  data.protoPayload.authorizationInfo{}.resource data.protoPayload.response.bindings{}.role
  data.protoPayload.response.bindings{}.members{} | `gcp_detect_accounts_with_high_risk_roles_by_project_filter`
