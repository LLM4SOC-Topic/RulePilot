description: The following analytic detects the assignment of the Privileged Authentication
  Administrator role to an Azure AD user. It leverages Azure Active Directory audit
  logs to identify when this specific role is assigned. This activity is significant
  because users in this role can set or reset authentication methods for any user,
  including those in privileged roles like Global Administrators. If confirmed malicious,
  an attacker could change credentials and assume the identity and permissions of
  high-privilege users, potentially leading to unauthorized access to sensitive information
  and critical configurations.
required_fields:
- _time
- user
- properties.targetResources{}.type
- properties.initiatedBy.user.userPrincipalName
- properties.result
rule: sourcetype=azure:monitor:aad  "operationName"="Add member to role"  "properties.targetResources{}.modifiedProperties{}.newValue"="\"Privileged
  Authentication Administrator\"" | rename properties.* as * | rename initiatedBy.user.userPrincipalName
  as initiatedBy | stats count min(_time) as firstTime max(_time) as lastTime values(user)
  as user by initiatedBy, result, operationName | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `azure_ad_privileged_authentication_administrator_role_assigned_filter`
