description: The following analytic identifies excessive security scanning activities
  in AWS by detecting a high number of Describe, List, or Get API calls from a single
  user. It leverages AWS CloudTrail logs to count distinct event names and flags users
  with more than 50 such events. This behavior is significant as it may indicate reconnaissance
  activities by an attacker attempting to map out your AWS environment. If confirmed
  malicious, this could lead to unauthorized access, data exfiltration, or further
  exploitation of your cloud infrastructure.
required_fields:
- _time
- eventName
- src
- userAgent
- user
- userIdentity.arn
rule: sourcetype=aws:cloudtrail eventName=Describe* OR eventName=List* OR eventName=Get*  |
  stats dc(eventName) as dc_events min(_time) as firstTime max(_time) as lastTime
  values(eventName) as command values(src) as src values(userAgent) as userAgent by
  user userIdentity.arn | where dc_events > 50 | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)|`aws_excessive_security_scanning_filter`
