description: The following analytic detects an Azure AD user enabling a previously
  disabled account and resetting its password within 2 minutes. It uses Azure Active
  Directory events to identify this sequence of actions. This activity is significant
  because it may indicate an adversary with administrative access attempting to establish
  a backdoor identity within the Azure AD tenant. If confirmed malicious, this could
  allow the attacker to maintain persistent access, escalate privileges, and potentially
  exfiltrate sensitive information from the environment.
required_fields:
- _time
- operationName
- user
- properties.initiatedBy.user.userPrincipalName
- properties.result
rule: sourcetype=azure:monitor:aad  (operationName="Enable account" OR operationName="Reset
  password (by admin)" OR operationName="Update user") | transaction user startsWith=(operationName="Enable
  account") endsWith=(operationName="Reset password (by admin)") maxspan=2m | rename
  properties.* as * | rename initiatedBy.user.userPrincipalName as initiatedBy | stats
  count min(_time) as firstTime max(_time) as lastTime values(operationName) as operationName
  values(initiatedBy) as initiatedBy by user, result | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `azure_ad_user_enabled_and_password_reset_filter`
