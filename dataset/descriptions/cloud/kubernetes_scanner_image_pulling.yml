description: The following analytic detects the pulling of known Kubernetes security
  scanner images such as kube-hunter, kube-bench, and kube-recon. It leverages Kubernetes
  logs ingested through Splunk Connect for Kubernetes, specifically monitoring for
  messages indicating the pulling of these images. This activity is significant because
  the use of security scanners can indicate an attempt to identify vulnerabilities
  within the Kubernetes environment. If confirmed malicious, this could lead to the
  discovery and exploitation of security weaknesses, potentially compromising the
  entire Kubernetes cluster.
required_fields:
- object.message
- source.host
- object.involvedObject.name
- object.involvedObject.namespace
- object.involvedObject.kind
- object.message
- object.reason
rule: sourcetype=kube:objects:events object.message IN ("Pulling image *kube-hunter*",
  "Pulling image *kube-bench*", "Pulling image *kube-recon*", "Pulling image *kube-recon*")
  | rename object.* AS * | rename involvedObject.* AS * | rename source.host AS host
  | eval phase="operate" | eval severity="high" | stats min(_time) as firstTime max(_time)
  as lastTime count by host, name, namespace, kind, reason, message, phase, severity
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `kubernetes_scanner_image_pulling_filter`
