description: The following analytic identifies when a malicious file is detected within
  the SharePoint Online ecosystem. Attackers may stage and execute malicious files
  from within the Microsoft Office 365 ecosystem. Any detections from built-in Office
  365 capabilities should be monitored and responded to appropriately. Certain premium
  Office 365 capabilities further enhance these detection and response functions.
required_fields:
- _time
- Operation
- Workload
- SourceFileName
- ObjectId
- VirusInfo
- Id
- UserId
rule: sourcetype=o365:management:activity Operation=FileMalwareDetected | stats values(Workload)
  as category, values(SourceFileName) as file_name values(ObjectId) as file_path,
  values(VirusInfo) as signature, count, min(_time) as firstTime, max(_time) as lastTime
  by Id, UserId | rename Id as signature_id, UserId as user | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `o365_sharepoint_malware_detection_filter`
