description: The following analytic detects the deletion of CloudWatch log groups
  in AWS, identified through `DeleteLogGroup` events in CloudTrail logs. This detection
  leverages CloudTrail data to monitor for successful log group deletions, excluding
  console-based actions. This activity is significant as it indicates potential attempts
  to evade logging and monitoring, which is crucial for maintaining visibility into
  AWS activities. If confirmed malicious, this could allow attackers to hide their
  tracks, making it difficult to detect further malicious actions or investigate incidents
  within the compromised AWS environment.
required_fields:
- _time
- eventName
- eventSource
- requestParameters.name
- userAgent
- aws_account_id
- src
- region
rule: sourcetype=aws:cloudtrail eventName = DeleteLogGroup eventSource = logs.amazonaws.com
  userAgent !=console.amazonaws.com errorCode = success| stats count min(_time) as
  firstTime max(_time) as lastTime values(requestParameters.logGroupName) as log_group_name
  by src region eventName userAgent user_arn aws_account_id | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `aws_defense_evasion_delete_cloudwatch_log_group_filter`
