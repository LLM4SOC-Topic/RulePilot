description: The following analytic identifies when a policy is deleted in AWS. It
  leverages Amazon Security Lake logs to detect the DeletePolicy API operation. Monitoring
  policy deletions is crucial as it can indicate unauthorized attempts to weaken security
  controls. If confirmed malicious, this activity could allow an attacker to remove
  critical security policies, potentially leading to privilege escalation or unauthorized
  access to sensitive resources.
required_fields:
- api.operation
- actor.user.account_uid
- actor.user.name
- actor.user.uid
- http_request.user_agent
- src_endpoint.ip
- cloud.region
rule: sourcetype=aws:cloudtrail:lake api.operation=DeletePolicy | fillnull | stats
  count min(_time) as firstTime max(_time) as lastTime by api.operation actor.user.account_uid
  actor.user.name actor.user.uid http_request.user_agent src_endpoint.ip cloud.region
  | rename actor.user.name as user, src_endpoint.ip as src_ip, cloud.region as region,
  http_request.user_agent as user_agent, actor.user.account_uid as aws_account_id
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `asl_aws_iam_delete_policy_filter`
