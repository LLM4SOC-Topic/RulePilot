description: The following analytic detects the disabling of a security workflow in
  GitHub Actions. It leverages GitHub logs to identify when a workflow, excluding
  those named *security-testing*, is disabled following a push or pull request event.
  This activity is significant as it may indicate an attempt by an attacker to conceal
  malicious code by disabling security checks. If confirmed malicious, this could
  allow the attacker to introduce and persist undetected malicious code within the
  repository, potentially compromising the integrity and security of the codebase.
required_fields:
- workflow_run.event
- workflow_run.name
- workflow_run.head_commit.id
- workflow_run.event workflow_run.head_branch
- workflow_run.head_commit.author.email
- workflow_run.head_commit.author.name
- workflow_run.head_commit.message
- workflow_run.head_commit.timestamp
- workflow_run.head_repository.full_name
- workflow_run.head_repository.owner.id
- workflow_run.head_repository.owner.login
- workflow_run.head_repository.owner.type
rule: sourcetype=aws:firehose:json workflow_run.event=push OR workflow_run.event=pull_request
  | stats values(workflow_run.name) as workflow_run.name by workflow_run.head_commit.id
  workflow_run.event workflow_run.head_branch workflow_run.head_commit.author.email
  workflow_run.head_commit.author.name workflow_run.head_commit.message workflow_run.head_commit.timestamp
  workflow_run.head_repository.full_name workflow_run.head_repository.owner.id workflow_run.head_repository.owner.login
  workflow_run.head_repository.owner.type | rename workflow_run.head_commit.author.name
  as user, workflow_run.head_commit.author.email as user_email, workflow_run.head_repository.full_name
  as repository, workflow_run.head_branch as branch | search NOT workflow_run.name=*security-testing*
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `github_actions_disable_security_workflow_filter`
