description: The following analytic identifies when one of O365 the built-in security
  detections for suspicious email behaviors are triggered.  These alerts often indicate
  that an attacker may have compromised a mailbox within the environment. Any detections
  from built-in Office 365 capabilities should be monitored and responded to appropriately.
  Certain premium Office 365 capabilities further enhance these detection and response
  functions.
required_fields:
- _time
- AlertId
- ObjectId
- Operation
- Name
- Workload
rule: sourcetype=o365:management:activity Workload=SecurityComplianceCenter Operation=AlertEntityGenerated
  Name IN ("Suspicious email sending patterns detected","User restricted from sending
  email","Suspicious Email Forwarding Activity","Email sending limit exceeded") |
  fromjson Data | stats count min(_time) as firstTime max(_time) as lastTime by AlertId,ObjectId,Operation,Name
  | rename Name as signature, AlertId as signature_id, ObjectId as user | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `o365_email_suspicious_behavior_alert_filter`
