description: The following analytic detects attempts to disable multi-factor authentication
  (MFA) for an Azure AD user. It leverages Azure Active Directory AuditLogs to identify
  the "Disable Strong Authentication" operation. This activity is significant because
  disabling MFA can allow adversaries to maintain persistence using compromised accounts
  without raising suspicion. If confirmed malicious, this action could enable attackers
  to bypass an essential security control, potentially leading to unauthorized access
  and prolonged undetected presence in the environment.
required_fields:
- _time
- user
- properties.targetResources{}.type
- properties.initiatedBy.user.userPrincipalName
- properties.result
rule: sourcetype=azure:monitor:aad category=AuditLogs operationName="Disable Strong
  Authentication" | rename properties.* as * | rename targetResources{}.type as type
  | rename initiatedBy.user.userPrincipalName as initiatedBy | stats count min(_time)
  as firstTime max(_time) as lastTime by user, type, operationName, initiatedBy, result
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `azure_ad_multi_factor_authentication_disabled_filter`
