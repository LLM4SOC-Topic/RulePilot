description: The following analytic detects the deletion of CloudWatch log groups
  in AWS, identified through `DeleteLogGroup` events in CloudTrail logs. This method
  leverages Amazon Security Lake logs parsed in the OCSF format. The activity is significant
  because attackers may delete log groups to evade detection and disrupt logging capabilities,
  hindering incident response efforts. If confirmed malicious, this action could allow
  attackers to cover their tracks, making it difficult to trace their activities and
  potentially leading to undetected data breaches or further malicious actions within
  the compromised AWS environment.
required_fields:
- api.operation
- actor.user.account_uid
- actor.user.name
- actor.user.uid
- http_request.user_agent
- src_endpoint.ip
- cloud.region
rule: sourcetype=aws:cloudtrail:lake api.operation=DeleteLogGroup | fillnull | stats
  count min(_time) as firstTime max(_time) as lastTime by api.operation actor.user.account_uid
  actor.user.uid http_request.user_agent src_endpoint.ip cloud.region | rename actor.user.uid
  as user, src_endpoint.ip as src_ip, cloud.region as region, http_request.user_agent
  as user_agent, actor.user.account_uid as aws_account_id   | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `asl_aws_defense_evasion_delete_cloudwatch_log_group_filter`
