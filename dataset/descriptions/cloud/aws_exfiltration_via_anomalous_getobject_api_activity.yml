description: The following analytic identifies anomalous GetObject API activity in
  AWS, indicating potential data exfiltration attempts. It leverages AWS CloudTrail
  logs and uses the `anomalydetection` command to detect unusual patterns in the frequency
  of GetObject API calls by analyzing fields such as "count," "user_type," and "user_arn"
  within a 10-minute window. This activity is significant as it may indicate unauthorized
  data access or exfiltration from S3 buckets. If confirmed malicious, attackers could
  exfiltrate sensitive data, leading to data breaches and compliance violations.
required_fields:
- _time
- eventName
- user_arn
- src_ip
- aws_account_id
- userAgent
- userIdentity.principalId
rule: sourcetype=aws:cloudtrail eventName=GetObject | bin _time span=10m |  stats
  count values(requestParameters.bucketName) as bucketName by _time src_ip aws_account_id
  user_type user_arn userIdentity.principalId | anomalydetection "count" "user_type"
  "user_arn" action=annotate | search probable_cause=* |`aws_exfiltration_via_anomalous_getobject_api_activity_filter`
