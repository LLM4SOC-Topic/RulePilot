description: The following analytic detects instances where the inbox folder of an
  Office 365 mailbox is shared with all users within the tenant. It leverages Office
  365 management activity events to identify when the 'Inbox' folder permissions are
  modified to include 'Everyone' with read rights. This activity is significant as
  it represents a potential security risk, allowing unauthorized access to sensitive
  emails. If confirmed malicious, this could lead to data breaches, exfiltration of
  confidential information, and further compromise through spear-phishing or other
  malicious activities based on the accessed email content.
required_fields:
- _time
- Operation
- Workload
- object
- Item.ParentFolder.MemberUpn
- Item.ParentFolder.MemberRights
- UserId
- MailboxOwnerUPN
rule: sourcetype=o365:management:activity Operation=ModifyFolderPermissions Workload=Exchange
  object=Inbox Item.ParentFolder.MemberUpn=Everyone | eval isReadRole=if(match('Item.ParentFolder.MemberRights',
  "(ReadAny)"), "true", "false")  | search isReadRole = "true" | stats count earliest(_time)
  as firstTime latest(_time) as lastTime by Operation, UserId, object, MailboxOwnerUPN,
  Item.ParentFolder.MemberUpn, Item.ParentFolder.MemberRights | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `o365_mailbox_inbox_folder_shared_with_all_users_filter`
