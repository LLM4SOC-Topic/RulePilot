description: The following analytic detects the activation of an Azure AD Privileged
  Identity Management (PIM) role. It leverages Azure Active Directory events to identify
  when a user activates a PIM role assignment, indicated by the "Add member to role
  completed (PIM activation)" operation. Monitoring this activity is crucial as PIM
  roles grant elevated privileges, and unauthorized activation could indicate an adversary
  attempting to gain privileged access. If confirmed malicious, this could lead to
  unauthorized administrative actions, data breaches, or further compromise of the
  Azure environment.
required_fields:
- _time
- properties
- operationName
- user
- initiatedBy.user.userPrincipalName
- result
rule: sourcetype=azure:monitor:aad operationName="Add member to role completed (PIM
  activation)" | rename properties.* as * | rename initiatedBy.user.userPrincipalName
  as initiatedBy | stats count min(_time) as firstTime max(_time) as lastTime values(user)
  as user values(targetResources{}.displayName) as displayName by initiatedBy, result,
  operationName | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `azure_ad_pim_role_assignment_activated_filter`
