description: The following analytic detects `UpdateTrail` events within AWS CloudTrail
  logs, aiming to identify attempts by attackers to evade detection by altering logging
  configurations. By updating CloudTrail settings with incorrect parameters, such
  as changing multi-regional logging to a single region, attackers can impair the
  logging of their activities across other regions. This behavior is crucial for Security
  Operations Centers (SOCs) to identify, as it indicates an adversary's intent to
  operate undetected within a compromised AWS environment. The impact of such evasion
  tactics is significant, potentially allowing malicious activities to proceed without
  being logged, thereby hindering incident response and forensic investigations.
required_fields:
- api.operation
- actor.user.account_uid
- actor.user.name
- actor.user.uid
- http_request.user_agent
- src_endpoint.ip
- cloud.region
rule: sourcetype=aws:cloudtrail:lake api.operation=UpdateTrail | fillnull | stats
  count min(_time) as firstTime max(_time) as lastTime by api.operation actor.user.account_uid
  actor.user.uid http_request.user_agent src_endpoint.ip cloud.region | rename actor.user.uid
  as user, src_endpoint.ip as src_ip, cloud.region as region, http_request.user_agent
  as user_agent, actor.user.account_uid as aws_account_id | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `asl_aws_defense_evasion_update_cloudtrail_filter`
