description: The following analytic detects the successful deletion of a group within
  AWS IAM, leveraging CloudTrail IAM events. This action, while not inherently malicious,
  can serve as a precursor to more sinister activities, such as unauthorized access
  or privilege escalation attempts. By monitoring for such deletions, the analytic
  aids in identifying potential preparatory steps towards an attack, allowing for
  early detection and mitigation. The identification of this behavior is crucial for
  a SOC to prevent the potential impact of an attack, which could include unauthorized
  access to sensitive resources or disruption of AWS environment operations.
required_fields:
- api.operation
- actor.user.account_uid
- actor.user.name
- actor.user.uid
- http_request.user_agent
- src_endpoint.ip
- cloud.region
rule: sourcetype=aws:cloudtrail:lake api.operation=DeleteGroup status=Success | fillnull
  | stats count min(_time) as firstTime max(_time) as lastTime by api.operation actor.user.account_uid
  actor.user.name actor.user.uid http_request.user_agent src_endpoint.ip cloud.region
  | rename actor.user.name as user, src_endpoint.ip as src_ip, cloud.region as region,
  http_request.user_agent as user_agent, actor.user.account_uid as aws_account_id
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `asl_aws_iam_successful_group_deletion_filter`
