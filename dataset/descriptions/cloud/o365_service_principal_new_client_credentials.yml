description: The following analytic detects the addition of new credentials for Service
  Principals within an Office 365 tenant. It uses O365 audit logs, focusing on events
  related to credential modifications or additions in the AzureActiveDirectory workload.
  This activity is significant because Service Principals represent application identities,
  and their credentials allow applications to authenticate and access resources. If
  an attacker successfully adds or modifies these credentials, they can impersonate
  the application, leading to unauthorized data access, data exfiltration, or malicious
  operations under the application's identity.
required_fields:
- _time
- Workload
- Operation
- object
- user
rule: sourcetype=o365:management:activity Workload=AzureActiveDirectory Operation="Update
  application*Certificates and secrets management " |  stats earliest(_time) as firstTime
  latest(_time) as lastTime by user ModifiedProperties{}.NewValue object ObjectId
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `o365_service_principal_new_client_credentials_filter`
