description: The following analytic detects the deletion of AWS CloudTrail logs by
  identifying `DeleteTrail` events within CloudTrail logs. This detection leverages
  CloudTrail data to monitor for successful `DeleteTrail` actions, excluding those
  initiated from the AWS console. This activity is significant because adversaries
  may delete CloudTrail logs to evade detection and operate stealthily within the
  compromised environment. If confirmed malicious, this action could allow attackers
  to cover their tracks, making it difficult to trace their activities and potentially
  leading to prolonged unauthorized access and further exploitation.
required_fields:
- _time
- eventName
- eventSource
- requestParameters.name
- userAgent
- aws_account_id
- src
- region
rule: sourcetype=aws:cloudtrail eventName = DeleteTrail eventSource = cloudtrail.amazonaws.com
  userAgent !=console.amazonaws.com errorCode = success| stats count min(_time) as
  firstTime max(_time) as lastTime values(requestParameters.name) as deleted_cloudtrail_name
  by src region eventName userAgent user_arn aws_account_id | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `aws_defense_evasion_delete_cloudtrail_filter`
