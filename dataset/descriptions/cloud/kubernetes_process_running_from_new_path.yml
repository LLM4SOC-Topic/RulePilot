description: The following analytic identifies processes running from newly seen paths
  within a Kubernetes environment. It leverages process metrics collected via an OTEL
  collector and hostmetrics receiver, and data is pulled from Splunk Observability
  Cloud using the Splunk Infrastructure Monitoring Add-on. This detection compares
  processes observed in the last hour with those seen over the previous 30 days. This
  activity is significant as it may indicate unauthorized changes, compromised nodes,
  or the introduction of malicious software. If confirmed malicious, it could lead
  to unauthorized process execution, control over critical resources, data exfiltration,
  privilege escalation, or malware introduction within the Kubernetes cluster.
required_fields:
- process.memory.utilization
- host.name
- k8s.cluster.name
- k8s.node.name
- process.executable.name
rule: '| mstats count(process.memory.utilization) as process.memory.utilization_count
  where index=kubernetes_metrics AND earliest=-1h by host.name k8s.cluster.name k8s.node.name
  process.pid process.executable.path process.executable.name | eval current="True"
  | append [ mstats count(process.memory.utilization) as process.memory.utilization_count
  where index=kubernetes_metrics AND earliest=-30d latest=-1h by host.name k8s.cluster.name
  k8s.node.name process.pid process.executable.path process.executable.name ] | stats
  count values(current) as current by host.name k8s.cluster.name k8s.node.name process.pid
  process.executable.name process.executable.path | where count=1 and current="True"
  | rename host.name as host | `kubernetes_process_running_from_new_path_filter`'
