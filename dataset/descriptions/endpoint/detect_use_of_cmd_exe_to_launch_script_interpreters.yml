description: The following analytic detects the execution of cscript.exe or wscript.exe
  processes initiated by cmd.exe. It leverages data from Endpoint Detection and Response
  (EDR) agents, focusing on process names and parent processes within the Endpoint
  data model. This activity is significant as it may indicate script-based attacks
  or administrative actions that could be leveraged for malicious purposes. If confirmed
  malicious, this behavior could allow attackers to execute scripts, potentially leading
  to code execution, privilege escalation, or persistence within the environment.
required_fields:
- _time
- Processes.process
- Processes.parent_process_name
- Processes.process_name
- Processes.parent_process
- Processes.user
- Processes.dest
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.parent_process_name="cmd.exe"
  (Processes.process_name=cscript.exe OR Processes.process_name =wscript.exe) by Processes.parent_process
  Processes.process_name Processes.process Processes.user Processes.dest | `drop_dm_object_name("Processes")`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)|convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `detect_use_of_cmd_exe_to_launch_script_interpreters_filter`'
