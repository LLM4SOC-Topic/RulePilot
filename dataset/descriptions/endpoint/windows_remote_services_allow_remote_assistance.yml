description: The following analytic detects modifications in the Windows registry
  to enable remote desktop assistance on a targeted machine. It leverages data from
  the Endpoint.Registry datamodel, specifically monitoring changes to the "Control\\Terminal
  Server\\fAllowToGetHelp" registry path. This activity is significant because enabling
  remote assistance via registry is uncommon and often associated with adversaries
  or malware like Azorult. If confirmed malicious, this could allow an attacker to
  remotely access and control the compromised host, leading to potential data exfiltration
  or further system compromise.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_path
- Registry.user
- Registry.dest
- Registry.registry_value_name
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry where Registry.registry_path= "*\\Control\\Terminal
  Server\\fAllowToGetHelp*" Registry.registry_value_data="0x00000001" by Registry.registry_key_name
  Registry.user Registry.registry_path Registry.registry_value_data Registry.action
  Registry.dest | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_remote_services_allow_remote_assistance_filter`'
