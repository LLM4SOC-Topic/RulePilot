description: The following analytic detects the execution of the 'fsutil' command
  with the 'setzerodata' parameter, which zeros out a target file. This detection
  leverages data from Endpoint Detection and Response (EDR) agents, focusing on process
  names and command-line arguments. This activity is significant because it is a technique
  used by ransomware, such as LockBit, to evade detection by erasing its malware path
  after encrypting the host. If confirmed malicious, this action could hinder forensic
  investigations and allow attackers to cover their tracks, complicating incident
  response efforts.
required_fields:
- _time
- Processes.user
- Processes.process_name
- Processes.parent_process_name
- Processes.dest
- Processes.process
- Processes.parent_process
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count values(Processes.process) as process values(Processes.parent_process)
  as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes
  where Processes.process_name=fsutil.exe Processes.process="*setzerodata*" by Processes.user
  Processes.process_name Processes.parent_process_name Processes.dest  Processes.process
  Processes.parent_process | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `fsutil_zeroing_file_filter`'
