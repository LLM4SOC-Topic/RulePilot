description: The following analytic detects the execution of files with multiple extensions,
  such as ".doc.exe" or ".pdf.exe". This behavior is identified using Endpoint Detection
  and Response (EDR) telemetry, focusing on process creation events where the file
  name contains double extensions. This activity is significant because attackers
  often use double extensions to disguise malicious executables as benign documents,
  increasing the likelihood of user execution. If confirmed malicious, this technique
  can lead to unauthorized code execution, potentially compromising the endpoint and
  allowing further malicious activities.
required_fields:
- _time
- Processes.process
- Processes.dest
- Processes.user
- Processes.parent_process
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process IN ("*.doc.exe", "*.xls.exe","*.ppt.exe",
  "*.htm.exe", "*.html.exe", "*.txt.exe", "*.pdf.exe", "*.docx.exe", "*.xlsx.exe",
  "*.pptx.exe","*.one.exe", "*.bat.exe", "*rtf.exe") by Processes.dest Processes.user
  Processes.process Processes.process_name Processes.parent_process | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `drop_dm_object_name(Processes)`
  | `execution_of_file_with_multiple_extensions_filter`'
