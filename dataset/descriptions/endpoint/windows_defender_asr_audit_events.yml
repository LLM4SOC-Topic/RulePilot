description: This detection searches for Windows Defender ASR audit events. ASR is
  a feature of Windows Defender Exploit Guard that prevents actions and apps that
  are typically used by exploit-seeking malware to infect machines. ASR rules are
  applied to processes and applications. When a process or application attempts to
  perform an action that is blocked by an ASR rule, an event is generated. This detection
  searches for ASR audit events that are generated when a process or application attempts
  to perform an action that would be blocked by an ASR rule, but is allowed to proceed
  for auditing purposes.
required_fields:
- host
- Process_Name
- Target_Commandline
- ID
- EventCode
- ASR_Rule
rule: source="WinEventLog:Microsoft-Windows-Windows Defender/Operational" EventCode
  IN (1122, 1125, 1126, 1132, 1134) | stats count min(_time) as firstTime max(_time)
  as lastTime by host, Process_Name, Target_Commandline, Path, ID, EventCode | lookup
  asr_rules ID OUTPUT ASR_Rule | fillnull value=NULL | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| rename host
  as dest | `windows_defender_asr_audit_events_filter`
