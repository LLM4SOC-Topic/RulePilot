description: The following analytic detects the installation of a root CA certificate
  by monitoring specific registry paths for SetValue events. It leverages data from
  the Endpoint datamodel, focusing on registry paths containing "certificates" and
  registry values named "Blob." This activity is significant because unauthorized
  root CA certificates can compromise the integrity of encrypted communications and
  facilitate man-in-the-middle attacks. If confirmed malicious, this could allow an
  attacker to intercept, decrypt, or manipulate sensitive data, leading to severe
  security breaches.
required_fields:
- _time
- Registry.registry_path
- Registry.registry_key_name
- Registry.registry_value_name
- Registry.dest
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry where Registry.registry_path IN ("*\\certificates\\*")
  AND Registry.registry_value_name="Blob" by Registry.dest Registry.user Registry.registry_path
  Registry.registry_value_name Registry.process_guid Registry.registry_key_name Registry.registry_value_data
  | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_registry_certificate_added_filter`'
