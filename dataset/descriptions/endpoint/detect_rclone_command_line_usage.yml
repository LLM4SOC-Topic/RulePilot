description: The following analytic detects the usage of `rclone.exe` with specific
  command-line arguments indicative of file transfer activities. It leverages data
  from Endpoint Detection and Response (EDR) agents, focusing on command-line executions
  and process details. This activity is significant as `rclone.exe` is often used
  by adversaries for data exfiltration, especially during ransomware attacks. If confirmed
  malicious, this behavior could lead to unauthorized data transfer, resulting in
  data breaches and potential loss of sensitive information. Immediate isolation of
  the affected endpoint and further investigation are recommended.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
- Processes.original_file_name
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.original_file_name=rclone.exe
  OR Processes.process_name=rclone.exe) Processes.process IN ("*copy*", "*mega*",
  "*pcloud*", "*ftp*", "*--config*", "*--progress*", "*--no-check-certificate*", "*--ignore-existing*",
  "*--auto-confirm*", "*--transfers*", "*--multi-thread-streams*")  by Processes.dest
  Processes.user Processes.parent_process Processes.parent_process_name Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) |  convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `detect_rclone_command_line_usage_filter`'
