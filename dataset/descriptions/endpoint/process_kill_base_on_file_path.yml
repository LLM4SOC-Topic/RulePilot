description: The following analytic detects the use of `wmic.exe` with the `delete`
  command to remove an executable path. This detection leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process names, parent processes,
  and command-line executions. This activity is significant because it often indicates
  the initial stages of an adversary setting up malicious activities, such as cryptocurrency
  mining, on an endpoint. If confirmed malicious, this behavior could allow an attacker
  to disable security tools or other critical processes, facilitating further compromise
  and persistence within the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` values(Processes.process) as process values(Processes.process_id)
  as process_id count min(_time) as firstTime max(_time) as lastTime  from datamodel=Endpoint.Processes
  where (Processes.process_name=wmic.exe OR Processes.original_file_name=wmic.exe)
  AND Processes.process="*process*" AND Processes.process="*executablepath*" AND Processes.process="*delete*"
  by  Processes.parent_process_name Processes.process_name Processes.original_file_name
  Processes.dest Processes.user | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `process_kill_base_on_file_path_filter`'
