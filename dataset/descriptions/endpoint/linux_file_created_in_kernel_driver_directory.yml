description: The following analytic detects the creation of files in the Linux kernel/driver
  directory. It leverages filesystem data to identify new files in this critical directory.
  This activity is significant because the kernel/driver directory is typically reserved
  for kernel modules, and unauthorized file creation here can indicate a rootkit installation.
  If confirmed malicious, this could allow an attacker to gain high-level privileges,
  potentially compromising the entire system by executing code at the kernel level.
required_fields:
- _time
- Filesystem.dest
- Filesystem.file_create_time
- Filesystem.file_name
- Filesystem.process_guid
- Filesystem.file_path
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Filesystem where Filesystem.file_path IN ("*/kernel/drivers/*")
  by Filesystem.dest Filesystem.file_name Filesystem.process_guid Filesystem.file_path
  | `drop_dm_object_name(Filesystem)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_file_created_in_kernel_driver_directory_filter`'
