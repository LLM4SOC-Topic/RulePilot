description: The following analytic detects the execution of "mshta.exe" with inline
  protocol handlers such as "JavaScript", "VBScript", and "About". It leverages data
  from Endpoint Detection and Response (EDR) agents, focusing on command-line arguments
  and process details. This activity is significant because mshta.exe can be exploited
  to execute malicious scripts, potentially leading to unauthorized code execution.
  If confirmed malicious, this could allow an attacker to execute arbitrary code,
  escalate privileges, or establish persistence within the environment, posing a severe
  security risk.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count values(Processes.process) as process values(Processes.parent_process)
  as parent_process min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes
  where (Processes.process_name=mshta.exe OR Processes.original_file_name=MSHTA.EXE)
  (Processes.process=*vbscript* OR Processes.process=*javascript* OR Processes.process=*about*)
  by Processes.user Processes.process_name Processes.original_file_name Processes.parent_process_name
  Processes.dest  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `detect_mshta_inline_hta_execution_filter`'
