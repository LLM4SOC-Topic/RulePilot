description: The following analytic detects the use of Windows Curl.exe to upload
  a file to a remote destination. It identifies command-line arguments such as `-T`,
  `--upload-file`, `-d`, `--data`, and `-F` in process execution logs. This activity
  is significant because adversaries may use Curl to exfiltrate data or upload malicious
  payloads. If confirmed malicious, this could lead to data breaches or further compromise
  of the system. Analysts should review parallel processes and network logs to determine
  if the upload was successful and isolate the endpoint if necessary.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=curl.exe OR Processes.original_file_name=Curl.exe)
  Processes.process IN ("*-T *","*--upload-file *", "*-d *", "*--data *", "*-F *")
  by Processes.dest Processes.user Processes.parent_process_name Processes.process_name
  Processes.original_file_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_curl_upload_to_remote_destination_filter`'
