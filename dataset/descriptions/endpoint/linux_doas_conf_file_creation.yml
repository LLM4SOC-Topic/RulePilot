description: The following analytic detects the creation of the doas.conf file on
  a Linux host. This file is used by the doas utility to allow standard users to perform
  tasks as root, similar to sudo. The detection leverages filesystem data from the
  Endpoint data model, focusing on the creation of the doas.conf file. This activity
  is significant because it can indicate an attempt to gain elevated privileges, potentially
  by an adversary. If confirmed malicious, this could allow an attacker to execute
  commands with root privileges, leading to full system compromise.
required_fields:
- _time
- Filesystem.dest
- Filesystem.file_create_time
- Filesystem.file_name
- Filesystem.process_guid
- Filesystem.file_path
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Filesystem where Filesystem.file_path IN ("*/etc/doas.conf")
  by Filesystem.dest Filesystem.file_create_time Filesystem.file_name Filesystem.process_guid
  Filesystem.file_path | `drop_dm_object_name(Filesystem)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_doas_conf_file_creation_filter`'
