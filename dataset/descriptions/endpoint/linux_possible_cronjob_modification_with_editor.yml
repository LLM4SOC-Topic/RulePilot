description: The following analytic detects potential unauthorized modifications to
  Linux cronjobs using text editors like "nano," "vi," or "vim." It identifies this
  activity by monitoring command-line executions that interact with cronjob configuration
  paths. This behavior is significant for a SOC as it may indicate attempts at privilege
  escalation or establishing persistent access. If confirmed malicious, the impact
  could be severe, allowing attackers to execute damaging actions such as data theft,
  system sabotage, or further network penetration.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name IN("nano","vim.basic")
  OR Processes.process IN ("*nano *", "*vi *", "*vim *")) AND Processes.process IN("*/etc/cron*",
  "*/var/spool/cron/*", "*/etc/anacrontab*") by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_possible_cronjob_modification_with_editor_filter`'
