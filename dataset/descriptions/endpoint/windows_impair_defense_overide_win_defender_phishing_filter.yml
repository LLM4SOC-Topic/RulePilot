description: The following analytic detects modifications to the Windows registry
  that disable the Windows Defender phishing filter. It leverages data from the Endpoint.Registry
  data model, focusing on changes to specific registry values related to Microsoft
  Edge's phishing filter settings. This activity is significant because disabling
  the phishing filter can allow attackers to deceive users into visiting malicious
  websites without triggering browser warnings. If confirmed malicious, this could
  lead to users unknowingly accessing harmful sites, resulting in potential security
  incidents or data compromises.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_value_name
- Registry.dest
- Registry.user
- Registry.registry_path
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry where Registry.registry_key_name = "*\\MicrosoftEdge\\PhishingFilter"
  Registry.registry_value_name IN ("EnabledV9", "PreventOverride") Registry.registry_value_data="0x00000000"
  by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data
  Registry.action Registry.dest | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_impair_defense_overide_win_defender_phishing_filter_filter`'
