description: The following analytic detects a rundll32 process creating executable
  (.exe) or dynamic link library (.dll) files. It leverages Sysmon EventCode 11 to
  identify instances where rundll32.exe generates these file types. This activity
  is significant because rundll32 is often exploited by malware, such as IcedID, to
  drop malicious payloads in directories like Temp, AppData, or ProgramData. If confirmed
  malicious, this behavior could allow an attacker to execute arbitrary code, establish
  persistence, or escalate privileges within the environment.
required_fields:
- _time
- process_name
- file_name
- process_guid
- dest
- user_id
rule: sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational EventCode=11 Image="*rundll32.exe" TargetFilename
  IN ("*.exe", "*.dll") | stats count min(_time) as firstTime max(_time) as lastTime
  by Image TargetFilename Computer | rename Computer as dest | rename TargetFilename
  as file_name | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `rundll32_process_creating_exe_dll_files_filter`
