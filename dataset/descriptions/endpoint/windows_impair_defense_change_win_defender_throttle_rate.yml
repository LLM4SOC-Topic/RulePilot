description: The following analytic detects modifications to the ThrottleDetectionEventsRate
  registry setting in Windows Defender. It leverages data from the Endpoint.Registry
  datamodel to identify changes in the registry path related to Windows Defender's
  event logging rate. This activity is significant because altering the ThrottleDetectionEventsRate
  can reduce the frequency of logged detection events, potentially masking malicious
  activities. If confirmed malicious, this could allow an attacker to evade detection
  by decreasing the visibility of security events, thereby hindering incident response
  and forensic investigations.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_value_name
- Registry.dest
- Registry.user
- Registry.registry_path
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry where Registry.registry_path= "*\\Windows Defender\\NIS\\Consumers\\IPS\\ThrottleDetectionEventsRate"
  by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data
  Registry.action Registry.dest | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_impair_defense_change_win_defender_throttle_rate_filter`'
