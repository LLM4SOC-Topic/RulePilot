description: The following analytic detects potential access or modification of the
  /etc/sudoers file on a Linux system. It leverages data from Endpoint Detection and
  Response (EDR) agents, focusing on processes like "cat," "nano," "vim," and "vi"
  accessing the /etc/sudoers file. This activity is significant because the sudoers
  file controls user permissions for executing commands with elevated privileges.
  If confirmed malicious, an attacker could gain persistence or escalate privileges,
  compromising the security of the targeted host.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name IN("cat", "nano*","vim*",
  "vi*")  AND Processes.process IN("*/etc/sudoers*") by Processes.dest Processes.user
  Processes.parent_process_name Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_possible_access_to_sudoers_file_filter`'
