description: The following analytic detects the Microsoft Software Licensing User
  Interface Tool (`slui.exe`) spawning a child process. This behavior is identified
  using Endpoint Detection and Response (EDR) telemetry, focusing on process creation
  events where `slui.exe` is the parent process. This activity is significant because
  `slui.exe` should not typically spawn child processes, and doing so may indicate
  a UAC bypass attempt, leading to elevated privileges. If confirmed malicious, an
  attacker could leverage this to execute code with elevated privileges, potentially
  compromising the system's security and gaining unauthorized access.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.parent_process_name=slui.exe by
  Processes.dest Processes.user Processes.parent_process_name Processes.parent_process
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `slui_spawning_a_process_filter`'
