description: The following analytic detects process injection into Notepad.exe using
  Sysmon EventCode 10. It identifies suspicious GrantedAccess requests (0x40 and 0x1fffff)
  to Notepad.exe, excluding common system paths like System32, Syswow64, and Program
  Files. This behavior is often associated with the SliverC2 framework by BishopFox.
  Monitoring this activity is crucial as it may indicate an initial payload attempting
  to execute malicious code within Notepad.exe. If confirmed malicious, this could
  allow attackers to execute arbitrary code, potentially leading to privilege escalation
  or persistent access within the environment.
required_fields:
- _time
- dest
- SourceImage
- TargetImage
- GrantedAccess
- CallTrace
rule: sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational EventCode=10 TargetImage IN (*\\notepad.exe)
  NOT (SourceImage IN ("*\\system32\\*","*\\syswow64\\*","*\\Program Files\\*")) GrantedAccess
  IN ("0x40","0x1fffff") | stats count min(_time) as firstTime max(_time) as lastTime
  by dest SourceImage TargetImage GrantedAccess CallTrace | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_process_injection_into_notepad_filter`
