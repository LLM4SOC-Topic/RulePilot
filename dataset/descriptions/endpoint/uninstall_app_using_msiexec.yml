description: The following analytic detects the uninstallation of applications using
  msiexec with specific command-line arguments. It leverages data from Endpoint Detection
  and Response (EDR) agents, focusing on process execution logs that include command-line
  details. This activity is significant because it is an uncommon practice in enterprise
  environments and has been associated with malicious behavior, such as disabling
  antivirus software. If confirmed malicious, this could allow an attacker to remove
  security software, potentially leading to further compromise and persistence within
  the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=msiexec.exe Processes.process=
  "* /qn *" Processes.process= "*/X*" Processes.process= "*REBOOT=*" by Processes.dest
  Processes.user Processes.parent_process Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `uninstall_app_using_msiexec_filter`'
