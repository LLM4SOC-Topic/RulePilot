description: The following analytic identifies the execution of CLOP ransomware variants
  using specific arguments ("runrun" or "temp.dat") to trigger their malicious activities.
  This detection leverages data from Endpoint Detection and Response (EDR) agents,
  focusing on process names and command-line arguments. Monitoring this activity is
  crucial as it indicates potential ransomware behavior, which can lead to file encryption
  on network shares or local machines. If confirmed malicious, this activity could
  result in significant data loss and operational disruption due to encrypted files,
  highlighting the need for immediate investigation and response.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name != "*temp.dat*" Processes.process
  = "*runrun*" OR Processes.process = "*temp.dat*" by Processes.dest Processes.user
  Processes.parent_process Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `clop_common_exec_parameter_filter`'
