description: The following analytic identifies the execution of `wmic.exe` with command-line
  arguments used to discover domain controllers in a Windows domain. It leverages
  data from Endpoint Detection and Response (EDR) agents, focusing on process names
  and command-line arguments. This activity is significant because it is commonly
  used by adversaries and Red Teams for situational awareness and Active Directory
  discovery. If confirmed malicious, this behavior could allow attackers to map out
  the network, identify key systems, and plan further attacks, potentially leading
  to unauthorized access and data exfiltration.
required_fields:
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name="wmic.exe") (Processes.process=""
  OR Processes.process="*DomainControllerAddress*") by Processes.dest Processes.user
  Processes.parent_process Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `domain_controller_discovery_with_wmic_filter`'
