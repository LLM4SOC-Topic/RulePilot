description: The following analytic detects the execution of `wmic.exe` with the `node`
  switch, indicating an attempt to spawn a local or remote process. This detection
  leverages data from Endpoint Detection and Response (EDR) agents, focusing on process
  creation events and command-line arguments. This activity is significant as it may
  indicate lateral movement or remote code execution attempts by an attacker. If confirmed
  malicious, the attacker could gain remote control over the targeted system, execute
  arbitrary commands, and potentially escalate privileges or persist within the environment.
required_fields:
- _time
- Processes.user
- Processes.process_name
- Processes.parent_process_name
- Processes.dest
- Processes.parent_process
- Processes.parent_process_id
- Processes.process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=wmic.exe OR Processes.original_file_name=wmic.exe)
  Processes.process=*node* by Processes.dest Processes.user Processes.parent_process
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `remote_wmi_command_attempt_filter`'
