description: The following analytic detects modifications to the Windows Defender
  ThreatSeverityDefaultAction registry setting. It leverages data from the Endpoint.Registry
  datamodel to identify changes in registry values that define how Windows Defender
  responds to threats. This activity is significant because altering these settings
  can impair the system's defense mechanisms, potentially allowing threats to go unaddressed.
  If confirmed malicious, this could enable attackers to bypass antivirus protections,
  leading to persistent threats and increased risk of data compromise or further system
  exploitation.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_value_name
- Registry.dest
- Registry.user
- Registry.registry_path
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry where Registry.registry_path= "*\\Windows Defender\\Threats\\ThreatSeverityDefaultAction*"
  Registry.registry_value_data IN ("0x00000001", "9") by Registry.registry_key_name
  Registry.user Registry.registry_path Registry.registry_value_data Registry.action
  Registry.dest | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_impair_defense_define_win_defender_threat_action_filter`'
