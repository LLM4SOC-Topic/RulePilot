description: The following analytic detects the execution of `dsquery.exe` with the
  `computer` argument, which is used to discover remote systems within a domain. This
  detection leverages data from Endpoint Detection and Response (EDR) agents, focusing
  on process names and command-line arguments. Remote system discovery is significant
  as it indicates potential reconnaissance activities by adversaries or Red Teams
  to map out network resources and Active Directory structures. If confirmed malicious,
  this activity could lead to further exploitation, lateral movement, and unauthorized
  access to critical systems within the network.
required_fields:
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name="dsquery.exe") (Processes.process="*computer*")
  by Processes.dest Processes.user Processes.parent_process Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `remote_system_discovery_with_dsquery_filter`'
