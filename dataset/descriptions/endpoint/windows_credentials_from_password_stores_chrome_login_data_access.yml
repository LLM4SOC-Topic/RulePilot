description: The following analytic identifies non-Chrome processes accessing the
  Chrome user data file "login data." This file is an SQLite database containing sensitive
  information, including saved passwords. The detection leverages Windows Security
  Event logs, specifically event code 4663, to monitor access attempts. This activity
  is significant as it may indicate attempts by threat actors to extract and decrypt
  stored passwords, posing a risk to user credentials. If confirmed malicious, attackers
  could gain unauthorized access to sensitive accounts and escalate their privileges
  within the environment.
required_fields:
- _time
- object_file_name
- object_file_path
- process_name
- process_path
- process_id
- EventCode
- dest
rule: eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode=4663 object_file_path="*\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Login
  Data" AND NOT (process_path IN ("*:\\Windows\\explorer.exe", "*:\\Windows\\System32\\dllhost.exe",
  "*\\chrome.exe")) | stats count min(_time) as firstTime max(_time) as lastTime by
  object_file_name object_file_path process_name process_path  process_id EventCode
  dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_credentials_from_password_stores_chrome_login_data_access_filter`
