description: The following analytic detects instances of the 3CXDesktopApp.exe with
  a FileVersion of 18.12.x, leveraging Sysmon logs. This detection focuses on identifying
  vulnerable versions 18.12.407 and 18.12.416 of the 3CX desktop app. Monitoring this
  activity is crucial as these specific versions have known vulnerabilities that could
  be exploited by attackers. If confirmed malicious, exploitation of this vulnerability
  could lead to unauthorized access, code execution, or further compromise of the
  affected system, posing significant security risks.
required_fields:
- _time
- OriginalFileName
- process_name
- EventID
- CommandLine
- dest
- parent_process_name
rule: sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational (process_name=3CXDesktopApp.exe OR OriginalFileName=3CXDesktopApp.exe)  FileVersion=18.12.*
  | stats count min(_time) as firstTime max(_time) as lastTime by dest, parent_process_name,process_name,
  OriginalFileName, CommandLine | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `windows_vulnerable_3cx_software_filter`
