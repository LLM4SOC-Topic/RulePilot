description: The following analytic detects the execution of BusyBox with sudo privileges,
  which can lead to privilege escalation on Linux systems. It leverages data from
  Endpoint Detection and Response (EDR) agents, focusing on process creation events
  where BusyBox is executed with both 'sh' and 'sudo' commands. This activity is significant
  because it indicates a user may be attempting to gain root access, bypassing standard
  security controls. If confirmed malicious, this could allow an attacker to execute
  arbitrary commands as root, leading to full system compromise and potential persistence
  within the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process="*busybox*" AND Processes.process="*sh*"
  AND Processes.process="*sudo*" by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.process_guid | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_busybox_privilege_escalation_filter`'
