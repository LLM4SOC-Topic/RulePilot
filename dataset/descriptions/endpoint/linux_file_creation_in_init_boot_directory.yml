description: The following analytic detects the creation of files in Linux init boot
  directories, which are used for automatic execution upon system startup. It leverages
  file system logs to identify new files in directories such as /etc/init.d/ and /etc/rc.d/.
  This activity is significant as it is a common persistence technique used by adversaries,
  malware authors, and red teamers. If confirmed malicious, this could allow an attacker
  to maintain persistence on the compromised host, potentially leading to further
  exploitation and unauthorized control over the system.
required_fields:
- _time
- Filesystem.dest
- Filesystem.file_create_time
- Filesystem.file_name
- Filesystem.process_guid
- Filesystem.file_path
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Filesystem where Filesystem.file_path IN ("*/etc/init.d/*",
  "*/etc/rc.d/*", "*/sbin/init.d/*", "*/etc/rc.local*") by Filesystem.dest Filesystem.file_name
  Filesystem.process_guid Filesystem.file_path | `drop_dm_object_name(Filesystem)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_file_creation_in_init_boot_directory_filter`'
