description: The following analytic detects the execution of `whoami.exe` without
  any arguments. It leverages data from Endpoint Detection and Response (EDR) agents,
  focusing on process execution logs. This activity is significant because both Red
  Teams and adversaries use `whoami.exe` to identify the current logged-in user, aiding
  in situational awareness and Active Directory discovery. If confirmed malicious,
  this behavior could indicate an attacker is gathering information to further compromise
  the system, potentially leading to privilege escalation or lateral movement within
  the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name="whoami.exe") by
  Processes.dest Processes.user Processes.parent_process Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `system_user_discovery_with_whoami_filter`'
