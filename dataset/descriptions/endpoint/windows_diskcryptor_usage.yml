description: The following analytic detects the execution of DiskCryptor, identified
  by the process names "dcrypt.exe" or "dcinst.exe". This detection leverages data
  from Endpoint Detection and Response (EDR) agents, focusing on process names and
  original file names. DiskCryptor is significant because adversaries use it to manually
  encrypt disks during an operation, potentially leading to data inaccessibility.
  If confirmed malicious, this activity could result in complete disk encryption,
  causing data loss and operational disruption. Immediate investigation is required
  to mitigate potential ransomware attacks.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name="dcrypt.exe" OR
  Processes.original_file_name=dcinst.exe) by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.original_file_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_diskcryptor_usage_filter`'
