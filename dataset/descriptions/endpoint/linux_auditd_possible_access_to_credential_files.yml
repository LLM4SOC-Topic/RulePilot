description: The following analytic detects attempts to access or dump the contents
  of /etc/passwd and /etc/shadow files on Linux systems. It leverages data from Linux
  Auditd, focusing on processes like 'cat', 'nano', 'vim', and 'vi' accessing these
  files. This activity is significant as it may indicate credential dumping, a technique
  used by adversaries to gain persistence or escalate privileges. If confirmed malicious,
  privileges. If confirmed malicious, attackers could obtain hashed passwords for
  offline cracking, leading to unauthorized access and potential system compromise.
required_fields:
- _time
- proctitle
rule: sourcetype="linux:audit" type=PROCTITLE | eval normalized_proctitle_delimiter
  = if(type=="PROCTITLE" AND isnotnull(proctitle), if(match(proctitle,"^[0-9A-F]+$"),
  replace(proctitle, "000", "020"),proctitle),null()) | eval normalized_proctitle_delimiter  =
  if(type=="PROCTITLE" AND isnotnull(proctitle), if(match(normalized_proctitle_delimiter,"^[0-9A-F]+$"),
  replace(normalized_proctitle_delimiter, "00", "20"),normalized_proctitle_delimiter),null())
  | eval process_exec = if(match(normalized_proctitle_delimiter,"^[0-9A-F]+$"),urldecode(replace(normalized_proctitle_delimiter,"([0-9A-F]{2})","%\1")),normalized_proctitle_delimiter)
  | rename host as dest | where (LIKE (process_exec, "%shadow%") OR LIKE (process_exec,
  "%passwd%")) AND (LIKE (process_exec, "%cat %") OR LIKE (process_exec, "%nano %")OR
  LIKE (process_exec, "%vim %") OR LIKE (process_exec, "%vi %")) | stats count min(_time)
  as firstTime max(_time) as lastTime by process_exec proctitle normalized_proctitle_delimiter
  dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| `linux_auditd_possible_access_to_credential_files_filter`
