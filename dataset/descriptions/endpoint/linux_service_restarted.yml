description: The following analytic detects the restarting or re-enabling of services
  on Linux systems using the `systemctl` or `service` commands. It leverages data
  from Endpoint Detection and Response (EDR) agents, focusing on process and command-line
  execution logs. This activity is significant as adversaries may use it to maintain
  persistence or execute unauthorized actions. If confirmed malicious, this behavior
  could lead to repeated execution of malicious payloads, unauthorized access, or
  data destruction. Security analysts should investigate these events to mitigate
  risks and prevent further compromise.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name IN ("systemctl",
  "service") OR Processes.process IN ("*systemctl *", "*service *")) Processes.process
  IN ("*restart*", "*reload*", "*reenable*") by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.process_guid | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_service_restarted_filter`'
