description: The following analytic detects attempts to stop or clear a service on
  Linux systems. It leverages data from Linux Auditd, focusing on processes like "systemctl,"
  "service," and "svcadm" executing stop commands. This activity is significant as
  adversaries often terminate security or critical services to disable defenses or
  disrupt operations, as seen in malware like Industroyer2. If confirmed malicious,
  this could lead to the disabling of security mechanisms, allowing attackers to persist,
  escalate privileges, or deploy destructive payloads, severely impacting system integrity
  and availability.
required_fields:
- _time
- type
- pid
- UID
- comm
- exe
rule: sourcetype="linux:audit" type=SERVICE_STOP | rename host as dest | stats count
  min(_time) as firstTime max(_time) as lastTime by type pid UID comm exe dest | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| `linux_auditd_stop_services_filter`
