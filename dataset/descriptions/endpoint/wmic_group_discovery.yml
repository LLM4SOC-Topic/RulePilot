description: The following analytic identifies the use of `wmic.exe` to enumerate
  local groups on an endpoint. This detection leverages data from Endpoint Detection
  and Response (EDR) agents, focusing on process execution logs, including command-line
  details. Monitoring this activity is significant as it can indicate reconnaissance
  efforts by an attacker to understand group memberships, which could be a precursor
  to privilege escalation or lateral movement. If confirmed malicious, this activity
  could allow an attacker to map out privileged groups, aiding in further exploitation
  and persistence within the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=wmic.exe (Processes.process="*group
  get name*") by Processes.dest Processes.user Processes.parent_process_name Processes.process_name
  Processes.process Processes.original_file_name Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)|
  convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `wmic_group_discovery_filter`'
