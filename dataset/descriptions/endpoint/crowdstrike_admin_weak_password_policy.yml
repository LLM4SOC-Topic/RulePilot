description: The following analytic detects CrowdStrike alerts for admin weak password
  policy violations, identifying instances where administrative passwords do not meet
  security standards. These alerts highlight significant vulnerabilities that could
  be exploited by attackers to gain unauthorized access. Promptly addressing these
  alerts is crucial for maintaining robust security and protecting critical systems
  and data from potential threats.
required_fields:
- _time
- riskFactors{}.severity
- riskFactors{}.type
- roles{}.type
- accounts{}.domain
- accounts{}.dn
- accounts{}.samAccountName
rule: sourcetype=crowdstrike:identities primaryDisplayName = "*admin*" | rename riskFactors{}.severity
  as severity, riskFactors{}.type as risk_type, roles{}.type as role_type, accounts{}.domain
  as domain, accounts{}.dn as dn, accounts{}.samAccountName as user | stats count
  min(_time) as firstTime max(_time) as lastTime by  domain dn primaryDisplayName
  risk_type severity riskScore riskScoreSeverity user role_type | where risk_type
  = "WEAK_PASSWORD_POLICY" | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `crowdstrike_admin_weak_password_policy_filter`
