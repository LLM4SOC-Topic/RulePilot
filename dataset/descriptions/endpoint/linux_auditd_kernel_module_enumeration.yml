description: The following analytic identifies the use of the 'kmod' process to list
  kernel modules on a Linux system. This detection leverages data from Linux Auditd,
  focusing on process names and command-line executions. While listing kernel modules
  is not inherently malicious, it can be a precursor to loading unauthorized modules
  using 'insmod'. If confirmed malicious, this activity could allow an attacker to
  load kernel modules, potentially leading to privilege escalation, persistence, or
  other malicious actions within the system.
required_fields:
- _time
- comm
- exe
- SYSCALL
- UID
- ppid
- pid
rule: sourcetype="linux:audit" type=SYSCALL comm=lsmod | rename host as dest  | stats
  count min(_time) as firstTime max(_time) as lastTime by comm exe  SYSCALL UID ppid
  pid success dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_auditd_kernel_module_enumeration_filter`
