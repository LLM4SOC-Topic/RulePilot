description: The following analytic detects modifications to the Windows registry
  that disable the Windows Defender raw write notification feature. It leverages data
  from the Endpoint.Registry datamodel, specifically monitoring changes to the registry
  path associated with Windows Defender's real-time protection settings. This activity
  is significant because disabling raw write notifications can allow malware, such
  as Azorult, to bypass Windows Defender's behavior monitoring, potentially leading
  to undetected malicious activities. If confirmed malicious, this could enable attackers
  to execute code, persist in the environment, and access sensitive information without
  detection.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_path
- Registry.user
- Registry.dest
- Registry.registry_value_name
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry where Registry.registry_path= "*\\Windows Defender\\Real-Time
  Protection\\DisableRawWriteNotification*" Registry.registry_value_data="0x00000001"
  by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data
  Registry.action Registry.dest | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_modify_registry_disable_win_defender_raw_write_notif_filter`'
