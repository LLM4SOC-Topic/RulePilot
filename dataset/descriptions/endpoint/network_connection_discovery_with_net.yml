description: The following analytic identifies the execution of `net.exe` or `net1.exe`
  with command-line arguments used to list network connections on a compromised system.
  It leverages data from Endpoint Detection and Response (EDR) agents, focusing on
  process names and command-line executions. This activity is significant as it indicates
  potential network reconnaissance by adversaries or Red Teams, aiming to gather situational
  awareness and Active Directory information. If confirmed malicious, this behavior
  could allow attackers to map the network, identify critical assets, and plan further
  attacks, potentially leading to data exfiltration or lateral movement.
required_fields:
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name="net.exe" OR Processes.original_file_name="net.exe"
  OR Processes.process_name="net1.exe" OR Processes.original_file_name="net1.exe")
  AND (Processes.process=*use*) by Processes.dest Processes.user Processes.parent_process
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `network_connection_discovery_with_net_filter`'
