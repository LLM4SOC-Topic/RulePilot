description: The following analytic detects the execution of the c99 utility with
  sudo privileges, which can lead to privilege escalation on Linux systems. It leverages
  data from Endpoint Detection and Response (EDR) agents, focusing on process execution
  logs that include command-line details. This activity is significant because it
  indicates a potential misuse of the c99 utility to gain root access, which is critical
  for maintaining system security. If confirmed malicious, this could allow an attacker
  to execute commands as root, potentially compromising the entire system and accessing
  sensitive information.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process="*c99*" AND Processes.process="*-wrapper*"
  AND Processes.process="*sudo*" by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.process_guid | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_c99_privilege_escalation_filter`'
