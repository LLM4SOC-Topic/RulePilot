description: The following analytic identifies the creation of a service with a known
  name used by CLOP ransomware for persistence and high-privilege code execution.
  It detects this activity by monitoring Windows Event Logs (EventCode 7045) for specific
  service names ("SecurityCenterIBM", "WinCheckDRVs"). This activity is significant
  because the creation of such services is a common tactic used by ransomware to maintain
  control over infected systems. If confirmed malicious, this could allow attackers
  to execute code with elevated privileges, maintain persistence, and potentially
  disrupt or encrypt critical data.
required_fields:
- EventCode
- cmdline
- _time
- parent_process_name
- process_name
- OriginalFileName
- process_path
rule: eventtype=wineventlog_system EventCode=7045 ServiceName IN ("SecurityCenterIBM",
  "WinCheckDRVs") | stats count min(_time) as firstTime max(_time) as lastTime by
  Computer EventCode ServiceName StartType ServiceType | rename Computer as dest |
  convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `clop_ransomware_known_service_name_filter`
