description: The following analytic detects the creation of SSH key files in the ~/.ssh/
  directory. It leverages filesystem data to identify new files in this specific path.
  This activity is significant because threat actors often create SSH keys to gain
  persistent access and escalate privileges on a compromised host. If confirmed malicious,
  this could allow attackers to remotely access the machine using the OpenSSH daemon
  service, leading to potential unauthorized control and data exfiltration.
required_fields:
- _time
- Filesystem.dest
- Filesystem.file_create_time
- Filesystem.file_name
- Filesystem.process_guid
- Filesystem.file_path
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Filesystem where Filesystem.file_path IN ("*/.ssh*") by
  Filesystem.dest Filesystem.file_name Filesystem.process_guid Filesystem.file_path
  | `drop_dm_object_name(Filesystem)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_possible_ssh_key_file_creation_filter`'
