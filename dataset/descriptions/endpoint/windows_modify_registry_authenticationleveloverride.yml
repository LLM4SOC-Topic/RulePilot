description: The following analytic detects modifications to the Windows registry
  key "AuthenticationLevelOverride" within the Terminal Server Client settings. It
  leverages data from the Endpoint.Registry datamodel to identify changes where the
  registry value is set to 0x00000000. This activity is significant as it may indicate
  an attempt to override authentication levels for remote connections, a tactic used
  by DarkGate malware for malicious installations. If confirmed malicious, this could
  allow attackers to gain unauthorized remote access, potentially leading to data
  exfiltration or further system compromise.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_path
- Registry.user
- Registry.dest
- Registry.registry_value_name
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Registry where Registry.registry_path = "*\\Terminal Server
  Client\\AuthenticationLevelOverride"  Registry.registry_value_data = 0x00000000
  by  Registry.registry_path Registry.registry_value_name Registry.registry_value_data
  Registry.process_guid Registry.action Registry.user Registry.dest | `drop_dm_object_name(Registry)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_modify_registry_authenticationleveloverride_filter`'
