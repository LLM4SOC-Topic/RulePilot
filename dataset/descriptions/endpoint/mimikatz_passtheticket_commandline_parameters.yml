description: The following analytic detects the use of Mimikatz command line parameters
  associated with pass-the-ticket attacks. It leverages data from Endpoint Detection
  and Response (EDR) agents, focusing on specific command-line patterns related to
  Kerberos ticket manipulation. This activity is significant because pass-the-ticket
  attacks allow adversaries to move laterally within an environment using stolen Kerberos
  tickets, bypassing normal access controls. If confirmed malicious, this could enable
  attackers to escalate privileges, access sensitive information, and maintain persistence
  within the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
- Processes.parent_process_name
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process = "*sekurlsa::tickets
  /export*" OR Processes.process = "*kerberos::ptt*") by Processes.dest Processes.user
  Processes.parent_process Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id Processes.parent_process_name | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `mimikatz_passtheticket_commandline_parameters_filter`'
