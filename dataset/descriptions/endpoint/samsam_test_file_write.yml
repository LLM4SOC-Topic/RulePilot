description: The following analytic detects the creation of a file named "test.txt"
  within the Windows system directory, indicative of Samsam ransomware propagation.
  It leverages file-system activity data from the Endpoint data model, specifically
  monitoring file paths within the Windows System32 directory. This activity is significant
  as it aligns with known Samsam ransomware behavior, which uses such files for propagation
  and execution. If confirmed malicious, this could lead to ransomware deployment,
  resulting in data encryption, system disruption, and potential data loss. Immediate
  investigation and remediation are crucial to prevent further damage.
required_fields:
- _time
- Filesystem.user
- Filesystem.dest
- Filesystem.file_name
- Filesystem.file_path
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  values(Filesystem.user) as user values(Filesystem.dest) as dest values(Filesystem.file_name)
  as file_name from datamodel=Endpoint.Filesystem where Filesystem.file_path=*\\windows\\system32\\test.txt
  by Filesystem.file_path | `drop_dm_object_name(Filesystem)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `samsam_test_file_write_filter`'
