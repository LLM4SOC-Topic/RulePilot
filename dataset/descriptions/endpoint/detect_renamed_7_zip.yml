description: The following analytic detects the usage of a renamed 7-Zip executable
  using Sysmon data. It leverages the OriginalFileName field to identify instances
  where the 7-Zip process has been renamed. This activity is significant as attackers
  often rename legitimate tools to evade detection while staging or exfiltrating data.
  If confirmed malicious, this behavior could indicate data exfiltration attempts
  or other unauthorized data manipulation, potentially leading to significant data
  breaches or loss of sensitive information. Analysts should validate the legitimacy
  of the 7-Zip executable and investigate parallel processes for further suspicious
  activities.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.original_file_name=7z*.exe AND
  Processes.process_name!=7z*.exe) by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.original_file_name | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `detect_renamed_7_zip_filter`'
