description: The following analytic identifies the execution of `net.exe` or `net1.exe`
  with command line arguments aimed at obtaining the domain password policy. It leverages
  data from Endpoint Detection and Response (EDR) agents, focusing on process names
  and command-line executions. This activity is significant as it indicates potential
  reconnaissance efforts by adversaries to gather information about Active Directory
  password policies. If confirmed malicious, this behavior could allow attackers to
  understand password complexity requirements, aiding in brute-force or password-guessing
  attacks, ultimately compromising user accounts and gaining unauthorized access to
  the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
- Processes.parent_process_name
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name="net.exe" OR Processes.original_file_name="net.exe"
  OR Processes.process_name="net1.exe" OR Processes.original_file_name="net1.exe")
  AND Processes.process = "*accounts*" AND Processes.process = "*/domain*" by Processes.dest
  Processes.user Processes.parent_process Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id Processes.parent_process_name |
  `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `password_policy_discovery_with_net_filter`'
