description: The following analytic detects the execution of `cipher.exe` with the
  `/w` flag to clear unallocated sectors on a disk. It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process names, command-line arguments,
  and parent processes. This activity is significant because it is a technique used
  by ransomware to prevent forensic recovery of deleted files. If confirmed malicious,
  this action could hinder incident response efforts by making it impossible to recover
  critical data, thereby complicating the investigation and remediation process.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name = "cipher.exe" Processes.process
  = "*/w:*" by Processes.parent_process_name Processes.parent_process Processes.process_name
  Processes.process Processes.dest Processes.user Processes.process_id Processes.process_guid
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `clear_unallocated_sector_using_cipher_app_filter`'
