description: The following analytic detects the use of the taskkill command in a process
  command line to terminate several known browser processes, a technique commonly
  employed by the Braodo stealer malware to steal credentials. By forcefully closing
  browsers like Chrome, Edge, and Firefox, the malware can unlock files that store
  sensitive information, such as passwords and login data. This detection focuses
  on identifying taskkill commands targeting these browsers, signaling malicious intent.
  Early detection allows security teams to investigate and prevent further credential
  theft and system compromise.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process = "*taskkill*" Processes.process
  IN("*chrome.exe","*firefox.exe","*brave.exe","*opera.exe","*msedge.exe","*chromium.exe")
  by Processes.dest Processes.user Processes.parent_process Processes.parent_process_name
  Processes.process_name Processes.original_file_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_disable_or_stop_browser_process_filter`'
