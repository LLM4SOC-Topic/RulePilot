description: The following analytic detects the execution of the "swapoff" command,
  which disables the swapping of paging devices on a Linux system. It leverages data
  from Endpoint Detection and Response (EDR) agents, focusing on process execution
  logs. This activity is significant because disabling swap can be a tactic used by
  malware, such as Awfulshred, to evade detection and hinder forensic analysis. If
  confirmed malicious, this action could allow an attacker to manipulate system memory
  management, potentially leading to data corruption, system instability, or evasion
  of memory-based detection mechanisms.
required_fields:
- _time
- argc
- process_exec
rule: sourcetype="linux:audit" type=PROCTITLE | eval normalized_proctitle_delimiter
  = if(type=="PROCTITLE" AND isnotnull(proctitle), if(match(proctitle,"^[0-9A-F]+$"),
  replace(proctitle, "000", "020"),proctitle),null()) | eval normalized_proctitle_delimiter  =
  if(type=="PROCTITLE" AND isnotnull(proctitle), if(match(normalized_proctitle_delimiter,"^[0-9A-F]+$"),
  replace(normalized_proctitle_delimiter, "00", "20"),normalized_proctitle_delimiter),null())
  | eval process_exec = if(match(normalized_proctitle_delimiter,"^[0-9A-F]+$"),urldecode(replace(normalized_proctitle_delimiter,"([0-9A-F]{2})","%\1")),normalized_proctitle_delimiter)
  | rename host as dest | where LIKE(process_exec, "%swapoff %") AND LIKE(process_exec,
  "% -a%") | stats count min(_time) as firstTime max(_time) as lastTime by process_exec
  proctitle normalized_proctitle_delimiter dest | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `linux_auditd_hardware_addition_swapoff_filter`
