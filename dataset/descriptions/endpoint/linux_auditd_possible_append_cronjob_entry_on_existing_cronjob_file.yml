description: The following analytic detects potential tampering with cronjob files
  on a Linux system by identifying 'echo' commands that append code to existing cronjob
  files. It leverages logs from Linux Auditd, focusing on process names, parent processes,
  and command-line executions. This activity is significant because adversaries often
  use it for persistence or privilege escalation. If confirmed malicious, this could
  allow attackers to execute unauthorized code automatically, leading to system compromises
  and unauthorized data access, thereby impacting business operations and data integrity.
required_fields:
- _time
- name
- nametype
- OGID
rule: sourcetype="linux:audit" type=PATH name IN("*/etc/cron*", "*/var/spool/cron/*",
  "*/etc/anacrontab*") | rename host as dest | stats count min(_time) as firstTime
  max(_time) as lastTime by name nametype OGID  dest | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `linux_auditd_possible_append_cronjob_entry_on_existing_cronjob_file_filter`
