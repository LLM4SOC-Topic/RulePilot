description: The following analytic detects the execution of the RDPWInst.exe tool,
  which is an RDP wrapper library used to enable remote desktop host support and concurrent
  RDP sessions. This detection leverages data from Endpoint Detection and Response
  (EDR) agents, focusing on process names, original file names, and specific command-line
  arguments. This activity is significant because adversaries can abuse this tool
  to establish unauthorized RDP connections, facilitating remote access and potential
  lateral movement within the network. If confirmed malicious, this could lead to
  unauthorized access, data exfiltration, and further compromise of the targeted host.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` values(Processes.process) as process min(_time)
  as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name="RDPWInst.exe"
  OR Processes.original_file_name="RDPWInst.exe") AND Processes.process IN ("* -i*",
  "* -s*", "* -o*", "* -w*", "* -r*") by Processes.dest Processes.user Processes.parent_process
  Processes.process_name Processes.original_file_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_remote_service_rdpwinst_tool_execution_filter`'
