description: The following analytic detects non-Chrome processes attempting to access
  the Chrome extensions file. It leverages Windows Security Event logs, specifically
  event code 4663, to identify this behavior. This activity is significant because
  adversaries may exploit this file to extract sensitive information from the Chrome
  browser, posing a security risk. If confirmed malicious, this could lead to unauthorized
  access to stored credentials and other sensitive data, potentially compromising
  the security of the affected system and broader network.
required_fields:
- _time
- object_file_name
- object_file_path
- process_name
- process_path
- process_id
- EventCode
- dest
rule: eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode=4663 object_file_path="*\\AppData\\Local\\Google\\Chrome\\User Data\\Default\\Local
  Extension Settings\\*" AND NOT (process_path IN ("*:\\Windows\\explorer.exe", "*\\chrome.exe"))
  | stats count min(_time) as firstTime max(_time) as lastTime by object_file_name
  object_file_path process_name process_path  process_id EventCode dest | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_credentials_from_password_stores_chrome_extension_access_filter`
