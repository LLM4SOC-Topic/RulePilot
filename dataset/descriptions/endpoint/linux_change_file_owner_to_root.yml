description: The following analytic detects the use of the 'chown' command to change
  a file owner to 'root' on a Linux system. It leverages Endpoint Detection and Response
  (EDR) telemetry, specifically monitoring command-line executions and process details.
  This activity is significant as it may indicate an attempt to escalate privileges
  by adversaries, malware, or red teamers. If confirmed malicious, this action could
  allow an attacker to gain root-level access, leading to full control over the compromised
  host and potential persistence within the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name = chown OR Processes.process
  = "*chown *") AND Processes.process = "* root *" by Processes.dest Processes.user
  Processes.parent_process_name Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id Processes.process_guid | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_change_file_owner_to_root_filter`'
