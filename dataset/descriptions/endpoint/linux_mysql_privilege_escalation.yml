description: The following analytic detects the execution of MySQL commands with elevated
  privileges using sudo, which can lead to privilege escalation. It leverages data
  from Endpoint Detection and Response (EDR) agents, focusing on process execution
  logs that include command-line details. This activity is significant because it
  indicates a potential misuse of MySQL to execute system commands as root, which
  could allow an attacker to gain root shell access. If confirmed malicious, this
  could result in full control over the affected system, leading to severe security
  breaches and unauthorized access to sensitive data.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process="*mysql*-e*" AND Processes.process="*\!**"
  AND Processes.process="*sudo*" by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.process_guid | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_mysql_privilege_escalation_filter`'
