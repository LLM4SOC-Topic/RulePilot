description: The following analytic detects the suspicious spawning of MSBuild.exe
  by Windows Script Host processes (cscript.exe or wscript.exe). This behavior is
  often associated with malware or adversaries executing malicious MSBuild processes
  via scripts on compromised hosts. The detection leverages Endpoint Detection and
  Response (EDR) telemetry, focusing on process creation events where MSBuild is a
  child of script hosts. This activity is significant as it may indicate an attempt
  to execute malicious code. If confirmed malicious, it could lead to unauthorized
  code execution, potentially compromising the host and allowing further malicious
  activities.
required_fields:
- _time
- Processes.dest
- Processes.parent_process
- Processes.parent_process_name
- Processes.process_name
- Processes.original_file_name
- Processes.user
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count values(Processes.process_name) as process_name
  values(Processes.process) as process min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.parent_process_name IN ("wscript.exe",
  "cscript.exe") AND (Processes.process_name=msbuild.exe OR Processes.original_file_name=MSBuild.exe)
  by Processes.dest Processes.parent_process Processes.parent_process_name Processes.process_name
  Processes.original_file_name Processes.user | `drop_dm_object_name(Processes)` |
  convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `msbuild_suspicious_spawned_by_script_process_filter`'
