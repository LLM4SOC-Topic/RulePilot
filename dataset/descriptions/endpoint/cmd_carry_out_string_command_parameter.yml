description: The following analytic detects the use of `cmd.exe /c` to execute commands,
  a technique often employed by adversaries and malware to run batch commands or invoke
  other shells like PowerShell. This detection leverages data from Endpoint Detection
  and Response (EDR) agents, focusing on command-line executions and process metadata.
  Monitoring this activity is crucial as it can indicate script-based attacks or unauthorized
  command execution. If confirmed malicious, this behavior could lead to unauthorized
  code execution, privilege escalation, or persistence within the environment.
required_fields:
- _time
- Processes.parent_process_name
- Processes.parent_process
- Processes.process_name
- Processes.process_id
- Processes.process
- Processes.dest
- Processes.user
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=cmd.exe OR Processes.original_file_name=Cmd.Exe)
  AND Processes.process="* /c*" by Processes.dest Processes.user Processes.parent_process_name
  Processes.parent_process Processes.process_name Processes.original_file_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `cmd_carry_out_string_command_parameter_filter`'
