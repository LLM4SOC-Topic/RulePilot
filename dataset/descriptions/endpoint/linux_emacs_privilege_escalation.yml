description: The following analytic detects the execution of Emacs with elevated privileges
  using the `sudo` command and the `--eval` option. It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process execution logs that include
  command-line arguments. This activity is significant because it indicates a potential
  privilege escalation attempt, where a user could gain root access by running Emacs
  with elevated permissions. If confirmed malicious, this could allow an attacker
  to execute arbitrary commands as root, leading to full system compromise and unauthorized
  access to sensitive information.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process="*emacs*" AND Processes.process="*--eval*"
  AND Processes.process="*sudo*" by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.process_guid | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_emacs_privilege_escalation_filter`'
