description: The following analytic detects any Windows Office Product spawning `rundll32.exe`
  without a `.dll` file extension. This behavior is identified using Endpoint Detection
  and Response (EDR) telemetry, focusing on process and parent process relationships.
  This activity is significant as it is a known tactic of the IcedID malware family,
  which can lead to unauthorized code execution. If confirmed malicious, this could
  allow attackers to execute arbitrary code, potentially leading to data exfiltration,
  system compromise, or further malware deployment. Immediate investigation and containment
  are recommended.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.parent_process_name IN ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe","onenote.exe","onenotem.exe","onenoteviewer.exe","onenoteim.exe",
  "msaccess.exe", "Graph.exe","winproj.exe") (Processes.process_name=rundll32.exe
  OR Processes.original_file_name=RUNDLL32.EXE) (Processes.process!=*.dll*) by Processes.dest
  Processes.user Processes.parent_process_name Processes.parent_process Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `office_product_spawning_rundll32_with_no_dll_filter`'
