description: The following analytic detects the use of the PlistBuddy utility on macOS
  to create or modify property list (.plist) files. It leverages OSQuery to monitor
  process events, specifically looking for commands that interact with LaunchAgents
  and set properties like RunAtLoad. This activity is significant because PlistBuddy
  can be used to establish persistence mechanisms, as seen in malware like Silver
  Sparrow. If confirmed malicious, this could allow an attacker to maintain persistence,
  execute arbitrary commands, and potentially escalate privileges on the compromised
  system.
required_fields:
- _time
- columns.cmdline
rule: eventtype="osquery-process" "columns.cmdline"="*LaunchAgents*" OR "columns.cmdline"="*RunAtLoad*"
  OR "columns.cmdline"="*true*" |  `suspicious_plistbuddy_usage_via_osquery_filter`
