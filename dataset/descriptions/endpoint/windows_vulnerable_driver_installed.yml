description: The following analytic detects the loading of known vulnerable Windows
  drivers, which may indicate potential persistence or privilege escalation attempts.
  It leverages Windows System service install EventCode 7045 to identify driver loading
  events and cross-references them with a list of vulnerable drivers. This activity
  is significant as attackers often exploit vulnerable drivers to gain elevated privileges
  or maintain persistence on a system. If confirmed malicious, this could allow attackers
  to execute arbitrary code with high privileges, leading to further system compromise
  and potential data exfiltration. This detection is a Windows Event Log adaptation
  of the Sysmon driver loaded detection written by Michael Haag.
required_fields:
- ServiceType
- driver_name
rule: eventtype=wineventlog_system EventCode=7045 ServiceType="kernel mode driver"
  | table _time dest EventCode ImagePath ServiceName ServiceType | lookup loldrivers
  driver_name AS ImagePath OUTPUT is_driver driver_description | search is_driver
  = TRUE  | `windows_vulnerable_driver_installed_filter`
