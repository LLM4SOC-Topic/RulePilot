description: The following analytic detects the use of Wake-on-LAN commands associated
  with Ryuk ransomware. It leverages data from Endpoint Detection and Response (EDR)
  agents, focusing on specific process and command-line activities. This behavior
  is significant as Ryuk ransomware uses Wake-on-LAN to power on devices in a compromised
  network, increasing its encryption success rate. If confirmed malicious, this activity
  could lead to widespread ransomware encryption across multiple endpoints, causing
  significant operational disruption and data loss. Immediate isolation and thorough
  investigation of the affected endpoints are crucial to mitigate the impact.
required_fields:
- _time
- Processes.process
- Processes.dest
- Processes.user
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process="*8 LAN*" OR Processes.process="*9
  REP*") by Processes.dest Processes.user Processes.parent_process Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `ryuk_wake_on_lan_command_filter`'
