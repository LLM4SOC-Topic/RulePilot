description: The following analytic detects the use of the curl command with specific
  switches (-F, --form, --upload-file, -T, -d, --data, --data-raw, -I, --head) to
  upload AWS credentials or configuration files to a remote destination. This detection
  leverages data from Endpoint Detection and Response (EDR) agents, focusing on command-line
  executions and process details. This activity is significant as it may indicate
  an attempt to exfiltrate sensitive AWS credentials, a technique known to be used
  by the TeamTNT group. If confirmed malicious, this could lead to unauthorized access
  and potential compromise of AWS resources.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=curl Processes.process
  IN ("*-F *", "*--form *","*--upload-file *","*-T *","*-d *","*--data *","*--data-raw
  *", "*-I *", "*--head *") AND Processes.process IN ("*.aws/credentials*". "*.aws/config*")
  by Processes.dest Processes.user Processes.parent_process_name Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_curl_upload_file_filter`'
