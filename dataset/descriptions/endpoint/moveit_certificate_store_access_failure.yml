description: This detection identifies potential exploitation attempts of the CVE-2024-5806
  vulnerability in Progress MOVEit Transfer. It looks for log entries indicating failures
  to access the certificate store, which can occur when an attacker attempts to exploit
  the authentication bypass vulnerability. This behavior is a key indicator of attempts
  to impersonate valid users without proper credentials. While certificate store access
  failures can occur during normal operations, an unusual increase in such events,
  especially from unexpected sources, may indicate malicious activity.
required_fields:
- source
- _raw
rule: 'sourcetype="sftp_server_logs" "IpWorksKeyService: Caught exception of type
  IPWorksSSHException: The certificate store could not be opened"| stats count by
  source _raw | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `moveit_certificate_store_access_failure_filter`'
