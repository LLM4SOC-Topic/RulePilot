description: The following analytic identifies a suspicious modification to the Windows
  auto update configuration registry. It detects changes to the registry path "*\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\\AutoInstallMinorUpdates"
  with a value of "0x00000000". This activity is significant as it is commonly used
  by adversaries, including malware like RedLine Stealer, to bypass detection and
  deploy additional payloads. If confirmed malicious, this modification could allow
  attackers to evade defenses, potentially leading to further system compromise and
  exploitation of zero-day vulnerabilities.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_path
- Registry.user
- Registry.dest
- Registry.registry_value_name
- Registry.action
- Registry.registry_value_data
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Registry where Registry.registry_path="*\\SOFTWARE\\Policies\\Microsoft\\Windows\\WindowsUpdate\\AU\\AutoInstallMinorUpdates"
  AND Registry.registry_value_data="0x00000000" by Registry.dest Registry.user Registry.registry_path
  Registry.registry_value_data Registry.registry_key_name | `drop_dm_object_name(Registry)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_modify_registry_auto_minor_updates_filter`'
