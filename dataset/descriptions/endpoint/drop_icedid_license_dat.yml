description: The following analytic detects the dropping of a suspicious file named
  "license.dat" in %appdata% or %programdata%. This behavior is associated with the
  IcedID malware, which uses this file to inject its core bot into other processes
  for banking credential theft. The detection leverages Sysmon EventCode 11 to monitor
  file creation events in these directories. This activity is significant as it indicates
  a potential malware infection aiming to steal sensitive banking information. If
  confirmed malicious, the attacker could gain unauthorized access to financial data,
  leading to significant financial loss and data breaches.
required_fields:
- _time
rule: sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational EventCode= 11  TargetFilename = "*\\license.dat"
  AND (TargetFilename="*\\appdata\\*" OR TargetFilename="*\\programdata\\*") |stats
  count min(_time) as firstTime max(_time) as lastTime by TargetFilename EventCode
  process_id  process_name dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `drop_icedid_license_dat_filter`
