description: The following analytic detects the copying of Chrome's Local State and
  Login Data files into temporary folders, a tactic often used by the Braodo stealer
  malware. These files contain encrypted user credentials, including saved passwords
  and login session details. The detection monitors for suspicious copying activity
  involving these specific Chrome files, particularly in temp directories where malware
  typically processes the stolen data. Identifying this behavior enables security
  teams to act quickly, preventing attackers from decrypting and exfiltrating sensitive
  browser credentials and mitigating the risk of unauthorized access.
required_fields:
- _time
- Filesystem.dest
- Filesystem.file_create_time
- Filesystem.file_name
- Filesystem.user
- Filesystem.file_path
rule: '|tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Filesystem where Filesystem.file_name IN ("Local State",
  "Login Data") Filesystem.file_path = "*\\temp\\*" by _time Filesystem.dest Filesystem.user
  Filesystem.file_name Filesystem.file_path  Filesystem.file_create_time | `drop_dm_object_name(Filesystem)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_credentials_from_password_stores_chrome_copied_in_temp_dir_filter`'
