description: The following analytic detects the execution of the 'doas' tool on a
  Linux host. This tool allows standard users to perform tasks with root privileges,
  similar to 'sudo'. The detection leverages data from Linux Auditd, focusing on process
  names and command-line executions. This activity is significant as 'doas' can be
  exploited by adversaries to gain elevated privileges on a compromised host. If confirmed
  malicious, this could lead to unauthorized administrative access, potentially compromising
  the entire system.
required_fields:
- _time
- comm
- exe
- SYSCALL
- UID
- ppid
- pid
rule: sourcetype="linux:audit" type=SYSCALL comm=doas | rename host as dest | stats
  count min(_time) as firstTime max(_time) as lastTime by comm exe  SYSCALL UID ppid
  pid success dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `linux_auditd_doas_tool_execution_filter`
