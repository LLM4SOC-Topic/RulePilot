description: The following analytic detects the use of AppCmd.exe to disable HTTP
  logging on IIS servers. It leverages data from Endpoint Detection and Response (EDR)
  agents, focusing on process execution events where AppCmd.exe is used with specific
  parameters to alter logging settings. This activity is significant because disabling
  HTTP logging can help adversaries hide their tracks and avoid detection by removing
  evidence of their actions. If confirmed malicious, this could allow attackers to
  operate undetected, making it difficult to trace their activities and respond to
  the intrusion effectively.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where NOT (Processes.parent_process_name  IN ("msiexec.exe",
  "iissetup.exe")) Processes.process_name=appcmd.exe Processes.process IN ("*set config*",
  "*httplogging*","*dontlog:true*") by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.original_file_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_disable_windows_event_logging_disable_http_logging_filter`'
