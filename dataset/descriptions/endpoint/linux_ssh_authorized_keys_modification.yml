description: The following analytic detects the modification of SSH Authorized Keys
  on Linux systems. It leverages process execution data from Endpoint Detection and
  Response (EDR) agents, specifically monitoring commands like "bash" and "cat" interacting
  with "authorized_keys" files. This activity is significant as adversaries often
  modify SSH Authorized Keys to establish persistent access to compromised endpoints.
  If confirmed malicious, this behavior could allow attackers to maintain unauthorized
  access, bypassing traditional authentication mechanisms and potentially leading
  to further exploitation or data exfiltration.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where  Processes.process_name IN ("bash","cat")
  Processes.process IN ("*/authorized_keys*") by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_ssh_authorized_keys_modification_filter`'
