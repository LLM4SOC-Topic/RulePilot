description: The following analytic detects the deletion of SSL certificates on a
  Linux machine. It leverages filesystem event logs to identify when files with extensions
  .pem or .crt are deleted from the /etc/ssl/certs/ directory. This activity is significant
  because attackers may delete or modify SSL certificates to disable security features
  or evade defenses on a compromised system. If confirmed malicious, this behavior
  could indicate an attempt to disrupt secure communications, evade detection, or
  execute a destructive payload, potentially leading to significant security breaches
  and data loss.
required_fields:
- _time
- Filesystem.dest
- Filesystem.file_create_time
- Filesystem.file_name
- Filesystem.process_guid
- Filesystem.file_path
- Filesystem.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Filesystem where Filesystem.action=deleted Filesystem.file_path
  = "/etc/ssl/certs/*" Filesystem.file_path IN ("*.pem", "*.crt") by _time span=1h
  Filesystem.file_name Filesystem.file_path Filesystem.dest Filesystem.process_guid
  Filesystem.action | `drop_dm_object_name(Filesystem)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `linux_deletion_of_ssl_certificate_filter`'
