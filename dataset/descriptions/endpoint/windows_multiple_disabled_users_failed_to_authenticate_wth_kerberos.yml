description: The following analytic detects a single source endpoint failing to authenticate
  with 30 unique disabled domain users using the Kerberos protocol within 5 minutes.
  It leverages Windows Security Event 4768, focusing on failure code `0x12`, indicating
  revoked credentials. This activity is significant as it may indicate a Password
  Spraying attack targeting disabled accounts, a tactic used by adversaries to gain
  initial access or elevate privileges. If confirmed malicious, this could lead to
  unauthorized access or privilege escalation within the Active Directory environment,
  posing a severe security risk.
required_fields:
- _time
- EventCode
- Status
- TargetUserName
- IpAddress
rule: eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode=4768 TargetUserName!=*$ Status=0x12 | bucket span=5m _time | stats dc(TargetUserName)
  AS unique_accounts values(TargetUserName) as user by _time, IpAddress | where unique_accounts
  > 30 | `windows_multiple_disabled_users_failed_to_authenticate_wth_kerberos_filter`
