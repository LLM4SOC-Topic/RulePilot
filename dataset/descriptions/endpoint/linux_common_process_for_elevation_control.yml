description: The following analytic identifies the execution of common Linux processes
  used for elevation control, such as `chmod`, `chown`, and `setuid`. It leverages
  data from Endpoint Detection and Response (EDR) agents, focusing on process names
  and command-line executions. This activity is significant because these processes
  are often abused by adversaries to gain persistence or escalate privileges on compromised
  hosts. If confirmed malicious, this behavior could allow attackers to modify file
  attributes, change file ownership, or set user IDs, potentially leading to unauthorized
  access and control over critical system resources.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name IN ("chmod", "chown",
  "fchmod", "fchmodat", "fchown", "fchownat", "fremovexattr", "fsetxattr", "lchown",
  "lremovexattr", "lsetxattr", "removexattr", "setuid", "setgid", "setreuid", "setregid",
  "chattr") OR Processes.process IN ("*chmod *", "*chown *", "*fchmod *", "*fchmodat
  *", "*fchown *", "*fchownat *", "*fremovexattr *", "*fsetxattr *", "*lchown *",
  "*lremovexattr *", "*lsetxattr *", "*removexattr *", "*setuid *", "*setgid *", "*setreuid
  *", "*setregid *", "*setcap *", "*chattr *") by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.process_guid | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_common_process_for_elevation_control_filter`'
