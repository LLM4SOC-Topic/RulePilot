description: The following analytic detects the renaming of microsoft.workflow.compiler.exe,
  a rarely used executable typically located in C:\Windows\Microsoft.NET\Framework64\v4.0.30319.
  This detection leverages Endpoint Detection and Response (EDR) data, focusing on
  process names and original file names. This activity is significant because renaming
  this executable can indicate an attempt to evade security controls. If confirmed
  malicious, an attacker could use this renamed executable to execute arbitrary code,
  potentially leading to privilege escalation or persistent access within the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name!=microsoft.workflow.compiler.exe
  AND Processes.original_file_name=Microsoft.Workflow.Compiler.exe by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id Processes.original_file_name |
  `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `suspicious_microsoft_workflow_compiler_rename_filter`'
