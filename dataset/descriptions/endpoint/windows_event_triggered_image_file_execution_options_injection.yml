description: The following analytic identifies the creation or modification of Image
  File Execution Options (IFEO) registry keys, detected via EventCode 3000 in the
  Application channel. This detection leverages Windows Event Logs to monitor for
  process names added to IFEO under specific registry paths. This activity is significant
  as it can indicate attempts to set traps for process monitoring or debugging, often
  used by attackers for persistence or evasion. If confirmed malicious, this could
  allow an attacker to execute arbitrary code or manipulate process behavior, leading
  to potential system compromise.
required_fields:
- _time
- Process
- Exit_Code
- dest
- EventCode
rule: eventtype=wineventlog_application OR source="XmlWinEventLog:Application" EventCode=3000
  | rename param1 AS "Process" param2 AS "Exit_Code" | stats count min(_time) as firstTime
  max(_time) as lastTime by Process Exit_Code dest | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_event_triggered_image_file_execution_options_injection_filter`
