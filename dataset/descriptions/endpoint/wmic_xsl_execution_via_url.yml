description: The following analytic detects `wmic.exe` loading a remote XSL script
  via a URL. This detection leverages Endpoint Detection and Response (EDR) data,
  focusing on command-line executions that include HTTP/HTTPS URLs and the /FORMAT
  switch. This activity is significant as it indicates a potential application control
  bypass, allowing adversaries to execute JScript or VBScript within an XSL file.
  If confirmed malicious, this technique can enable attackers to execute arbitrary
  code, escalate privileges, or maintain persistence using a trusted Windows tool,
  posing a severe threat to the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=wmic.exe OR Processes.original_file_name=wmic.exe)
  Processes.process IN ("*http://*", "*https://*") Processes.process="*/format:*"
  by Processes.parent_process_name Processes.original_file_name Processes.parent_process
  Processes.process_name Processes.process_id Processes.process Processes.dest Processes.user
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `wmic_xsl_execution_via_url_filter`'
