description: The following analytic detects access attempts to privileged Active Directory
  objects, such as Domain Admins or Enterprise Admins. It leverages Windows Security
  Event Code 4662 to identify when these sensitive objects are accessed. This activity
  is significant because such objects should rarely be accessed by normal users or
  processes, and unauthorized access attempts may indicate attacker enumeration or
  lateral movement within the domain. If confirmed malicious, this activity could
  allow attackers to escalate privileges, persist in the environment, or gain control
  over critical domain resources.
required_fields:
- _time
- EventCode
- ObjectName
- EventCode
- Computer
- SubjectUserName
rule: eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode=4662 ObjectName IN ( "CN=Account Operators,*", "CN=Administrators,*",
  "CN=Backup Operators,*", "CN=Cert Publishers,*", "CN=Certificate Service DCOM Access,*",
  "CN=Domain Admins,*", "CN=Domain Controllers,*", "CN=Enterprise Admins,*", "CN=Enterprise
  Read-only Domain Controllers,*", "CN=Group Policy Creator Owners,*", "CN=Incoming
  Forest Trust Builders,*", "CN=Microsoft Exchange Servers,*", "CN=Network Configuration
  Operators,*", "CN=Power Users,*", "CN=Print Operators,*", "CN=Read-only Domain Controllers,*",
  "CN=Replicators,*", "CN=Schema Admins,*", "CN=Server Operators,*", "CN=Exchange
  Trusted Subsystem,*", "CN=Exchange Windows Permission,*", "CN=Organization Management,*")
  | rex field=ObjectName "CN\=(?<object_name>[^,]+)" | stats values(Computer) as dest,
  values(object_name) as object_name, dc(ObjectName) as object_count, min(_time) as
  firstTime, max(_time) as lastTime, count by SubjectUserName | rename SubjectUserName
  as user | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_ad_privileged_object_access_activity_filter`
