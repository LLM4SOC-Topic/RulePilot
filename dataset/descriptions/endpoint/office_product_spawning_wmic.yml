description: The following analytic detects any Windows Office Product spawning `wmic.exe`,
  specifically when the command-line of `wmic.exe` contains `wmic process call create`.
  This behavior is identified using data from Endpoint Detection and Response (EDR)
  agents, focusing on process and parent process relationships. This activity is significant
  as it is commonly associated with the Ursnif malware family, indicating potential
  malicious activity. If confirmed malicious, this could allow an attacker to execute
  arbitrary commands, leading to further system compromise, data exfiltration, or
  lateral movement within the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.parent_process_name IN ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe","onenote.exe","onenotem.exe","onenoteviewer.exe","onenoteim.exe","msaccess.exe",
  "Graph.exe","winproj.exe") (Processes.process_name=wmic.exe OR Processes.original_file_name=wmic.exe)
  by Processes.dest Processes.user Processes.parent_process_name Processes.parent_process
  Processes.process_name Processes.original_file_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `office_product_spawning_wmic_filter`'
