description: The following analytic identifies processes launching netsh.exe, a command-line
  utility used to modify network configurations. It detects this activity by analyzing
  data from Endpoint Detection and Response (EDR) agents, focusing on process GUIDs,
  names, parent processes, and command-line executions. This behavior is significant
  because netsh.exe can be exploited to execute malicious helper DLLs, serving as
  a persistence mechanism. If confirmed malicious, an attacker could gain persistent
  access, modify network settings, and potentially escalate privileges, posing a severe
  threat to the network's integrity and security.
required_fields:
- _time
- Processes.process
- Processes.parent_process_name
- Processes.parent_process
- Processes.process_name
- Processes.user
- Processes.dest
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count values(Processes.process) AS Processes.process
  min(_time) as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes
  where (Processes.process_name=netsh.exe OR Processes.original_file_name=netsh.exe)
  by Processes.parent_process_name Processes.parent_process Processes.original_file_name
  Processes.process_name Processes.user Processes.dest |`drop_dm_object_name("Processes")`
  |convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) |convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) |`processes_launching_netsh_filter`'
