description: The following analytic identifies the execution of the rundll32.exe process
  with the "plugininit" parameter. This detection leverages data from Endpoint Detection
  and Response (EDR) agents, focusing on process creation events and command-line
  arguments. This activity is significant because the "plugininit" parameter is commonly
  associated with IcedID malware, which uses it to execute an initial DLL stager to
  download additional payloads. If confirmed malicious, this behavior could lead to
  further malware infections, data exfiltration, or complete system compromise.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=rundll32.exe OR
  Processes.original_file_name=RUNDLL32.EXE) Processes.process=*PluginInit* by  Processes.process_name
  Processes.process Processes.parent_process_name Processes.original_file_name Processes.parent_process
  Processes.process_id Processes.parent_process_id Processes.dest Processes.user |
  `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `suspicious_rundll32_plugininit_filter`'
