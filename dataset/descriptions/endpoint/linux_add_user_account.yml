description: The following analytic detects the creation of new user accounts on Linux
  systems using commands like "useradd" or "adduser." It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process names and command-line
  executions. This activity is significant as adversaries often create new user accounts
  to establish persistence on compromised hosts. If confirmed malicious, this could
  allow attackers to maintain access, escalate privileges, and further compromise
  the system, posing a severe security risk.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count from datamodel=Endpoint.Processes where Processes.process_name
  IN ("useradd", "adduser") OR Processes.process IN ("*useradd *", "*adduser *") by
  Processes.dest Processes.user Processes.parent_process_name Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id Processes.process_guid
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_add_user_account_filter`'
