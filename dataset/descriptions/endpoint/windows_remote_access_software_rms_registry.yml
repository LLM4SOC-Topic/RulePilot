description: The following analytic detects the creation or modification of Windows
  registry entries related to the Remote Manipulator System (RMS) Remote Admin tool.
  It leverages data from the Endpoint.Registry datamodel, focusing on registry paths
  containing "SYSTEM\\Remote Manipulator System." This activity is significant because
  RMS, while legitimate, is often abused by adversaries, such as in the Azorult malware
  campaigns, to gain unauthorized remote access. If confirmed malicious, this could
  allow attackers to remotely control the targeted host, leading to potential data
  exfiltration, system manipulation, or further network compromise.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_path
- Registry.user
- Registry.dest
- Registry.registry_value_name
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry where Registry.registry_path= "*\\SYSTEM\\Remote
  Manipulator System*" by Registry.registry_key_name Registry.user Registry.registry_path
  Registry.registry_value_data Registry.action Registry.dest | `drop_dm_object_name(Registry)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_remote_access_software_rms_registry_filter`'
