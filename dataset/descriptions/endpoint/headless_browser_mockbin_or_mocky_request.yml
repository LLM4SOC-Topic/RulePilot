description: The following analytic detects headless browser activity accessing mockbin.org
  or mocky.io. It identifies processes with the "--headless" and "--disable-gpu" command
  line arguments, along with references to mockbin.org or mocky.io. This behavior
  is significant as headless browsers are often used for automated tasks, including
  malicious activities like web scraping or automated attacks. If confirmed malicious,
  this activity could indicate an attempt to bypass traditional browser security measures,
  potentially leading to data exfiltration or further exploitation of web applications.
required_fields:
- Processes.dest
- Processes.user
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process="*--headless*" AND Processes.process="*--disable-gpu*"
  AND (Processes.process="*mockbin.org/*" OR Processes.process="*mocky.io/*")) by
  Processes.dest Processes.user Processes.parent_process Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `headless_browser_mockbin_or_mocky_request_filter`'
