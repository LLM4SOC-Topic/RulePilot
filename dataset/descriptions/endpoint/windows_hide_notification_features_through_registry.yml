description: The following analytic detects suspicious registry modifications aimed
  at hiding common Windows notification features on a compromised host. It leverages
  data from the Endpoint.Registry data model, focusing on specific registry paths
  and values. This activity is significant as it is often used by ransomware to obscure
  visual indicators, increasing the impact of the attack. If confirmed malicious,
  this could prevent users from noticing critical system alerts, thereby aiding the
  attacker in maintaining persistence and furthering their malicious activities undetected.
required_fields:
- _time
- Registry.dest
- Registry.registry_value_name
- Registry.registry_key_name
- Registry.registry_path
- Registry.registry_value_data
- Registry.process_guid
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry WHERE (Registry.registry_path= "*\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\*"
  Registry.registry_value_name IN ("HideClock", "HideSCAHealth", "HideSCANetwork",
  "HideSCAPower", "HideSCAVolume") Registry.registry_value_data = "0x00000001") BY
  _time span=1h Registry.dest Registry.user Registry.registry_path Registry.registry_key_name
  Registry.registry_value_name Registry.registry_value_data Registry.process_guid
  | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_hide_notification_features_through_registry_filter`'
