description: The following analytic detects the creation of files in the /etc/profile.d
  directory on Linux systems. It leverages filesystem data to identify new files in
  this directory, which is often used by adversaries for persistence by executing
  scripts upon system boot. This activity is significant as it may indicate an attempt
  to maintain long-term access to the compromised host. If confirmed malicious, this
  could allow attackers to execute arbitrary code with elevated privileges each time
  the system boots, potentially leading to further compromise and data exfiltration.
required_fields:
- _time
- Filesystem.dest
- Filesystem.file_create_time
- Filesystem.file_name
- Filesystem.process_guid
- Filesystem.file_path
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Filesystem where Filesystem.file_path IN ("*/etc/profile.d/*")
  by Filesystem.dest Filesystem.file_create_time Filesystem.file_name Filesystem.process_guid
  Filesystem.file_path | `drop_dm_object_name(Filesystem)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_file_creation_in_profile_directory_filter`'
