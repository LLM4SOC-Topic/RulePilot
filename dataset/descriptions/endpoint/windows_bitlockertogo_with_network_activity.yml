description: The following analytic detects suspicious usage of BitLockerToGo.exe,
  which has been observed being abused by Lumma stealer malware. The malware leverages
  this legitimate Windows utility to manipulate registry keys, search for cryptocurrency
  wallets and credentials, and exfiltrate sensitive data. This activity is significant
  because BitLockerToGo.exe provides functionality for viewing, copying, and writing
  files as well as modifying registry branches - capabilities that the Lumma stealer
  exploits for malicious purposes. If confirmed malicious, this could indicate an
  active data theft campaign targeting cryptocurrency wallets, browser credentials,
  and password manager archives. The detection focuses on identifying BitLockerToGo.exe
  execution patterns that deviate from normal system behavior.
required_fields:
- _time
- process_name
- process_guid
- Computer
- query
- answer
- QueryResults
- QueryStatus
- dest
rule: sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational EventCode=22 process_name="bitlockertogo.exe"
  | stats count min(_time) as firstTime max(_time) as lastTime values(query) as query
  values(answer) as answer values(QueryResults) as query_results values(QueryStatus)
  as query_status by process_name process_guid Computer | rename Computer as dest
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_bitlockertogo_with_network_activity_filter`
