description: The following analytic detects the use of the Linux 'xclip' command to
  copy data from the clipboard. It leverages Linux Auditd telemetry, focusing on process
  names and command-line arguments related to clipboard operations. This activity
  is significant because adversaries can exploit clipboard data to capture sensitive
  information such as passwords or IP addresses. If confirmed malicious, this technique
  could lead to unauthorized data exfiltration, compromising sensitive information
  and potentially aiding further attacks within the environment.
required_fields:
- _time
- argc
- process_exec
rule: sourcetype="linux:audit" type=EXECVE | eval relevant_fields=if(type="EXECVE",
  "", relevant_fields) | foreach a* [eval relevant_fields=if(type="EXECVE", mvappend(relevant_fields,
  '<<FIELD>>'), relevant_fields)] | eval process_exec=if(type="EXECVE", mvjoin(relevant_fields,
  " "), process_exec) | eval process_exec=if(type="EXECVE", trim(process_exec), process_exec)
  | rename host as dest | where LIKE(process_exec, "%xclip%") AND (LIKE(process_exec,
  "%clipboard%") OR LIKE(process_exec, "%-o%") OR LIKE(process_exec, "%clip %") OR
  LIKE(process_exec, "%-selection %") OR LIKE(process_exec, "%sel %")) | stats count
  min(_time) as firstTime max(_time) as lastTime by argc process_exec dest | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| `linux_auditd_clipboard_data_copy_filter`
