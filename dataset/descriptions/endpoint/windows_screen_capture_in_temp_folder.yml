description: The following analytic detects the creation of screen capture files by
  the Braodo stealer malware. This stealer is known to capture screenshots of the
  victim's desktop as part of its data theft activities. The detection focuses on
  identifying unusual screen capture activity, especially when images are saved in
  directories often used by malware, such as temporary or hidden folders. Monitoring
  for these files helps to quickly identify malicious screen capture attempts, allowing
  security teams to respond and mitigate potential information exposure before sensitive
  data is compromised.
required_fields:
- _time
- Filesystem.dest
- Filesystem.file_create_time
- Filesystem.file_name
- Filesystem.user
- Filesystem.file_path
rule: '|tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Filesystem where Filesystem.file_name IN ("screenshot.png",
  "screenshot.jpg","screenshot.bmp") Filesystem.file_path = "*\\temp\\*" by _time
  Filesystem.file_name Filesystem.file_path Filesystem.dest Filesystem.file_create_time
  | `drop_dm_object_name(Filesystem)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_screen_capture_in_temp_folder_filter`'
