description: The following analytic detects the use of the 'dd' command to overwrite
  files on a Linux system. It leverages data from Linux Auditd telemetry, focusing
  on process execution logs that include command-line details. This activity is significant
  because adversaries often use the 'dd' command to destroy or irreversibly overwrite
  files, disrupting system availability and services. If confirmed malicious, this
  behavior could lead to data destruction, making recovery difficult and potentially
  causing significant operational disruptions.
required_fields:
- _time
- proctitle
rule: sourcetype="linux:audit" type=PROCTITLE | eval normalized_proctitle_delimiter
  = if(type=="PROCTITLE" AND isnotnull(proctitle), if(match(proctitle,"^[0-9A-F]+$"),
  replace(proctitle, "000", "020"),proctitle),null()) | eval normalized_proctitle_delimiter  =
  if(type=="PROCTITLE" AND isnotnull(proctitle), if(match(normalized_proctitle_delimiter,"^[0-9A-F]+$"),
  replace(normalized_proctitle_delimiter, "00", "20"),normalized_proctitle_delimiter),null())
  | eval process_exec = if(match(normalized_proctitle_delimiter,"^[0-9A-F]+$"),urldecode(replace(normalized_proctitle_delimiter,"([0-9A-F]{2})","%\1")),normalized_proctitle_delimiter)
  | rename host as dest | where LIKE(process_exec, "%dd %") AND LIKE(process_exec,
  "% of=%") | stats count min(_time) as firstTime max(_time) as lastTime by process_exec
  proctitle normalized_proctitle_delimiter dest | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `linux_auditd_dd_file_overwrite_filter`
