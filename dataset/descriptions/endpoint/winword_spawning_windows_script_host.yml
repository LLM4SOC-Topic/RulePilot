description: The following analytic identifies instances where Microsoft Winword.exe
  spawns Windows Script Host processes (cscript.exe or wscript.exe). This behavior
  is detected using Endpoint Detection and Response (EDR) telemetry, focusing on process
  creation events where the parent process is Winword.exe. This activity is significant
  because it is uncommon and often associated with spearphishing attacks, where malicious
  scripts are executed via document macros. If confirmed malicious, this could lead
  to code execution, allowing attackers to gain initial access, execute further payloads,
  or establish persistence within the environment.
required_fields:
- _time
- process_name
- process_id
- parent_process_name
- dest
- user
- parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.parent_process_name="winword.exe"
  Processes.process_name IN ("cscript.exe", "wscript.exe") by Processes.dest Processes.user
  Processes.parent_process Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `winword_spawning_windows_script_host_filter`'
