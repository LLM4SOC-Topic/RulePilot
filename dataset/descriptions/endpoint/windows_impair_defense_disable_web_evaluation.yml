description: The following analytic detects modifications to the Windows registry
  entry "EnableWebContentEvaluation" to disable Windows Defender web content evaluation.
  It leverages data from the Endpoint.Registry datamodel, specifically monitoring
  changes where the registry value is set to "0x00000000". This activity is significant
  as it indicates an attempt to impair browser security features, potentially allowing
  malicious web content to bypass security checks. If confirmed malicious, this could
  lead to users interacting with harmful scripts or unsafe web elements, increasing
  the risk of system exploitation and security breaches.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_value_name
- Registry.dest
- Registry.user
- Registry.registry_path
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry WHERE Registry.registry_path= "*\\Windows\\CurrentVersion\\AppHost\\EnableWebContentEvaluation"  Registry.registry_value_data=
  "0x00000000" BY Registry.dest Registry.user Registry.registry_path Registry.registry_key_name
  Registry.registry_value_name Registry.registry_value_data Registry.process_guid
  | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_impair_defense_disable_web_evaluation_filter`'
