description: The following analytic detects the creation or modification of Windows
  services using the sc.exe command. It leverages data from Endpoint Detection and
  Response (EDR) agents, focusing on process names and command-line arguments. This
  activity is significant because manipulating Windows services can be a method for
  attackers to establish persistence, escalate privileges, or execute arbitrary code.
  If confirmed malicious, this behavior could allow an attacker to maintain long-term
  access, disrupt services, or gain control over critical system functions, posing
  a severe threat to the environment.
required_fields:
- _time
- Processes.process_name
- Processes.process
- Processes.parent_process_name
- Processes.dest
- Processes.user
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` values(Processes.process) as process min(_time)
  as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name
  = sc.exe (Processes.process="* create *" OR Processes.process="* config *") by Processes.process_name
  Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `sc_exe_manipulating_windows_services_filter`'
