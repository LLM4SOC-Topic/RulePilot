description: The following analytic detects the presence of any version of the 3CXDesktopApp,
  also known as the 3CX Desktop App, on Mac or Windows systems. It leverages the Endpoint
  data model's Processes node to identify instances of the application running, although
  it does not provide file version information. This activity is significant because
  3CX has identified vulnerabilities in versions 18.12.407 and 18.12.416, which could
  be exploited by attackers. If confirmed malicious, this could lead to unauthorized
  access, data exfiltration, or further compromise of the affected systems.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=3CXDesktopApp.exe
  OR Processes.process_name="3CX Desktop App" by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.original_file_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `hunting_3cxdesktopapp_software_filter`'
