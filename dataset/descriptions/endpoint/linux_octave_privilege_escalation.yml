description: The following analytic detects the execution of GNU Octave with elevated
  privileges, specifically when it runs system commands via sudo. It leverages data
  from Endpoint Detection and Response (EDR) agents, focusing on process command-line
  arguments that include "octave-cli," "--eval," "system," and "sudo." This activity
  is significant because it indicates a potential privilege escalation attempt, allowing
  a user to execute commands as root. If confirmed malicious, this could lead to full
  system compromise, enabling an attacker to gain root access and execute arbitrary
  commands, severely impacting system security and integrity.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process="*octave-cli*" AND Processes.process="*--eval*"
  AND Processes.process="*system*" AND Processes.process="*sudo*" by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id Processes.process_guid | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_octave_privilege_escalation_filter`'
