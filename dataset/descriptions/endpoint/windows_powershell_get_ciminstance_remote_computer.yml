description: The following analytic detects the use of the Get-CimInstance cmdlet
  with the -ComputerName parameter, indicating an attempt to retrieve information
  from a remote computer. It leverages PowerShell Script Block Logging to identify
  this specific command execution. This activity is significant as it may indicate
  unauthorized remote access or information gathering by an attacker. If confirmed
  malicious, this could allow the attacker to collect sensitive data from remote systems,
  potentially leading to further exploitation or lateral movement within the network.
required_fields:
- _time
- ScriptBlockText
- Computer
- EventCode
rule: (source=WinEventLog:Microsoft-Windows-PowerShell/Operational OR source="XmlWinEventLog:Microsoft-Windows-PowerShell/Operational")
  EventCode=4104 ScriptBlockText="*get-ciminstance*" AND ScriptBlockText="*computername*"  |
  stats count min(_time) as firstTime max(_time) as lastTime by EventCode ScriptBlockText
  Computer user_id | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_powershell_get_ciminstance_remote_computer_filter`
