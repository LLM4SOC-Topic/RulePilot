description: The following analytic identifies the loading of the malicious SolarWinds.Orion.Core.BusinessLayer.dll
  by SolarWinds.BusinessLayerHost.exe and subsequent DNS queries to avsvmcloud.com.
  It uses Sysmon EventID 7 for DLL loading and Event ID 22 for DNS queries, correlating
  these events within a 12-14 day period. This activity is significant as it indicates
  potential Sunburst malware infection, a known supply chain attack. If confirmed
  malicious, this could lead to unauthorized network access, data exfiltration, and
  further compromise of the affected systems.
required_fields:
- _time
- EventCode
- ImageLoaded
- QueryName
rule: (sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational EventCode=7 ImageLoaded=*SolarWinds.Orion.Core.BusinessLayer.dll)
  OR (sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational EventCode=22 QueryName=*avsvmcloud.com)
  | eventstats dc(EventCode) AS dc_events | where dc_events=2 | stats min(_time) as
  firstTime max(_time) as lastTime values(ImageLoaded) AS ImageLoaded values(QueryName)
  AS QueryName by host | rename host as dest | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `sunburst_correlation_dll_and_network_event_filter`
