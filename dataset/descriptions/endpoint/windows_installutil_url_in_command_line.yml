description: The following analytic detects the use of Windows InstallUtil.exe with
  an HTTP or HTTPS URL in the command line. This is identified through Endpoint Detection
  and Response (EDR) telemetry, focusing on command-line executions containing URLs.
  This activity is significant as it may indicate an attempt to download and execute
  malicious code, potentially bypassing application control mechanisms. If confirmed
  malicious, this could lead to unauthorized code execution, privilege escalation,
  or persistent access within the environment. Analysts should review the parent process,
  network connections, file modifications, and related processes for further investigation.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=installutil.exe
  OR Processes.original_file_name=InstallUtil.exe) Processes.process IN ("*http://*","*https://*")
  by Processes.dest Processes.user Processes.parent_process_name Processes.process_name
  Processes.original_file_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_installutil_url_in_command_line_filter`'
