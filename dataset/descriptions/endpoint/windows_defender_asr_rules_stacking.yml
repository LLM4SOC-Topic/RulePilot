description: The following analytic identifies security events from Microsoft Defender,
  focusing on Exploit Guard and Attack Surface Reduction (ASR) features. It detects
  Event IDs 1121, 1126, 1131, and 1133 for blocked operations, and Event IDs 1122,
  1125, 1132, and 1134 for audit logs. Event ID 1129 indicates user overrides, while
  Event ID 5007 signals configuration changes. This detection uses a lookup to correlate
  ASR rule GUIDs with descriptive names. Monitoring these events is crucial for identifying
  unauthorized operations, potential security breaches, and policy enforcement issues.
  If confirmed malicious, attackers could bypass security measures, execute unauthorized
  actions, or alter system configurations.
required_fields:
- host
- Parent_Commandline
- Target_Commandline
- ID
- EventCode
- ASR_Rule
rule: source="WinEventLog:Microsoft-Windows-Windows Defender/Operational" EventCode
  IN (1121, 1122, 1125, 1126, 1129, 1131, 1132, 1133, 1134, 5007) | stats count min(_time)
  as firstTime max(_time) as lastTime by host Parent_Commandline, Process_Name, Path,
  ID, EventCode | lookup asr_rules ID OUTPUT ASR_Rule | fillnull value=NULL | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| rename host as dest | `windows_defender_asr_rules_stacking_filter`
