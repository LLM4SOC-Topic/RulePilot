description: The following analytic identifies command-line activity that searches
  for files related to password manager software, such as "*.kdbx*" and "*credential*".
  It leverages data from Endpoint Detection and Response (EDR) agents, focusing on
  process execution logs. This activity is significant because attackers often target
  password manager databases to extract stored credentials, which can be used for
  further exploitation. If confirmed malicious, this behavior could lead to unauthorized
  access to sensitive information, enabling attackers to escalate privileges, move
  laterally, or exfiltrate critical data.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
- Processes.parent_process_guid
- Processes.process_guid
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process = "*dir *" OR  Processes.process
  = "*findstr*" AND Processes.process IN ( "*.kdbx*", "*credential*", "*key3.db*","*pass*",
  "*cred*", "*key4.db*", "*accessTokens*", "*access_tokens*", "*.htpasswd*", "*Ntds.dit*")
  by Processes.process_name Processes.original_file_name Processes.process Processes.process_id
  Processes.process_guid Processes.parent_process_name Processes.parent_process Processes.parent_process_guid
  Processes.dest Processes.user | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_password_managers_discovery_filter`'
