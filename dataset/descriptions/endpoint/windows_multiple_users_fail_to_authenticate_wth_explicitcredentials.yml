description: The following analytic identifies a source user failing to authenticate
  with 30 unique users using explicit credentials on a host. It leverages Windows
  Event 4648, which is generated when a process attempts an account logon by explicitly
  specifying account credentials. This detection is significant as it may indicate
  a Password Spraying attack, where an adversary attempts to gain initial access or
  elevate privileges within an Active Directory environment. If confirmed malicious,
  this activity could lead to unauthorized access, privilege escalation, and potential
  compromise of sensitive information.
required_fields:
- _time
- EventCode
- Target_User_Name
- Caller_User_Name
- Computer
rule: eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode=4648 Caller_User_Name!=*$ Target_User_Name!=*$ | bucket span=5m _time
  | stats dc(Target_User_Name) AS unique_accounts values(Target_User_Name) as  tried_account
  by _time, Computer, Caller_User_Name | where unique_accounts > 30 | `windows_multiple_users_fail_to_authenticate_wth_explicitcredentials_filter`
