description: The following analytic detects attempts to stop or clear a service on
  Linux systems. It leverages data from Endpoint Detection and Response (EDR) agents,
  focusing on processes like "systemctl," "service," and "svcadm" executing stop commands.
  This activity is significant as adversaries often terminate security or critical
  services to disable defenses or disrupt operations, as seen in malware like Industroyer2.
  If confirmed malicious, this could lead to the disabling of security mechanisms,
  allowing attackers to persist, escalate privileges, or deploy destructive payloads,
  severely impacting system integrity and availability.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name IN ("systemctl",
  "service", "svcadm")  Processes.process ="*stop*" by Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.process_guid Processes.dest Processes.user | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_stop_services_filter`'
