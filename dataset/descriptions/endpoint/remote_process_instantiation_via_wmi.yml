description: The following analytic detects the execution of wmic.exe with parameters
  to spawn a process on a remote system. It leverages data from Endpoint Detection
  and Response (EDR) agents, focusing on command-line executions and process telemetry
  mapped to the `Processes` node of the `Endpoint` data model. This activity is significant
  as WMI can be abused for lateral movement and remote code execution, often used
  by adversaries and Red Teams. If confirmed malicious, this could allow attackers
  to execute arbitrary code on remote systems, facilitating further compromise and
  lateral spread within the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=wmic.exe OR Processes.original_file_name=wmic.exe)
  (Processes.process="*/node:*" AND Processes.process="*process*" AND Processes.process="*call*"
  AND  Processes.process="*create*") by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)|
  convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `remote_process_instantiation_via_wmi_filter`'
