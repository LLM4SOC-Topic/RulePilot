description: The following analytic identifies the usage of microsoft.workflow.compiler.exe,
  a rarely utilized executable typically found in C:\Windows\Microsoft.NET\Framework64\v4.0.30319.
  This detection leverages data from Endpoint Detection and Response (EDR) agents,
  focusing on process execution telemetry. The significance of this activity lies
  in its uncommon usage, which may indicate malicious intent such as code execution
  or persistence mechanisms. If confirmed malicious, an attacker could leverage this
  process to execute arbitrary code, potentially leading to unauthorized access or
  further compromise of the system.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=microsoft.workflow.compiler.exe
  OR Processes.original_file_name=Microsoft.Workflow.Compiler.exe) by Processes.dest
  Processes.parent_process Processes.process_name Processes.original_file_name Processes.process
  Processes.user | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `suspicious_microsoft_workflow_compiler_usage_filter`'
