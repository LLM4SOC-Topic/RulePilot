description: The following analytic detects modifications to the Windows registry
  key "ProxyEnable" to enable proxy settings. It leverages data from the Endpoint.Registry
  datamodel, specifically monitoring changes to the "Internet Settings\ProxyEnable"
  registry path. This activity is significant as it is commonly exploited by malware
  and adversaries to establish proxy communication, potentially connecting to malicious
  Command and Control (C2) servers. If confirmed malicious, this could allow attackers
  to redirect network traffic through a proxy, facilitating unauthorized communication
  and data exfiltration, thereby compromising the security of the affected host.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_path
- Registry.user
- Registry.dest
- Registry.registry_value_name
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Registry where Registry.registry_path = "*\\Internet Settings\\ProxyEnable"  Registry.registry_value_data
  = 0x00000001 by  Registry.registry_path Registry.registry_value_name Registry.registry_value_data
  Registry.process_guid Registry.action Registry.user Registry.dest | `drop_dm_object_name(Registry)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_modify_registry_proxyenable_filter`'
