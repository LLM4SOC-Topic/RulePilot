description: The following analytic detects regasm.exe spawning a child process. This
  behavior is identified using data from Endpoint Detection and Response (EDR) agents,
  focusing on process creation events where regasm.exe is the parent process. This
  activity is significant because regasm.exe spawning a process is rare and can indicate
  an attempt to bypass application control mechanisms. If confirmed malicious, this
  could allow an attacker to execute arbitrary code, potentially leading to privilege
  escalation or persistent access within the environment. Immediate investigation
  is recommended to determine the legitimacy of the spawned process and any associated
  activities.
required_fields:
- _time
- Processes.parent_process_name
- Processes.dest
- Processes.user
- Processes.parent_process
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.parent_process_name=regasm.exe
  NOT (Processes.process_name IN ("conhost.exe")) by Processes.dest Processes.user
  Processes.parent_process Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `detect_regasm_spawning_a_process_filter`'
