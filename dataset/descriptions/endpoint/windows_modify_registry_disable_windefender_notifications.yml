description: The following analytic detects a suspicious registry modification aimed
  at disabling Windows Defender notifications. It leverages data from the Endpoint.Registry
  data model, specifically looking for changes to the registry path "*\\SOFTWARE\\Policies\\Microsoft\\Windows
  Defender Security Center\\Notifications\\DisableNotifications" with a value of "0x00000001".
  This activity is significant as it indicates an attempt to evade detection by disabling
  security alerts, a technique used by adversaries and malware like RedLine Stealer.
  If confirmed malicious, this could allow attackers to operate undetected, increasing
  the risk of further compromise and data exfiltration.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_path
- Registry.user
- Registry.dest
- Registry.registry_value_name
- Registry.action
- Registry.registry_value_data
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Registry where Registry.registry_path="*\\SOFTWARE\\Policies\\Microsoft\\Windows
  Defender Security Center\\Notifications\\DisableNotifications" AND Registry.registry_value_data="0x00000001"
  by Registry.dest Registry.user Registry.registry_path Registry.registry_value_data
  Registry.registry_key_name | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_modify_registry_disable_windefender_notifications_filter`'
