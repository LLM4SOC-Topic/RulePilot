description: The following analytic identifies a source host failing to authenticate
  against a remote host with 30 unique users. It leverages Windows Event 4625 with
  Logon Type 3, indicating remote authentication attempts. This behavior is significant
  as it may indicate a Password Spraying attack, where an adversary attempts to gain
  initial access or elevate privileges in an Active Directory environment. If confirmed
  malicious, this activity could lead to unauthorized access, privilege escalation,
  and potential compromise of sensitive information. This detection is crucial for
  real-time security monitoring and threat hunting.
required_fields:
- _time
- EventCode
- Logon_Type
- TargetUserName
- Computer
- IpAddress
rule: eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode=4625 Logon_Type=3 IpAddress!="-" | bucket span=5m _time | stats dc(TargetUserName)
  AS unique_accounts values(TargetUserName) as tried_accounts by _time, IpAddress,
  Computer | rename Computer as dest| where unique_accounts > 30 | `windows_multiple_users_remotely_failed_to_authenticate_from_host_filter`
