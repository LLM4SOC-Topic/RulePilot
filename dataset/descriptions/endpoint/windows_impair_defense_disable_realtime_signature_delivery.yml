description: The following analytic detects modifications to the Windows registry
  that disable the Windows Defender real-time signature delivery feature. It leverages
  data from the Endpoint.Registry data model, specifically monitoring changes to the
  registry path associated with Windows Defender signature updates. This activity
  is significant because disabling real-time signature delivery can prevent Windows
  Defender from receiving timely malware definitions, reducing its effectiveness.
  If confirmed malicious, this action could allow attackers to bypass malware detection,
  leading to potential system compromise and persistent threats.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_value_name
- Registry.dest
- Registry.user
- Registry.registry_path
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry where Registry.registry_path= "*\\Windows Defender\\Signature
  Updates\\RealtimeSignatureDelivery" Registry.registry_value_data="0x00000000" by
  Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data
  Registry.action Registry.dest | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_impair_defense_disable_realtime_signature_delivery_filter`'
