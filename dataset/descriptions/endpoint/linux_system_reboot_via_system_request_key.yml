description: The following analytic detects the execution of the SysReq hack to reboot
  a Linux system host. It leverages Endpoint Detection and Response (EDR) data to
  identify processes executing the command to pipe 'b' to /proc/sysrq-trigger. This
  activity is significant as it is an uncommon method to reboot a system and was observed
  in the Awfulshred malware wiper. If confirmed malicious, this technique could indicate
  the presence of suspicious processes and potential system compromise, leading to
  unauthorized reboots and disruption of services.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.process_name
- Processes.process_path
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name IN ("dash", "sudo",
  "bash")  Processes.process =  "* echo b &gt; *" Processes.process = "*/proc/sysrq-trigger"
  by Processes.dest Processes.user Processes.parent_process_name Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id Processes.process_guid
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | `linux_system_reboot_via_system_request_key_filter`'
