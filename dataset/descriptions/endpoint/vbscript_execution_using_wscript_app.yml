description: The following analytic detects the execution of VBScript using the wscript.exe
  application. It leverages data from Endpoint Detection and Response (EDR) agents,
  focusing on process and command-line telemetry. This activity is significant because
  wscript.exe is typically not used to execute VBScript, which is usually associated
  with cscript.exe. This deviation can indicate an attempt to evade traditional process
  monitoring and antivirus defenses. If confirmed malicious, this technique could
  allow attackers to execute arbitrary code, potentially leading to system compromise,
  data exfiltration, or further lateral movement within the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.parent_process_name = "wscript.exe"
  AND Processes.parent_process = "*//e:vbscript*") OR (Processes.process_name = "wscript.exe"
  AND Processes.process = "*//e:vbscript*") by Processes.parent_process_name Processes.parent_process
  Processes.process_name Processes.process_id Processes.process Processes.dest Processes.user
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `vbscript_execution_using_wscript_app_filter`'
