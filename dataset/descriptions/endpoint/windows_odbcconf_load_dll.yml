description: The following analytic detects the execution of odbcconf.exe with the
  regsvr action to load a DLL. This is identified by monitoring command-line arguments
  in process creation logs from Endpoint Detection and Response (EDR) agents. This
  activity is significant as it may indicate an attempt to execute arbitrary code
  via DLL loading, a common technique used in various attack vectors. If confirmed
  malicious, this could allow an attacker to execute code with the privileges of the
  odbcconf.exe process, potentially leading to system compromise or further lateral
  movement.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=odbcconf.exe Processes.process
  IN ("*/a *",  "*-a*") Processes.process="*regsvr*"  by Processes.dest Processes.user
  Processes.parent_process_name Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_odbcconf_load_dll_filter`'
