description: The following analytic detects the use of default or publicly known named
  pipes associated with Cobalt Strike. It leverages Sysmon EventID 17 and 18 to identify
  specific named pipes commonly used by Cobalt Strike's Artifact Kit and Malleable
  C2 Profiles. This activity is significant because Cobalt Strike is a popular tool
  for adversaries to conduct post-exploitation tasks, and identifying its named pipes
  can reveal potential malicious activity. If confirmed malicious, this could indicate
  an active Cobalt Strike beacon, leading to unauthorized access, data exfiltration,
  or further lateral movement within the network.
required_fields:
- _time
- EventID
- PipeName
- dest
- process_name
- process_path
- process_id
rule: sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational EventID=17 OR EventID=18 PipeName IN (\\msagent_*,
  \\DserNamePipe*, \\srvsvc_*, \\postex_*, \\status_*, \\MSSE-*, \\spoolss_*, \\win_svc*,
  \\ntsvcs*, \\winsock*, \\UIA_PIPE*)  | stats count min(_time) as firstTime max(_time)
  as lastTime by dest, process_name, process_id process_path, PipeName | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `cobalt_strike_named_pipes_filter`
