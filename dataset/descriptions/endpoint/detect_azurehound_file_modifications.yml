description: The following analytic detects the creation of specific AzureHound-related
  files, such as `*-azurecollection.zip` and various `.json` files, on disk. It leverages
  data from the Endpoint.Filesystem datamodel, focusing on file creation events with
  specific filenames. This activity is significant because AzureHound is a tool used
  to gather information about Azure environments, similar to SharpHound for on-premises
  Active Directory. If confirmed malicious, this activity could indicate an attacker
  is collecting sensitive Azure environment data, potentially leading to further exploitation
  or privilege escalation within the cloud infrastructure.
required_fields:
- _time
- file_path
- dest
- file_name
- process_id
- file_create_time
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Filesystem where Filesystem.file_name IN ("*-azurecollection.zip",
  "*-azprivroleadminrights.json", "*-azglobaladminrights.json", "*-azcloudappadmins.json",
  "*-azapplicationadmins.json") by Filesystem.file_create_time Filesystem.process_id  Filesystem.file_name
  Filesystem.file_path Filesystem.dest Filesystem.user | `drop_dm_object_name(Filesystem)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `detect_azurehound_file_modifications_filter`'
