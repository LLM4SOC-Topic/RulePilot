description: The following analytic detects the execution of the rundll32.exe command
  with the user32.dll,LockWorkStation parameter, which is used to lock the workstation
  via command line. This detection leverages data from Endpoint Detection and Response
  (EDR) agents, focusing on process names and command-line executions. This activity
  is significant as it is an uncommon method to lock a screen and has been observed
  in CONTI ransomware tooling for defense evasion. If confirmed malicious, this technique
  could indicate an attempt to evade detection and hinder incident response efforts.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=rundll32.exe Processes.process=
  "*user32.dll,LockWorkStation*" by Processes.dest Processes.user Processes.parent_process
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.parent_process_name | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `rundll32_lockworkstation_filter`'
