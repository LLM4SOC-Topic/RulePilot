description: The following analytic detects modifications to the Windows registry
  that disable Windows Defender Network Protection. It leverages data from the Endpoint.Registry
  data model, specifically monitoring changes to the EnableNetworkProtection registry
  entry. This activity is significant because disabling Network Protection can leave
  the system vulnerable to network-based threats by preventing Windows Defender from
  analyzing and blocking malicious network activity. If confirmed malicious, this
  action could allow attackers to bypass security measures, potentially leading to
  unauthorized access, data exfiltration, or further compromise of the network.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_value_name
- Registry.dest
- Registry.user
- Registry.registry_path
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry where Registry.registry_path= "*\\Windows Defender\\Windows
  Defender Exploit Guard\\Network Protection\\EnableNetworkProtection" Registry.registry_value_data="0x00000000"
  by Registry.registry_key_name Registry.user Registry.registry_path Registry.registry_value_data
  Registry.action Registry.dest | `drop_dm_object_name(Registry)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_impair_defense_disable_win_defender_network_protection_filter`'
