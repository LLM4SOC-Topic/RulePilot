description: The following analytic detects the execution of the 'visudo' utility
  to modify the /etc/sudoers file on a Linux system. It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process execution logs. This activity
  is significant because unauthorized changes to the /etc/sudoers file can grant elevated
  privileges to users, potentially allowing adversaries to execute commands as root.
  If confirmed malicious, this could lead to full system compromise, privilege escalation,
  and persistent unauthorized access, severely impacting the security posture of the
  affected host.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name = visudo by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id Processes.process_guid | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_visudo_utility_execution_filter`'
