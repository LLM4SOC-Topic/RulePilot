description: The following analytic identifies instances where `WinRAR.exe` has been
  renamed and executed. It leverages data from Endpoint Detection and Response (EDR)
  agents, focusing on process names and original file names within the Endpoint data
  model. This activity is significant because renaming executables is a common tactic
  used by attackers to evade detection. If confirmed malicious, this could indicate
  an attempt to bypass security controls, potentially leading to unauthorized data
  extraction or further system compromise.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.original_file_name=WinRAR.exe
  (Processes.process_name!=rar.exe OR Processes.process_name!=winrar.exe) by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id Processes.original_file_name |
  `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `detect_renamed_winrar_filter`'
