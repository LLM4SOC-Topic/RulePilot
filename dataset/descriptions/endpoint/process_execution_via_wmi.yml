description: The following analytic detects the execution of a process by `WmiPrvSE.exe`,
  indicating potential use of WMI (Windows Management Instrumentation) for process
  creation. This detection leverages data from Endpoint Detection and Response (EDR)
  agents, focusing on process and parent process relationships. This activity is significant
  as WMI can be used for lateral movement, remote code execution, or persistence by
  attackers. If confirmed malicious, this could allow an attacker to execute arbitrary
  commands or scripts, potentially leading to further compromise of the affected system
  or network.
required_fields:
- _time
- Processes.process
- Processes.parent_process_name
- Processes.user
- Processes.dest
- Processes.process_name
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.parent_process_name=WmiPrvSE.exe
  NOT (Processes.process IN ("*\\dismhost.exe*")) by Processes.dest Processes.user
  Processes.parent_process Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `process_execution_via_wmi_filter`'
