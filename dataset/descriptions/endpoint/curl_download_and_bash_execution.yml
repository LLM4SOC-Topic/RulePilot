description: The following analytic detects the use of curl on Linux or MacOS systems
  to download a file from a remote source and pipe it directly to bash for execution.
  This detection leverages data from Endpoint Detection and Response (EDR) agents,
  focusing on process names, command-line arguments, and parent processes. This activity
  is significant as it is commonly associated with malicious actions such as coinminers
  and exploitation of vulnerabilities like CVE-2021-44228 in Log4j. If confirmed malicious,
  this behavior could lead to unauthorized code execution, system compromise, and
  further exploitation within the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=curl (Processes.process="*-s
  *") AND (Processes.process="*|*" AND Processes.process="*bash*") by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `curl_download_and_bash_execution_filter`'
