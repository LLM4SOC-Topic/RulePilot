description: The following analytic identifies the use of Ldifde.exe, a command-line
  utility for creating, modifying, or deleting LDAP directory objects. This detection
  leverages data from Endpoint Detection and Response (EDR) agents, focusing on process
  execution and command-line arguments. Monitoring Ldifde.exe is significant because
  it can be used by attackers to manipulate directory objects, potentially leading
  to unauthorized changes or data exfiltration. If confirmed malicious, this activity
  could allow an attacker to gain control over directory services, escalate privileges,
  or access sensitive information within the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=ldifde.exe Processes.process
  IN ("*-i *", "*-f *") by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.original_file_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_ldifde_directory_object_behavior_filter`'
