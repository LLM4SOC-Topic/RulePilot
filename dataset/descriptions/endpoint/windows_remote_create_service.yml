description: The following analytic identifies the creation of a new service on a
  remote endpoint using sc.exe. It leverages data from Endpoint Detection and Response
  (EDR) agents, specifically monitoring for EventCode 7045, which indicates a new
  service creation. This activity is significant as it may indicate lateral movement
  or remote code execution attempts by an attacker. If confirmed malicious, this could
  allow the attacker to establish persistence, escalate privileges, or execute arbitrary
  code on the remote system, potentially leading to further compromise of the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=sc.exe Processes.process
  IN ("*create*")  Processes.process="*\\\\*" by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.original_file_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_remote_create_service_filter`'
