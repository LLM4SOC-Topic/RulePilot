description: The following analytic identifies Office applications spawning child
  processes to download content via HTTP/HTTPS. It leverages data from Endpoint Detection
  and Response (EDR) agents, focusing on process creation events where Office applications
  like Word or Excel initiate network connections, excluding common browsers. This
  activity is significant as it often indicates the use of malicious documents to
  execute living-off-the-land binaries (LOLBins) for payload delivery. If confirmed
  malicious, this behavior could lead to unauthorized code execution, data exfiltration,
  or further malware deployment, posing a severe threat to the organization's security.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.parent_process_name IN ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe","onenote.exe","onenotem.exe","onenoteviewer.exe","onenoteim.exe","msaccess.exe",
  "Graph.exe","winproj.exe") Processes.process IN ("*http:*","*https:*") NOT (Processes.original_file_name
  IN("firefox.exe", "chrome.exe","iexplore.exe","msedge.exe"))  by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id Processes.original_file_name |
  `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `office_document_spawned_child_process_to_download_filter`'
