description: The following analytic detects the execution of Syncappvpublishingserver.vbs
  via wscript.exe or cscript.exe, which may indicate an attempt to download remote
  files or perform privilege escalation. This detection leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process names and command-line
  executions. Monitoring this activity is crucial as it can signify malicious use
  of a native Windows script for unauthorized actions. If confirmed malicious, this
  behavior could lead to unauthorized file downloads or elevated privileges, posing
  a significant security risk.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name IN ("wscript.exe","cscript.exe")
  Processes.process="*syncappvpublishingserver.vbs*" by Processes.dest Processes.user
  Processes.parent_process_name Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_system_script_proxy_execution_syncappvpublishingserver_filter`'
