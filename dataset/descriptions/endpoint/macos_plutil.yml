description: The following analytic detects the usage of the `plutil` command to modify
  plist files on macOS systems. It leverages osquery to monitor process events, specifically
  looking for executions of `/usr/bin/plutil`. This activity is significant because
  adversaries can use `plutil` to alter plist files, potentially adding malicious
  binaries or command-line arguments that execute upon user logon or system startup.
  If confirmed malicious, this could allow attackers to achieve persistence, execute
  arbitrary code, or escalate privileges, posing a significant threat to the system's
  security.
required_fields:
- _time
- columns.cmdline
- columns.pid
- columns.parent
- columns.path
- columns.signing_id
- columns.username
- host
rule: sourcetype=osquery:results name=es_process_events columns.path=/usr/bin/plutil
  | rename columns.* as * | stats count  min(_time) as firstTime max(_time) as lastTime
  by username host cmdline pid path parent signing_id | rename username as user, cmdline
  as process, path as process_path, host as dest | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `macos_plutil_filter`
