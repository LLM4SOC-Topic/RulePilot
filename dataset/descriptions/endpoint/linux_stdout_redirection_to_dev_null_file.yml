description: The following analytic detects command-line activities that redirect
  stdout or stderr to the /dev/null file. It leverages data from Endpoint Detection
  and Response (EDR) agents, focusing on process execution logs. This behavior is
  significant as it can indicate attempts to hide command outputs, a technique observed
  in the CyclopsBlink malware to conceal modifications to iptables firewall settings.
  If confirmed malicious, this activity could allow an attacker to stealthily alter
  system configurations, potentially leading to unauthorized access or persistent
  control over the compromised machine.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where  Processes.process = "*&amp;&gt;/dev/null*"
  by  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.process_guid Processes.dest Processes.user Processes.parent_process_name
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_stdout_redirection_to_dev_null_file_filter`'
