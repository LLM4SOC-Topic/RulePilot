description: The following analytic detects the use of the Linux 'xclip' command to
  copy data from the clipboard. It leverages Endpoint Detection and Response (EDR)
  telemetry, focusing on process names and command-line arguments related to clipboard
  operations. This activity is significant because adversaries can exploit clipboard
  data to capture sensitive information such as passwords or IP addresses. If confirmed
  malicious, this technique could lead to unauthorized data exfiltration, compromising
  sensitive information and potentially aiding further attacks within the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=xclip Processes.process
  IN ("*-o *", "*-sel *", "*-selection *", "*clip *","*clipboard*") by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_clipboard_data_copy_filter`'
