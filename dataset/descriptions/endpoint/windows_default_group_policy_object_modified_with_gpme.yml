description: The following analytic detects modifications to default Group Policy
  Objects (GPOs) using the Group Policy Management Editor (GPME). It leverages the
  Endpoint data model to identify processes where `mmc.exe` executes `gpme.msc` with
  specific GUIDs related to default GPOs. This activity is significant because default
  GPOs, such as the `Default Domain Controllers Policy` and `Default Domain Policy`,
  are critical for enforcing security policies across the domain. If malicious, such
  modifications could allow an attacker to gain further access, establish persistence,
  or deploy malware across numerous hosts, severely compromising the network's security.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=mmc.exe (Processes.process
  =*gpme.msc*) AND (Processes.process = "*31B2F340-016D-11D2-945F-00C04FB984F9*" OR
  Processes.process = "*6AC1786C-016F-11D2-945F-00C04fB984F9*"  ) by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_default_group_policy_object_modified_with_gpme_filter`'
