description: The following analytic detects any Windows Office Product spawning `bitsadmin.exe`,
  a behavior often associated with malware families like TA551 and IcedID. This detection
  leverages data from Endpoint Detection and Response (EDR) agents, focusing on process
  and parent process relationships. This activity is significant because `bitsadmin.exe`
  is commonly used for malicious file transfers, potentially indicating a malware
  infection. If confirmed malicious, this activity could allow attackers to download
  additional payloads, escalate privileges, or establish persistence, leading to further
  compromise of the affected system.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.parent_process_name IN ("winword.exe","excel.exe","powerpnt.exe","mspub.exe","visio.exe","onenote.exe","onenotem.exe","onenoteviewer.exe","onenoteim.exe",
  "msaccess.exe", "Graph.exe","winproj.exe") (Processes.process_name=bitsadmin.exe
  OR Processes.original_file_name=bitsadmin.exe) by Processes.dest Processes.user  Processes.parent_process_name
  Processes.parent_process Processes.process_name Processes.original_file_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `office_product_spawning_bitsadmin_filter`'
