description: The following analytic detects the use of 'schtasks.exe' to schedule
  forced system reboots using the 'shutdown' and '/create' flags. It leverages endpoint
  process data to identify instances where these specific command-line arguments are
  used. This activity is significant because it may indicate an adversary attempting
  to disrupt operations or force a reboot to execute further malicious actions. If
  confirmed malicious, this could lead to system downtime, potential data loss, and
  provide an attacker with an opportunity to execute additional payloads or evade
  detection.
required_fields:
- _time
- Processes.process
- Processes.process_name
- Processes.parent_process_name
- Processes.dest
- Processes.user
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` values(Processes.process) as process min(_time)
  as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name=schtasks.exe
  Processes.process="*shutdown*" Processes.process="*/create *" by Processes.process_name
  Processes.parent_process_name Processes.dest Processes.user | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `schtasks_used_for_forcing_a_reboot_filter`'
