description: The following analytic detects the execution of `netstat.exe` with command-line
  arguments to list network connections on a system. It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process names, command-line executions,
  and parent processes. This activity is significant as both Red Teams and adversaries
  use `netstat.exe` for situational awareness and Active Directory discovery. If confirmed
  malicious, this behavior could allow attackers to map network connections, identify
  critical systems, and plan further lateral movement or data exfiltration.
required_fields:
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name="netstat.exe") (Processes.process=*-a*)
  by Processes.dest Processes.user Processes.parent_process Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `network_connection_discovery_with_netstat_filter`'
