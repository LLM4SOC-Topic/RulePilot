description: The following analytic detects the execution of "bcdedit.exe" with parameters
  to set the boot status policy to ignore all failures. It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process names and command-line
  arguments. This activity is significant because it can indicate an attempt by ransomware
  to prevent a compromised machine from booting into automatic repair mode, thereby
  hindering recovery efforts. If confirmed malicious, this action could allow attackers
  to maintain control over the infected system, complicating remediation and potentially
  leading to further damage.
required_fields:
- _time
- Processes.parent_process_name
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.dest
- Processes.user
- Processes.process_id
- Processes.process_guid
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name = "bcdedit.exe" Processes.process
  = "*bootstatuspolicy*"  Processes.process = "*ignoreallfailures*" by Processes.parent_process_name
  Processes.parent_process Processes.process_name Processes.process Processes.dest
  Processes.user Processes.process_id Processes.process_guid | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| `prevent_automatic_repair_mode_using_bcdedit_filter`'
