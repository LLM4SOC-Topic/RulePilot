description: The following analytic detects attempts to access or dump the contents
  of /etc/passwd and /etc/shadow files on Linux systems. It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on processes like 'cat', 'nano', 'vim',
  and 'vi' accessing these files. This activity is significant as it may indicate
  credential dumping, a technique used by adversaries to gain persistence or escalate
  privileges. If confirmed malicious, attackers could obtain hashed passwords for
  offline cracking, leading to unauthorized access and potential system compromise.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name IN("cat", "nano*","vim*",
  "vi*")  AND Processes.process IN("*/etc/shadow*", "*/etc/passwd*") by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_possible_access_to_credential_files_filter`'
