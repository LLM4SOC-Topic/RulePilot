description: The following analytic detects the execution of an arbitrary DLL by the
  Windows Remote Auto Dialer (rasautou.exe). This behavior is identified by analyzing
  process creation events where rasautou.exe is executed with specific command-line
  arguments. This activity is significant because it leverages a Living Off The Land
  Binary (LOLBin) to execute potentially malicious code, bypassing traditional security
  controls. If confirmed malicious, this technique could allow an attacker to execute
  arbitrary code, potentially leading to system compromise, privilege escalation,
  or persistent access within the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=rasautou.exe Processes.process="*
  -d *"AND Processes.process="* -p *" by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.original_file_name | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_rasautou_dll_execution_filter`'
