description: The following analytic detects modifications to the Windows registry
  key "DisableRemoteDesktopAntiAlias" with a value set to 0x00000001. This detection
  leverages data from the Endpoint datamodel, specifically monitoring changes in the
  Registry node. This activity is significant as it may indicate the presence of DarkGate
  malware, which alters this registry setting to enhance its remote desktop capabilities.
  If confirmed malicious, this modification could allow an attacker to maintain persistence
  and control over the compromised host, potentially leading to further exploitation
  and data exfiltration.
required_fields:
- _time
- Registry.registry_key_name
- Registry.registry_path
- Registry.user
- Registry.dest
- Registry.registry_value_name
- Registry.action
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Registry where Registry.registry_path = "*\\Terminal Services\\DisableRemoteDesktopAntiAlias"  Registry.registry_value_data
  = 0x00000001 by  Registry.registry_path Registry.registry_value_name Registry.registry_value_data
  Registry.process_guid Registry.action Registry.user Registry.dest | `drop_dm_object_name(Registry)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_modify_registry_disableremotedesktopantialias_filter`'
