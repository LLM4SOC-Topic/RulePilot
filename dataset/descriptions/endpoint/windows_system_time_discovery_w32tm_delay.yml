description: The following analytic identifies the use of the w32tm.exe utility with
  the /stripchart function, which is indicative of DCRat malware delaying its payload
  execution. This detection leverages data from Endpoint Detection and Response (EDR)
  agents, focusing on specific command-line arguments used by w32tm.exe. This activity
  is significant as it may indicate an attempt to evade detection by delaying malicious
  actions such as C2 communication and beaconing. If confirmed malicious, this behavior
  could allow an attacker to maintain persistence and execute further malicious activities
  undetected.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` values(Processes.process) as process min(_time)
  as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where Processes.process_name
  = w32tm.exe Processes.process= "* /stripchart *" Processes.process= "* /computer:localhost
  *" Processes.process= "* /period:*" Processes.process= "* /dataonly *" Processes.process=
  "* /samples:*" by  Processes.parent_process Processes.process_name Processes.original_file_name
  Processes.process Processes.process_id Processes.parent_process_id Processes.dest
  Processes.user | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_system_time_discovery_w32tm_delay_filter`'
