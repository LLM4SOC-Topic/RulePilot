description: The following analytic detects the termination of specific processes
  by the Industroyer2 malware. It leverages Sysmon EventCode 5 to identify when processes
  like "PServiceControl.exe" and "PService_PPD.exe" are killed. This activity is significant
  as it targets processes related to energy facility networks, indicating a potential
  attack on critical infrastructure. If confirmed malicious, this could lead to disruption
  of essential services, loss of control over energy systems, and significant operational
  impact. Immediate investigation is required to determine the cause and mitigate
  any potential threats.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
- Processes.process_guid
rule: sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational EventCode=5 process_name IN ("PServiceControl.exe",
  "PService_PPD.exe") | stats min(_time) as firstTime max(_time) as lastTime count
  by process_name process process_path process_guid process_id EventCode dest user_id
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_processes_killed_by_industroyer2_malware_filter`
