description: The following analytic detects suspicious modifications or new entries
  in the Print Processor registry path. It leverages registry activity data from the
  Endpoint data model to identify changes in the specified registry path. This activity
  is significant because the Print Processor registry is known to be exploited by
  APT groups like Turla for persistence and privilege escalation. If confirmed malicious,
  this could allow an attacker to execute a malicious DLL payload by restarting the
  spoolsv.exe process, leading to potential control over the compromised machine.
required_fields:
- _time
- Registry.dest
- Registry.user
- Registry.registry_path
- Registry.registry_key_name
- Registry.registry_value_name
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count  min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Registry where Registry.registry_path ="*\\Control\\Print\\Environments\\Windows
  x64\\Print Processors*" by Registry.dest  Registry.user Registry.registry_path Registry.registry_key_name
  Registry.registry_value_name | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `drop_dm_object_name(Registry)`
  | `print_processor_registry_autostart_filter`'
