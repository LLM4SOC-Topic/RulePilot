description: The following analytic detects the execution of JavaScript using the
  JScript.Encode CLSID (COM Object) by cscript.exe. It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process names, command-line executions,
  and parent processes. This activity is significant as it is a known technique used
  by ransomware, such as Reddot, to execute malicious scripts and potentially disable
  AMSI (Antimalware Scan Interface). If confirmed malicious, this behavior could allow
  attackers to execute arbitrary code, evade detection, and maintain persistence within
  the environment.
required_fields:
- _time
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.parent_process
- Processes.process_id
- Processes.dest
- Processes.user
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name = "cscript.exe" Processes.process="*-e:{F414C262-6AC0-11CF-B6D1-00AA00BBBB58}*"
  by Processes.parent_process_name Processes.process_name Processes.process Processes.parent_process
  Processes.process_id Processes.dest Processes.user | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `execute_javascript_with_jscript_com_clsid_filter`'
