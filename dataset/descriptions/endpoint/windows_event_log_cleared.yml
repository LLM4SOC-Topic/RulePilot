description: The following analytic detects the clearing of Windows event logs by
  identifying Windows Security Event ID 1102 or System log event 104. This detection
  leverages Windows event logs to monitor for log clearing activities. Such behavior
  is significant as it may indicate an attempt to cover tracks after malicious activities.
  If confirmed malicious, this action could hinder forensic investigations and allow
  attackers to persist undetected, making it crucial to investigate further and correlate
  with other alerts and data sources.
required_fields:
- _time
- EventCode
- dest
rule: (eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode=1102) OR (eventtype=wineventlog_system EventCode=104) | stats count min(_time)
  as firstTime max(_time) as lastTime by dest object EventCode | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_event_log_cleared_filter`
