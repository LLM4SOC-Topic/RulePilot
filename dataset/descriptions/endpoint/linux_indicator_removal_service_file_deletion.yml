description: The following analytic detects the deletion of Linux service unit configuration
  files by suspicious processes. It leverages Endpoint Detection and Response (EDR)
  telemetry, focusing on processes executing the 'rm' command targeting '.service'
  files. This activity is significant as it may indicate malware attempting to disable
  critical services or security products, a common defense evasion tactic. If confirmed
  malicious, this behavior could lead to service disruption, security tool incapacitation,
  or complete system compromise, severely impacting the integrity and availability
  of the affected Linux host.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name = "rm"  AND Processes.process
  = "*rm *"  AND Processes.process = "*.service" by Processes.dest Processes.user
  Processes.parent_process_name Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id Processes.process_guid | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_indicator_removal_service_file_deletion_filter`'
