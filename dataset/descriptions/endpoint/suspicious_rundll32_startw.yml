description: The following analytic identifies the execution of rundll32.exe with
  the DLL function names "Start" and "StartW," commonly associated with Cobalt Strike
  payloads. This detection leverages data from Endpoint Detection and Response (EDR)
  agents, focusing on command-line executions and process metadata. This activity
  is significant as it often indicates the presence of malicious payloads, such as
  Cobalt Strike, which can lead to unauthorized code execution. If confirmed malicious,
  this activity could allow attackers to inject shellcode, escalate privileges, and
  maintain persistence within the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=rundll32.exe OR
  Processes.original_file_name=RUNDLL32.EXE) Processes.process=*start* by Processes.dest
  Processes.user Processes.parent_process Processes.process_name Processes.process
  Processes.original_file_name Processes.process_id Processes.parent_process_id |
  `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `suspicious_rundll32_startw_filter`'
