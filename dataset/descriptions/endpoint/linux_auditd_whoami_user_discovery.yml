description: The following analytic detects the suspicious use of the whoami command,
  which may indicate an attacker trying to gather information about the current user
  account on a compromised system. The whoami command is commonly used to verify user
  privileges and identity, especially during initial stages of an attack to assess
  the level of access. By monitoring for unusual or unauthorized executions of whoami,
  this analytic helps in identifying potential reconnaissance activities, enabling
  security teams to take action before the attacker escalates privileges or conducts
  further malicious operations.
required_fields:
- _time
- comm
- exe
- SYSCALL
- UID
- ppid
- pid
rule: sourcetype="linux:audit" type=SYSCALL comm=whoami OR exe= "*/whoami" | rename
  host as dest | stats count min(_time) as firstTime max(_time) as lastTime by comm
  exe  SYSCALL UID ppid pid dest success | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `linux_auditd_whoami_user_discovery_filter`
