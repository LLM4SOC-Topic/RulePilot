description: The following analytic detects the suspicious termination of known services
  commonly targeted by ransomware before file encryption. It leverages Windows System
  Event Logs (EventCode 7036) to identify when critical services such as Volume Shadow
  Copy, backup, and antivirus services are stopped. This activity is significant because
  ransomware often disables these services to avoid errors and ensure successful file
  encryption. If confirmed malicious, this behavior could lead to widespread data
  encryption, rendering files inaccessible and potentially causing significant operational
  disruption and data loss.
required_fields:
- _time
- EventCode
- Message
- dest
- Type
rule: eventtype=wineventlog_system EventCode=7036 param1 IN ("*Volume Shadow Copy*","*VSS*",
  "*backup*", "*sophos*", "*sql*", "*memtas*", "*mepocs*", "*veeam*", "*svc$*", "DefWatch",
  "ccEvtMgr", "ccSetMgr", "SavRoam", "RTVscan", "QBFCService", "QBIDPService", "Intuit.QuickBooks.FCS",
  "QBCFMonitorService" "YooBackup", "YooIT", "*Veeam*", "PDVFSService", "BackupExecVSSProvider",
  "BackupExecAgentAccelerator", "BackupExec*", "WdBoot", "WdFilter", "WdNisDrv", "WdNisSvc",
  "WinDefend", "wscsvc", "Sense", "sppsvc", "SecurityHealthService") param2="stopped"
  | stats count min(_time) as firstTime max(_time) as lastTime by EventCode param1
  dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `known_services_killed_by_ransomware_filter`
