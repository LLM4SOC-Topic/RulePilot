description: The following analytic detects suspicious attempts to find credentials
  stored in password stores, indicating a potential attacker's effort to access sensitive
  login information. Password stores are critical repositories that contain valuable
  credentials, and unauthorized access to them can lead to significant security breaches.
  By monitoring for unusual or unauthorized activities related to password store access,
  this analytic helps identify potential credential theft attempts, allowing security
  teams to respond promptly and prevent unauthorized access to critical systems and
  data.
required_fields:
- _time
- argc
- process_exec
rule: sourcetype="linux:audit" type=EXECVE | eval relevant_fields=if(type="EXECVE",
  "", relevant_fields) | foreach a* [eval relevant_fields=if(type="EXECVE", mvappend(relevant_fields,
  '<<FIELD>>'), relevant_fields)] | eval process_exec=if(type="EXECVE", mvjoin(relevant_fields,
  " "), process_exec) | eval process_exec=if(type="EXECVE", trim(process_exec), process_exec)
  | rename host as dest | where  (LIKE (process_exec, "%find%") OR LIKE (process_exec,
  "%grep%")) AND (LIKE (process_exec, "%password%") OR LIKE (process_exec, "%pass
  %") OR LIKE (process_exec, "%credential%")OR LIKE (process_exec, "%creds%")) | stats
  count min(_time) as firstTime max(_time) as lastTime by argc process_exec dest |
  convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| `linux_auditd_find_credentials_from_password_stores_filter`
