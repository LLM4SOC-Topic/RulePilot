description: The following analytic detects attempts to authenticate using the built-in
  local Administrator account across more than 30 endpoints within a 5-minute window.
  It leverages Windows Event Logs, specifically events 4625 and 4624, to identify
  this behavior. This activity is significant as it may indicate an adversary attempting
  to validate stolen local credentials across multiple hosts, potentially leading
  to privilege escalation. If confirmed malicious, this could allow the attacker to
  gain widespread access and control over numerous systems within the network, posing
  a severe security risk.
required_fields:
- _time
- EventCode
- Logon_Type
- TargetUserName
- Computer
- IpAddress
rule: eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode=4625 OR EventCode=4624 Logon_Type=3 TargetUserName=Administrator | bucket
  span=5m _time | stats dc(Computer) AS unique_targets values(Computer) as host_targets
  by _time, IpAddress, TargetUserName, EventCode | where unique_targets > 30 | `windows_local_administrator_credential_stuffing_filter`
