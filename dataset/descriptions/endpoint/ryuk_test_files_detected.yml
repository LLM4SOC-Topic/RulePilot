description: The following analytic identifies the presence of files containing the
  keyword "Ryuk" in any folder on the C drive, indicative of Ryuk ransomware activity.
  It leverages the Endpoint Filesystem data model to detect file paths matching this
  pattern. This activity is significant as Ryuk ransomware is known for its destructive
  impact, encrypting critical files and demanding ransom. If confirmed malicious,
  this could lead to significant data loss, operational disruption, and financial
  damage due to ransom payments and recovery efforts. Immediate investigation and
  response are crucial to mitigate potential damage.
required_fields:
- _time
- Filesystem.file_path
- Filesystem.dest
- Filesystem.user
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Filesystem WHERE "Filesystem.file_path"=C:\\*Ryuk* BY "Filesystem.dest",
  "Filesystem.user", "Filesystem.file_path" | `drop_dm_object_name(Filesystem)` |
  convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `ryuk_test_files_detected_filter`'
