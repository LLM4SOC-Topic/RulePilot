description: The following analytic detects the use of the PowerShell cmdlet `export-pfxcertificate`
  on the command line, indicating an attempt to export a certificate from the local
  Windows Certificate Store. This detection leverages data from Endpoint Detection
  and Response (EDR) agents, focusing on process execution logs and command-line arguments.
  This activity is significant as it may indicate an attempt to exfiltrate authentication
  certificates, which can be used to impersonate users or decrypt sensitive data.
  If confirmed malicious, this could lead to unauthorized access and potential data
  breaches.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process="*export-pfxcertificate*"
  by Processes.dest Processes.user Processes.parent_process_name Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_steal_authentication_certificates_export_pfxcertificate_filter`'
