description: The following analytic detects a source process failing to authenticate
  with 30 unique users, indicating a potential Password Spraying attack. It leverages
  Windows Event 4625 with Logon Type 2, collected from domain controllers, member
  servers, and workstations. This activity is significant as it may represent an adversary
  attempting to gain initial access or elevate privileges within an Active Directory
  environment. If confirmed malicious, this could lead to unauthorized access, privilege
  escalation, or further compromise of the network, posing a severe security risk.
required_fields:
- _time
- EventCode
- Logon_Type
- ProcessName
- SubjectUserName
- TargetUserName
- Computer
rule: eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode=4625 Logon_Type=2 ProcessName!="-" | bucket span=5m _time | stats dc(TargetUserName)
  AS unique_accounts values(TargetUserName) as tried_accounts by _time, ProcessName,
  SubjectUserName, Computer | rename Computer as dest | where unique_accounts > 30
  | `windows_multiple_users_failed_to_authenticate_from_process_filter`
