description: The following analytic detects the modification of a firewall rule to
  allow the execution of a specific application. This detection leverages data from
  Endpoint Detection and Response (EDR) agents, focusing on process creation events
  with command-line arguments related to firewall rule changes. This activity is significant
  as it may indicate an attempt to bypass firewall restrictions, potentially allowing
  unauthorized applications to communicate over the network. If confirmed malicious,
  this could enable an attacker to execute arbitrary code, escalate privileges, or
  maintain persistence within the target environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process = "*firewall*" Processes.process
  = "*allow*" Processes.process = "*add*" Processes.process = "*ENABLE*" by Processes.dest
  Processes.user Processes.parent_process_name Processes.parent_process Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `firewall_allowed_program_enable_filter`'
