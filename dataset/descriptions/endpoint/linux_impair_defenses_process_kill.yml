description: The following analytic identifies the execution of the 'pkill' command,
  which is used to terminate processes on a Linux system. It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process names and command-line
  executions. This activity is significant because threat actors often use 'pkill'
  to disable security defenses or terminate critical processes, facilitating further
  malicious actions. If confirmed malicious, this behavior could lead to the disruption
  of security applications, enabling attackers to evade detection and potentially
  corrupt or destroy files on the targeted system.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name IN ( "pgrep", "pkill")
  Processes.process = "*pkill *" by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.process_guid | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_impair_defenses_process_kill_filter`'
