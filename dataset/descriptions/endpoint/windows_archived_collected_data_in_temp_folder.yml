description: The following analytic detects the creation of archived files in a temporary
  folder, which may contain collected data. This behavior is often associated with
  malicious activity, where attackers compress sensitive information before exfiltration.
  The detection focuses on monitoring specific directories, such as temp folders,
  for the presence of newly created archive files (e.g., .zip, .rar, .tar). By identifying
  this pattern, security teams can quickly respond to potential data collection and
  exfiltration attempts, minimizing the risk of data breaches and improving overall
  threat detection.
required_fields:
- _time
- Filesystem.dest
- Filesystem.file_create_time
- Filesystem.file_name
- Filesystem.user
- Filesystem.file_path
rule: '|tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  FROM datamodel=Endpoint.Filesystem where Filesystem.file_name IN ("*.zip", "*.rar",
  "*.tar", "*.7z") Filesystem.file_path = "*\\temp\\*" by _time Filesystem.file_name
  Filesystem.file_path Filesystem.dest Filesystem.file_create_time | `drop_dm_object_name(Filesystem)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_archived_collected_data_in_temp_folder_filter`'
