description: The following analytic detects the execution of the Windows command line
  to log off a host machine. It leverages data from Endpoint Detection and Response
  (EDR) agents, focusing on processes involving `shutdown.exe` with specific parameters.
  This activity is significant as it is often associated with Advanced Persistent
  Threats (APTs) and Remote Access Trojans (RATs) like dcrat, which use this technique
  to disrupt operations, aid in system destruction, or inhibit recovery. If confirmed
  malicious, this could lead to system downtime, data loss, or hindered incident response
  efforts.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` values(Processes.process) as process min(_time)
  as firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name
  = shutdown.exe OR Processes.original_file_name = shutdown.exe) Processes.process="*shutdown*"
  Processes.process IN ("* /l*", "* -l*") Processes.process IN ("* /t*","* -t*","*
  /f*","* -f*") by Processes.dest Processes.user Processes.parent_process Processes.process_name
  Processes.original_file_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_system_logoff_commandline_filter`'
