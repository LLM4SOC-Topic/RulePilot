description: The following analytic identifies the execution of the dxdiag.exe process
  with specific command-line arguments, which is used to gather system information.
  This detection leverages data from Endpoint Detection and Response (EDR) agents,
  focusing on process creation events and command-line details. This activity is significant
  because dxdiag.exe is rarely used in corporate environments and its execution may
  indicate reconnaissance efforts by malicious actors. If confirmed malicious, this
  activity could allow attackers to collect detailed system information, aiding in
  further exploitation or lateral movement within the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=dxdiag.exe OR Processes.original_file_name=dxdiag.exe)
  AND Processes.process = "* /t *" by Processes.dest Processes.user Processes.parent_process_name
  Processes.parent_process Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `system_info_gathering_using_dxdiag_application_filter`'
