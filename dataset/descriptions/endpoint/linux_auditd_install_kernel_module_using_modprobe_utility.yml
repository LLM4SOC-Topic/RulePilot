description: The following analytic detects the installation of a Linux kernel module
  using the modprobe utility. It leverages data from Linux Auditd, focusing on process
  names and command-line executions. This activity is significant because installing
  a kernel module can indicate an attempt to deploy a rootkit or other malicious kernel-level
  code, potentially leading to elevated privileges and bypassing security detections.
  If confirmed malicious, this could allow an attacker to gain persistent, high-level
  access to the system, compromising its integrity and security.
required_fields:
- _time
- comm
- exe
- SYSCALL
- UID
- ppid
- pid
rule: sourcetype="linux:audit" type=SYSCALL comm=modprobe | rename host as dest |
  stats count min(_time) as firstTime max(_time) as lastTime by comm exe  SYSCALL
  UID ppid pid success dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)|
  convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `linux_auditd_install_kernel_module_using_modprobe_utility_filter`
