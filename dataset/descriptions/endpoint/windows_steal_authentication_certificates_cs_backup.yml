description: The following analytic identifies the backup of the Active Directory
  Certificate Services (AD CS) store, detected via Event ID 4876. This event is logged
  when a backup is performed using the CertSrv.msc UI or the CertUtil.exe -BackupDB
  command. Monitoring this activity is crucial as unauthorized backups can indicate
  an attempt to steal authentication certificates, which are critical for secure communications.
  If confirmed malicious, this activity could allow an attacker to impersonate users,
  escalate privileges, or access sensitive information, severely compromising the
  security of the environment.
required_fields:
- _time
- dest
- name
- action
- Caller_Domain
- Caller_User_Name
rule: eventtype=wineventlog_security OR Channel=security OR source=XmlWinEventLog:Security
  EventCode=4876| stats count min(_time) as firstTime max(_time) as lastTime by dest,
  name, action, Caller_Domain ,Caller_User_Name | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_steal_authentication_certificates_cs_backup_filter`
