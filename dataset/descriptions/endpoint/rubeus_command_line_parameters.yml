description: The following analytic detects the use of Rubeus command line parameters,
  a toolset for Kerberos attacks within Active Directory environments. It leverages
  Endpoint Detection and Response (EDR) data to identify specific command-line arguments
  associated with actions like ticket manipulation, kerberoasting, and password spraying.
  This activity is significant as Rubeus is commonly used by adversaries to exploit
  Kerberos for privilege escalation and lateral movement. If confirmed malicious,
  this could lead to unauthorized access, persistence, and potential compromise of
  sensitive information within the network.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
- Processes.parent_process_name
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process = "*ptt /ticket*" OR
  Processes.process = "* monitor /interval*" OR Processes.process ="* asktgt* /user:*"
  OR Processes.process ="* asktgs* /service:*" OR Processes.process ="* golden* /user:*"
  OR Processes.process ="* silver* /service:*" OR Processes.process ="* kerberoast*"
  OR Processes.process ="* asreproast*" OR Processes.process = "* renew* /ticket:*"
  OR Processes.process = "* brute* /password:*" OR Processes.process = "* brute* /passwords:*"
  OR Processes.process ="* harvest*") by Processes.dest Processes.user Processes.parent_process
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.parent_process_name | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `rubeus_command_line_parameters_filter`'
