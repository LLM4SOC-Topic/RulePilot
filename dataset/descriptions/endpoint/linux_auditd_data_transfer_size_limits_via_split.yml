description: The following analytic detects suspicious data transfer activities that
  involve the use of the `split` syscall, potentially indicating an attempt to evade
  detection by breaking large files into smaller parts. Attackers may use this technique
  to bypass size-based security controls, facilitating the covert exfiltration of
  sensitive data. By monitoring for unusual or unauthorized use of the `split` syscall,
  this analytic helps identify potential data exfiltration attempts, allowing security
  teams to intervene and prevent the unauthorized transfer of critical information
  from the network.
required_fields:
- _time
- argc
- process_exec
rule: sourcetype="linux:audit" type=EXECVE | eval relevant_fields=if(type="EXECVE",
  "", relevant_fields) | foreach a* [eval relevant_fields=if(type="EXECVE", mvappend(relevant_fields,
  '<<FIELD>>'), relevant_fields)] | eval process_exec=if(type="EXECVE", mvjoin(relevant_fields,
  " "), process_exec) | eval process_exec=if(type="EXECVE", trim(process_exec), process_exec)
  | rename host as dest | where LIKE(process_exec, "%split %") AND LIKE(process_exec,
  "% -b %") | stats count min(_time) as firstTime max(_time) as lastTime by argc process_exec
  dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)| `linux_auditd_data_transfer_size_limits_via_split_filter`
