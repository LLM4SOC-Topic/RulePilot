description: The following analytic detects the execution of the `Invoke-AzureHound`
  command-line argument, commonly used by the AzureHound tool. It leverages data from
  Endpoint Detection and Response (EDR) agents, focusing on process names and command-line
  executions. This activity is significant because AzureHound is often used for reconnaissance
  in Azure environments, potentially exposing sensitive information. If confirmed
  malicious, this activity could allow an attacker to map out Azure Active Directory
  structures, aiding in further attacks and privilege escalation.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process IN ("*invoke-azurehound*")
  by Processes.dest Processes.user Processes.parent_process Processes.process_name
  Processes.parent_process_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `detect_azurehound_command_line_arguments_filter`'
