description: The following analytic identifies the execution of RAR utilities to archive
  files on a system. It leverages data from Endpoint Detection and Response (EDR)
  agents, focusing on process names, GUIDs, and command-line arguments. This activity
  is significant as threat actors, including red-teamers and malware like DarkGate,
  use RAR archiving to compress and exfiltrate collected data from compromised hosts.
  If confirmed malicious, this behavior could lead to the unauthorized transfer of
  sensitive information to command and control servers, posing a severe risk to data
  confidentiality and integrity.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
- Processes.parent_process_guid
- Processes.process_guid
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name="Rar.exe" OR Processes.original_file_name
  = "Rar.exe" AND Processes.process = "*a*" Processes.process = "* -ep1*" Processes.process
  = "* -r*" Processes.process = "* -y*" Processes.process = "* -v5m*" Processes.process
  = "* -m1*" by Processes.process_name Processes.original_file_name Processes.process
  Processes.process_id Processes.process_guid Processes.parent_process_name Processes.parent_process
  Processes.parent_process_guid Processes.dest Processes.user | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_archive_collected_data_via_rar_filter`'
