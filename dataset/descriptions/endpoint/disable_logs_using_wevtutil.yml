description: The following analytic detects the execution of "wevtutil.exe" with parameters
  to disable event logs. It leverages data from Endpoint Detection and Response (EDR)
  agents, focusing on process names and command-line arguments. This activity is significant
  because disabling event logs is a common tactic used by ransomware to evade detection
  and hinder forensic investigations. If confirmed malicious, this action could allow
  attackers to operate undetected, making it difficult to trace their activities and
  respond effectively to the incident.
required_fields:
- _time
- Processes.parent_process_name
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.dest
- Processes.user
- Processes.process_id
- Processes.process_guid
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name = "wevtutil.exe"
  AND (Processes.process = "*sl*" OR Processes.process = "*set-log*" ) Processes.process
  = "*/e:false*" by Processes.parent_process_name Processes.parent_process Processes.process_name
  Processes.process Processes.dest Processes.user Processes.process_id Processes.process_guid
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `disable_logs_using_wevtutil_filter`'
