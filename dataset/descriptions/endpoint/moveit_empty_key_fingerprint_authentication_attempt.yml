description: This detection identifies attempts to authenticate with an empty public
  key fingerprint in Progress MOVEit Transfer, which is a key indicator of potential
  exploitation of the CVE-2024-5806 vulnerability. Such attempts are characteristic
  of the authentication bypass technique used in this vulnerability, where attackers
  try to impersonate valid users without providing proper credentials. While occasional
  empty key fingerprint authentication attempts might occur due to misconfigurations,
  a sudden increase or attempts from unexpected sources could signify malicious activity.
  This analytic helps security teams identify and investigate potential exploitation
  attempts of the MOVEit Transfer authentication bypass vulnerability.
required_fields:
- source
- _raw
rule: 'sourcetype="sftp_server_logs" "UserAuthRequestHandler: SftpPublicKeyAuthenticator:
  Attempted to authenticate empty public key fingerprint" | stats count by source
  _raw | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `moveit_empty_key_fingerprint_authentication_attempt_filter`'
