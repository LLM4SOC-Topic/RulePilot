description: The following analytic detects the creation or connection to a named
  pipe associated with Trickbot malware. It leverages Sysmon EventCodes 17 and 18
  to identify named pipes with the pattern "\\pipe\\*lacesomepipe". This activity
  is significant as Trickbot uses named pipes for communication with its command and
  control (C2) servers, facilitating data exfiltration and command execution. If confirmed
  malicious, this behavior could allow attackers to maintain persistence, execute
  arbitrary commands, and exfiltrate sensitive information from the compromised system.
required_fields:
- _time
- dest
- user_id
- EventCode
- PipeName
- signature
- Image
- process_id
rule: sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational EventCode IN (17,18) PipeName="\\pipe\\*lacesomepipe"
  | stats  min(_time) as firstTime max(_time) as lastTime count by dest user_id EventCode
  PipeName signature Image process_id | rename Image as process_name | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `trickbot_named_pipe_filter`
