description: The following analytic detects the execution of the `route.exe` Windows
  application, commonly used for network discovery. It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process creation events. This activity
  is significant because adversaries often use `route.exe` to map network routes and
  identify potential targets within a network. If confirmed malicious, this behavior
  could allow attackers to gain insights into network topology, facilitating lateral
  movement and further exploitation. Note that false positives may occur due to legitimate
  administrative tasks or automated scripts.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=route.exe OR Processes.original_file_name=route.exe)
  by Processes.dest Processes.user Processes.parent_process_name Processes.parent_process
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `network_discovery_using_route_windows_app_filter`'
