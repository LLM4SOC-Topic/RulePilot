description: The following analytic detects attempts to escalate privileges on a Linux
  system using Docker. It identifies processes where Docker commands are used to mount
  the root directory or execute shell commands within a container. This detection
  leverages Endpoint Detection and Response (EDR) telemetry, focusing on process names,
  command-line arguments, and parent processes. This activity is significant because
  it can allow an attacker with Docker privileges to modify critical system files,
  such as /etc/passwd, to create a superuser. If confirmed malicious, this could lead
  to full system compromise and persistent unauthorized access.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process IN("*docker*-v*/*:*","*docker*--volume*/*:*")
  OR Processes.process IN("*docker*exec*sh*","*docker*exec*bash*") by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id Processes.process_guid | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_docker_privilege_escalation_filter`'
