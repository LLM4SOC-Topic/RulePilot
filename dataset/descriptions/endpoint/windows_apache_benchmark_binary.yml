description: The following analytic detects the execution of the Apache Benchmark
  binary (ab.exe), commonly used by MetaSploit payloads. It leverages data from Endpoint
  Detection and Response (EDR) agents, focusing on process creation events where the
  original file name is ab.exe. This activity is significant as it may indicate the
  presence of a MetaSploit attack, which uses Apache Benchmark to generate malicious
  payloads. If confirmed malicious, this could lead to unauthorized network connections,
  further system compromise, and potential data exfiltration. Immediate investigation
  is required to determine the intent and scope of the activity.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.original_file_name=ab.exe by Processes.dest
  Processes.user Processes.parent_process_name Processes.process_name Processes.original_file_name
  Processes.process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_apache_benchmark_binary_filter`'
