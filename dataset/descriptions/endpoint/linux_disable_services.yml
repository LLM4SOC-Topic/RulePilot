description: The following analytic detects attempts to disable a service on a Linux
  system. It leverages data from Endpoint Detection and Response (EDR) agents, focusing
  on processes like "systemctl," "service," and "svcadm" with commands containing
  "disable." This activity is significant as adversaries may disable security or critical
  services to evade detection and facilitate further malicious actions, such as deploying
  destructive payloads. If confirmed malicious, this could lead to the termination
  of essential security services, allowing attackers to persist undetected and potentially
  cause significant damage to the system.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name IN ("systemctl",
  "service", "svcadm")  Processes.process = "* disable*" by Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  Processes.process_guid Processes.dest Processes.user | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_disable_services_filter`'
