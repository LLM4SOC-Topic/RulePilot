description: The following analytic detects the deletion of critical directories on
  a Linux machine using the `rm` command with argument rf. It leverages data from
  Endpoint Detection and Response (EDR) agents, focusing on command-line executions
  targeting directories like /boot, /var/log, /etc, and /dev. This activity is significant
  because deleting these directories can severely disrupt system operations and is
  often associated with destructive campaigns like Industroyer2. If confirmed malicious,
  this action could lead to system instability, data loss, and potential downtime,
  making it crucial for immediate investigation and response.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name =rm AND Processes.process=
  "* -rf *" AND Processes.process IN ("*/boot/*", "*/var/log/*", "*/etc/*", "*/dev/*")
  by Processes.parent_process_name Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id Processes.process_guid Processes.dest Processes.user
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_deleting_critical_directory_using_rm_command_filter`'
