description: The following analytic detects the execution of the "sudo" or "su" command
  on a Linux operating system. It leverages data from Endpoint Detection and Response
  (EDR) agents, focusing on process names and parent process names. This activity
  is significant because "sudo" and "su" commands are commonly used by adversaries
  to elevate privileges, potentially leading to unauthorized access or control over
  the system. If confirmed malicious, this activity could allow attackers to execute
  commands with root privileges, leading to severe security breaches, data exfiltration,
  or further system compromise.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name IN ("sudo", "su")
  OR Processes.parent_process_name IN ("sudo", "su") by Processes.dest Processes.user
  Processes.parent_process_name Processes.process_name Processes.process Processes.process_id
  Processes.parent_process_id Processes.process_guid | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `linux_sudo_or_su_execution_filter`'
