description: The following analytic detects BitLockerToGo.exe execution, which has
  been observed being abused by Lumma stealer malware. The malware leverages this
  legitimate Windows utility to manipulate registry keys, search for cryptocurrency
  wallets and credentials, and exfiltrate sensitive data. This activity is significant
  because BitLockerToGo.exe provides functionality for viewing, copying, and writing
  files as well as modifying registry branches - capabilities that the Lumma stealer
  exploits. However, note that if legitimate use of BitLockerToGo.exe is in the organization,
  this detection will
required_fields:
- Processes.process_name
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name=bitlockertogo.exe
  by Processes.dest Processes.user Processes.parent_process_name Processes.process_name
  Processes.process Processes.process_id Processes.parent_process_id | `drop_dm_object_name(Processes)`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `windows_bitlockertogo_process_execution_filter`'
