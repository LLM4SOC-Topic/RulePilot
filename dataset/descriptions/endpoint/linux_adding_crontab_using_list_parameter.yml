description: The following analytic detects suspicious modifications to cron jobs
  on Linux systems using the crontab command with list parameters. It leverages data
  from Endpoint Detection and Response (EDR) agents, focusing on process names and
  command-line executions. This activity is significant as it may indicate an attempt
  to establish persistence or execute malicious code on a schedule. If confirmed malicious,
  the impact could include unauthorized code execution, data destruction, or other
  damaging outcomes. Further investigation should analyze the added cron job, its
  associated command, and any related processes.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where Processes.process_name = "crontab" Processes.process=
  "* -l*" by  Processes.parent_process_name Processes.process_name Processes.process
  Processes.process_id Processes.parent_process_id Processes.dest Processes.user |
  `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `linux_adding_crontab_using_list_parameter_filter`'
