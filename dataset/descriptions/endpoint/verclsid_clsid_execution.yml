description: The following analytic detects the potential abuse of the verclsid.exe
  utility to execute malicious files via generated CLSIDs. It leverages data from
  Endpoint Detection and Response (EDR) agents, focusing on specific command-line
  patterns associated with verclsid.exe. This activity is significant because verclsid.exe
  is a legitimate Windows application used to verify CLSID COM objects, and its misuse
  can indicate an attempt to bypass security controls. If confirmed malicious, this
  technique could allow an attacker to execute arbitrary code, potentially leading
  to system compromise or further malicious activities.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` values(Processes.process) as process values(Processes.parent_process)
  as parent_process values(Processes.process_id) as process_id count min(_time) as
  firstTime max(_time) as lastTime from datamodel=Endpoint.Processes where (Processes.process_name=verclsid.exe
  OR Processes.original_file_name=verclsid.exe) AND Processes.process="*/S*" Processes.process="*/C*"
  AND  Processes.process="*{*" AND Processes.process="*}*" by  Processes.process_name
  Processes.original_file_name Processes.dest Processes.user Processes.parent_process_name
  Processes.parent_process | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `verclsid_clsid_execution_filter`'
