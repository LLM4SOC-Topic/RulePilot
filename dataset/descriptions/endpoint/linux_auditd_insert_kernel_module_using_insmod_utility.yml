description: The following analytic detects the insertion of a Linux kernel module
  using the insmod utility. It leverages data from Linux Auditd, focusing on process
  execution logs that include process names and command-line details. This activity
  is significant as it may indicate the installation of a rootkit or malicious kernel
  module, potentially allowing an attacker to gain elevated privileges and bypass
  security detections. If confirmed malicious, this could lead to unauthorized code
  execution, persistent access, and severe compromise of the affected system.
required_fields:
- _time
- comm
- exe
- SYSCALL
- UID
- ppid
- pid
rule: sourcetype="linux:audit" type=SYSCALL comm=insmod | rename host as dest | stats
  count min(_time) as firstTime max(_time) as lastTime by comm exe  SYSCALL UID ppid
  pid success dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `linux_auditd_insert_kernel_module_using_insmod_utility_filter`
