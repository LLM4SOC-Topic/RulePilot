description: The following analytic detects the use of the decompile parameter with
  the HTML Help application (HH.exe). This behavior is identified through Endpoint
  Detection and Response (EDR) telemetry, focusing on command-line executions involving
  the decompile parameter. This activity is significant because it is an uncommon
  command and has been associated with APT41 campaigns, where it was used to unpack
  HTML help files for further malicious actions. If confirmed malicious, this technique
  could allow attackers to execute arbitrary commands, potentially leading to further
  compromise and persistence within the environment.
required_fields:
- _time
- Processes.dest
- Processes.user
- Processes.parent_process_name
- Processes.parent_process
- Processes.original_file_name
- Processes.process_name
- Processes.process
- Processes.process_id
- Processes.parent_process_path
- Processes.process_path
- Processes.parent_process_id
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Endpoint.Processes where (Processes.process_name=hh.exe OR Processes.original_file_name=HH.EXE)
  Processes.process=*-decompile* by Processes.dest Processes.user Processes.parent_process_name
  Processes.process_name Processes.process Processes.process_id Processes.parent_process_id
  | `drop_dm_object_name(Processes)` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_system_binary_proxy_execution_compiled_html_file_decompile_filter`'
