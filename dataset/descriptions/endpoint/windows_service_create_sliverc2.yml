description: The following analytic detects the creation of a Windows service named
  "Sliver" with the description "Sliver Implant," indicative of SliverC2 lateral movement
  using the PsExec module. It leverages Windows EventCode 7045 from the System Event
  log to identify this activity. This behavior is significant as it may indicate an
  adversary's attempt to establish persistence or execute commands remotely. If confirmed
  malicious, this activity could allow attackers to maintain control over the compromised
  system, execute arbitrary code, and further infiltrate the network.
required_fields:
- EventCode
- Computer
- ServiceName
- ImagePath
- ServiceType
rule: eventtype=wineventlog_system EventCode=7045 ServiceName="sliver" | stats count
  min(_time) as firstTime max(_time) as lastTime by Computer EventCode ImagePath ServiceName
  ServiceType | rename Computer as dest | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `windows_service_create_sliverc2_filter`
