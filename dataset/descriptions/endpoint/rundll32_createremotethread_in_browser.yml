description: The following analytic detects the suspicious creation of a remote thread
  by rundll32.exe targeting browser processes such as firefox.exe, chrome.exe, iexplore.exe,
  and microsoftedgecp.exe. This detection leverages Sysmon EventCode 8, focusing on
  SourceImage and TargetImage fields to identify the behavior. This activity is significant
  as it is commonly associated with malware like IcedID, which hooks browsers to steal
  sensitive information such as banking details. If confirmed malicious, this could
  allow attackers to intercept and exfiltrate sensitive user data, leading to potential
  financial loss and privacy breaches.
required_fields:
- _time
- SourceImage
- TargetImage
- TargetProcessId
- SourceProcessId
- StartAddress
- EventCode
- dest
rule: sourcetype=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational OR source=XmlWinEventLog:Microsoft-Windows-Sysmon/Operational
  OR source=Syslog:Linux-Sysmon/Operational EventCode=8 SourceImage = "*\\rundll32.exe"
  TargetImage IN ("*\\firefox.exe", "*\\chrome.exe", "*\\iexplore.exe","*\\microsoftedgecp.exe")
  | stats count min(_time) as firstTime max(_time) as lastTime by SourceImage TargetImage
  TargetProcessId SourceProcessId StartAddress EventCode dest | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `rundll32_createremotethread_in_browser_filter`
