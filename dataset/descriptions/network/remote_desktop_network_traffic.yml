description: The following analytic detects unusual Remote Desktop Protocol (RDP)
  traffic on TCP/3389 by filtering out known RDP sources and destinations, focusing
  on atypical connections within the network. This detection leverages network traffic
  data to identify potentially unauthorized RDP access. Monitoring this activity is
  crucial for a SOC as unauthorized RDP access can indicate an attacker's attempt
  to control networked systems, leading to data theft, ransomware deployment, or further
  network compromise. If confirmed malicious, this activity could result in significant
  data breaches or complete system and network control loss.
required_fields:
- _time
- All_Traffic.dest_port
- All_Traffic.dest_category
- All_Traffic.src_category
- All_Traffic.src
- All_Traffic.dest
- All_Traffic.dest_port
rule: '| tstats summariesonly=`summariesonly_config` allow_old_summaries=`oldsummaries_config`
  fillnull_value=`fillnull_config` count min(_time) as firstTime max(_time) as lastTime
  from datamodel=Network_Traffic where All_Traffic.dest_port=3389 AND All_Traffic.dest_category!=common_rdp_destination
  AND All_Traffic.src_category!=common_rdp_source AND All_Traffic.action="allowed"
  by All_Traffic.src All_Traffic.dest All_Traffic.dest_port | `drop_dm_object_name("All_Traffic")`
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `remote_desktop_network_traffic_filter`'
