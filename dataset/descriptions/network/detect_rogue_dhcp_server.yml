description: The following analytic identifies the presence of unauthorized DHCP servers
  on the network. It leverages logs from Cisco network devices with DHCP Snooping
  enabled, specifically looking for events where DHCP leases are issued from untrusted
  ports. This activity is significant because rogue DHCP servers can facilitate Man-in-the-Middle
  attacks, leading to potential data interception and network disruption. If confirmed
  malicious, this could allow attackers to redirect network traffic, capture sensitive
  information, and compromise the integrity of the network.
required_fields:
- _time
- facility
- mnemonic
- message_type
- src_mac
- host
rule: eventtype=cisco_ios facility="DHCP_SNOOPING" mnemonic="DHCP_SNOOPING_UNTRUSTED_PORT"
  | stats min(_time) AS firstTime max(_time) AS lastTime count values(message_type)
  AS message_type values(src_mac) AS src_mac BY host | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)|convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `detect_rogue_dhcp_server_filter`
