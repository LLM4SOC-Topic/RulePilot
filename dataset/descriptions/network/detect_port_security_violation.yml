description: The following analytic detects port security violations on Cisco switches.
  It leverages logs from Cisco network devices, specifically looking for events with
  mnemonics indicating port security violations. This activity is significant because
  it indicates an unauthorized device attempting to connect to a secured port, potentially
  bypassing network access controls. If confirmed malicious, this could allow an attacker
  to gain unauthorized access to the network, leading to data exfiltration, network
  disruption, or further lateral movement within the environment.
required_fields:
- _time
- facility
- mnemonic
- disable_cause
- src_int_prefix_long
- src_int_suffix
- src_mac
- src_vlan
- action
- host
- src_interface
rule: eventtype=cisco_ios (facility="PM" mnemonic="ERR_DISABLE" disable_cause="psecure-violation")
  OR (facility="PORT_SECURITY" mnemonic="PSECURE_VIOLATION" OR mnemonic="PSECURE_VIOLATION_VLAN")
  | eval src_interface=src_int_prefix_long+src_int_suffix | stats min(_time) AS firstTime
  max(_time) AS lastTime values(disable_cause) AS disable_cause values(src_mac) AS
  src_mac values(src_vlan) AS src_vlan values(action) AS action count by host src_interface
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$) | `detect_port_security_violation_filter`
