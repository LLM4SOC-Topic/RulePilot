description: The following analytic detects ARP Poisoning attacks by monitoring for
  Dynamic ARP Inspection (DAI) errors on Cisco network devices. It leverages logs
  from Cisco devices, specifically looking for events where the ARP inspection feature
  has disabled an interface due to suspicious activity. This activity is significant
  because ARP Poisoning can allow attackers to intercept, modify, or disrupt network
  traffic, leading to potential data breaches or denial of service. If confirmed malicious,
  this could enable attackers to perform man-in-the-middle attacks, compromising the
  integrity and confidentiality of network communications.
required_fields:
- _time
- facility
- mnemonic
- disable_cause
- src_int_prefix_long
- src_int_suffix
- host
- src_interface
rule: eventtype=cisco_ios facility="PM" mnemonic="ERR_DISABLE" disable_cause="arp-inspection"
  | eval src_interface=src_int_prefix_long+src_int_suffix | stats min(_time) AS firstTime
  max(_time) AS lastTime count BY host src_interface | convert timeformat="%Y-%m-%dT%H:%M:%S"
  ctime($field$)|convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)| `detect_arp_poisoning_filter`
