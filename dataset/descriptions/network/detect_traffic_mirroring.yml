description: The following analytic detects the initiation of traffic mirroring sessions
  on Cisco network devices. It leverages logs with specific mnemonics and facilities
  related to traffic mirroring, such as "ETH_SPAN_SESSION_UP" and "PKTCAP_START."
  This activity is significant because adversaries may use traffic mirroring to exfiltrate
  data by duplicating and forwarding network traffic to an external destination. If
  confirmed malicious, this could allow attackers to capture sensitive information,
  monitor network communications, and potentially compromise the integrity and confidentiality
  of the network.
required_fields:
- _time
- facility
- mnemonic
- host
rule: eventtype=cisco_ios (facility="MIRROR" mnemonic="ETH_SPAN_SESSION_UP") OR (facility="SPAN"
  mnemonic="SESSION_UP") OR (facility="SPAN" mnemonic="PKTCAP_START") OR (mnemonic="CFGLOG_LOGGEDCMD"
  command="monitor session*") | stats min(_time) AS firstTime max(_time) AS lastTime
  count BY host facility mnemonic | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)|convert
  timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `detect_traffic_mirroring_filter`
