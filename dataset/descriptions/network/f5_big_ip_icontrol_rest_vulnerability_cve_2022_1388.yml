description: The following analytic detects attempts to exploit the F5 BIG-IP iControl
  REST API vulnerability (CVE-2022-1388) for unauthenticated remote code execution.
  It identifies suspicious URI paths and POST HTTP methods, along with specific request
  headers containing potential commands in the `utilcmdargs` field and a random base64
  encoded value in the `X-F5-Auth-Token` field. This activity is significant as it
  targets a critical vulnerability that can allow attackers to execute arbitrary commands
  on the affected system. If confirmed malicious, this could lead to full system compromise
  and unauthorized access to sensitive data.
required_fields:
- Web.http_method
- Web.url
- Web.url_length
- Web.src
- Web.dest
- Web.http_user_agent
rule: '| tstats count from datamodel=Web where Web.url="*/mgmt/tm/util/bash*" Web.http_method="POST"
  by Web.http_user_agent Web.http_method, Web.url,Web.url_length Web.src, Web.dest
  | `drop_dm_object_name("Web")` | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$)
  | convert timeformat="%Y-%m-%dT%H:%M:%S" ctime($field$) | `f5_big_ip_icontrol_rest_vulnerability_cve_2022_1388_filter`'
