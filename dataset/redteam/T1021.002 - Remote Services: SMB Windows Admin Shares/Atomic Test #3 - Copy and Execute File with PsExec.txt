Copy and Execute File with PsExec
Copies a file to a remote host and executes it using PsExec.
Inputs:
Name	Description	Type	Default Value
command_path	File to copy and execute	path	C:\Windows\System32\cmd.exe
remote_host	Remote computer to receive the copy and execute the file	string	\\localhost
psexec_exe	Path to PsExec	string	PathToAtomicsFolder\..\ExternalPayloads\PsExec.exe
Attack Commands: Run with command_prompt! Elevation Required (e.g. root or admin)
"#{psexec_exe}" #{remote_host} -accepteula -c #{command_path}
Dependencies: Run with powershell!
Description: PsExec tool from Sysinternals must exist on disk at specified location (#{psexec_exe})
Check Prereq Commands:
if (Test-Path "#{psexec_exe}") { exit 0} else { exit 1}
Get Prereq Commands:
New-Item -Type Directory "PathToAtomicsFolder\..\ExternalPayloads\" -ErrorAction Ignore -Force | Out-Null
Invoke-WebRequest "https://download.sysinternals.com/files/PSTools.zip" -OutFile "PathToAtomicsFolder\..\ExternalPayloads\PsTools.zip"
Expand-Archive "PathToAtomicsFolder\..\ExternalPayloads\PsTools.zip" "PathToAtomicsFolder\..\ExternalPayloads\PsTools" -Force
New-Item -ItemType Directory (Split-Path "#{psexec_exe}") -Force | Out-Null
Copy-Item "PathToAtomicsFolder\..\ExternalPayloads\PsTools\PsExec.exe" "#{psexec_exe}" -Force